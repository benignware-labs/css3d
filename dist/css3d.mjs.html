<html>
  <head>
    <base href=".."/>
    <title>css3d - css3d.mjs</title>

    <link rel="stylesheet" href="public/github-markdown.min-05fea8df8ec68cb6c27337f6db65733e.css">
    <link rel="stylesheet" href="public/highlight-c281e701b2830b095c67417cd9a7b210.css">
    <link rel="stylesheet" href="public/style-aea3468ccb7ee0c3c4c2b5d339fc989e.css">
    <link rel="stylesheet" href="public/all-cc69a8b8824029ae06797ee01a3cc5c8.css">

    <script src="public/plugins/core/example/ExampleViewer.js"></script>
              
              <script src="-/index.mjs" type="module"></script>
            
  </head>
  <body class="markdown-body flex-column">
    <div class="header flex">
      <a class="header-brand" href="./index.html">css3d</a>
      
<ul class="menu flex align-center justify-center">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="elements/Sphere.html"
        
        
          role="button"
          
          aria-expanded="false"
        
      >
        Elements
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/textures.html"
        
        
          role="button"
          
          aria-expanded="false"
        
      >
        Examples
      </a>
      
    </li>
    
  
</ul>
      <nav class="links">
        
          
            
          
        
      </nav>
    </div>
      
      

<main class="flex-grow flex h-100">
  <div class="sidebar sidebar-left border-right mr-2 flex-noshrink">
  
<ul class="menu">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="elements/Sphere.html"
        
        
          role="button"
          
          aria-expanded="false"
        
      >
        Elements
      </a>
      
        
<ul class="menu">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="elements/Sphere.html"
        
        
      >
        Sphere
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="elements/Polyhedron.html"
        
        
      >
        Polyhedron
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="elements/Cylinder.html"
        
        
      >
        Cylinder
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="elements/Box.html"
        
        
      >
        Box
      </a>
      
    </li>
    
  
</ul>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/textures.html"
        
        
          role="button"
          
          aria-expanded="false"
        
      >
        Examples
      </a>
      
        
<ul class="menu">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/textures.html"
        
        
      >
        Textures
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/planets.html"
        
        
      >
        Planets
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/crane.html"
        
        
      >
        Crane
      </a>
      
    </li>
    
  
</ul>
      
    </li>
    
  
</ul>
</div>
  <div class="flex-grow">
    <div class="container py-4">
      <h1>Source: css3d.mjs</h1>
      <p>
        dist/css3d.mjs
      </p>
      
      <pre><code class="hljs"><span class="hljs-keyword">const</span> <span class="hljs-title function_">clamp</span> = (<span class="hljs-params"> value, min, max </span>) =&gt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>( min, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>( max, value ) );

<span class="hljs-keyword">const</span> <span class="hljs-title function_">rad2deg</span> = (<span class="hljs-params"> radians </span>) =&gt; radians * <span class="hljs-number">180</span> / <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">centroid</span> = (<span class="hljs-params"> ...vectors </span>) =&gt; {
  <span class="hljs-keyword">const</span> sum = vectors.<span class="hljs-title function_">reduce</span>( <span class="hljs-function">(<span class="hljs-params"> sum, vector </span>) =&gt;</span> sum.<span class="hljs-title function_">add</span>( vector ), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>() );
  <span class="hljs-keyword">return</span> sum.<span class="hljs-title function_">divide</span>( vectors.<span class="hljs-property">length</span> );
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Quaternion</span> {

	<span class="hljs-title function_">constructor</span>(<span class="hljs-params"> x = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>, z = <span class="hljs-number">0</span>, w = <span class="hljs-number">1</span> </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">isQuaternion</span> = <span class="hljs-literal">true</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = x;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = y;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = z;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = w;

	}

	<span class="hljs-keyword">static</span> <span class="hljs-title function_">slerpFlat</span>(<span class="hljs-params"> dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t </span>) {

		<span class="hljs-comment">// fuzz-free, array-based Quaternion SLERP operation</span>

		<span class="hljs-keyword">let</span> x0 = src0[ srcOffset0 + <span class="hljs-number">0</span> ],
			y0 = src0[ srcOffset0 + <span class="hljs-number">1</span> ],
			z0 = src0[ srcOffset0 + <span class="hljs-number">2</span> ],
			w0 = src0[ srcOffset0 + <span class="hljs-number">3</span> ];

		<span class="hljs-keyword">const</span> x1 = src1[ srcOffset1 + <span class="hljs-number">0</span> ],
			y1 = src1[ srcOffset1 + <span class="hljs-number">1</span> ],
			z1 = src1[ srcOffset1 + <span class="hljs-number">2</span> ],
			w1 = src1[ srcOffset1 + <span class="hljs-number">3</span> ];

		<span class="hljs-keyword">if</span> ( t === <span class="hljs-number">0</span> ) {

			dst[ dstOffset + <span class="hljs-number">0</span> ] = x0;
			dst[ dstOffset + <span class="hljs-number">1</span> ] = y0;
			dst[ dstOffset + <span class="hljs-number">2</span> ] = z0;
			dst[ dstOffset + <span class="hljs-number">3</span> ] = w0;
			<span class="hljs-keyword">return</span>;

		}

		<span class="hljs-keyword">if</span> ( t === <span class="hljs-number">1</span> ) {

			dst[ dstOffset + <span class="hljs-number">0</span> ] = x1;
			dst[ dstOffset + <span class="hljs-number">1</span> ] = y1;
			dst[ dstOffset + <span class="hljs-number">2</span> ] = z1;
			dst[ dstOffset + <span class="hljs-number">3</span> ] = w1;
			<span class="hljs-keyword">return</span>;

		}

		<span class="hljs-keyword">if</span> ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {

			<span class="hljs-keyword">let</span> s = <span class="hljs-number">1</span> - t;
			<span class="hljs-keyword">const</span> cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,
				dir = ( cos &gt;= <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : - <span class="hljs-number">1</span> ),
				sqrSin = <span class="hljs-number">1</span> - cos * cos;

			<span class="hljs-comment">// Skip the Slerp for tiny steps to avoid numeric problems:</span>
			<span class="hljs-keyword">if</span> ( sqrSin &gt; <span class="hljs-title class_">Number</span>.<span class="hljs-property">EPSILON</span> ) {

				<span class="hljs-keyword">const</span> sin = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( sqrSin ),
					len = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( sin, cos * dir );

				s = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( s * len ) / sin;
				t = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( t * len ) / sin;

			}

			<span class="hljs-keyword">const</span> tDir = t * dir;

			x0 = x0 * s + x1 * tDir;
			y0 = y0 * s + y1 * tDir;
			z0 = z0 * s + z1 * tDir;
			w0 = w0 * s + w1 * tDir;

			<span class="hljs-comment">// Normalize in case we just did a lerp:</span>
			<span class="hljs-keyword">if</span> ( s === <span class="hljs-number">1</span> - t ) {

				<span class="hljs-keyword">const</span> f = <span class="hljs-number">1</span> / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );

				x0 *= f;
				y0 *= f;
				z0 *= f;
				w0 *= f;

			}

		}

		dst[ dstOffset ] = x0;
		dst[ dstOffset + <span class="hljs-number">1</span> ] = y0;
		dst[ dstOffset + <span class="hljs-number">2</span> ] = z0;
		dst[ dstOffset + <span class="hljs-number">3</span> ] = w0;

	}

	<span class="hljs-keyword">static</span> <span class="hljs-title function_">multiplyQuaternionsFlat</span>(<span class="hljs-params"> dst, dstOffset, src0, srcOffset0, src1, srcOffset1 </span>) {

		<span class="hljs-keyword">const</span> x0 = src0[ srcOffset0 ];
		<span class="hljs-keyword">const</span> y0 = src0[ srcOffset0 + <span class="hljs-number">1</span> ];
		<span class="hljs-keyword">const</span> z0 = src0[ srcOffset0 + <span class="hljs-number">2</span> ];
		<span class="hljs-keyword">const</span> w0 = src0[ srcOffset0 + <span class="hljs-number">3</span> ];

		<span class="hljs-keyword">const</span> x1 = src1[ srcOffset1 ];
		<span class="hljs-keyword">const</span> y1 = src1[ srcOffset1 + <span class="hljs-number">1</span> ];
		<span class="hljs-keyword">const</span> z1 = src1[ srcOffset1 + <span class="hljs-number">2</span> ];
		<span class="hljs-keyword">const</span> w1 = src1[ srcOffset1 + <span class="hljs-number">3</span> ];

		dst[ dstOffset ] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;
		dst[ dstOffset + <span class="hljs-number">1</span> ] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;
		dst[ dstOffset + <span class="hljs-number">2</span> ] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;
		dst[ dstOffset + <span class="hljs-number">3</span> ] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;

		<span class="hljs-keyword">return</span> dst;

	}

	<span class="hljs-keyword">get</span> <span class="hljs-title function_">x</span>() {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span>;

	}

	<span class="hljs-keyword">set</span> <span class="hljs-title function_">x</span>(<span class="hljs-params"> value </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = value;
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

	}

	<span class="hljs-keyword">get</span> <span class="hljs-title function_">y</span>() {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span>;

	}

	<span class="hljs-keyword">set</span> <span class="hljs-title function_">y</span>(<span class="hljs-params"> value </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = value;
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

	}

	<span class="hljs-keyword">get</span> <span class="hljs-title function_">z</span>() {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span>;

	}

	<span class="hljs-keyword">set</span> <span class="hljs-title function_">z</span>(<span class="hljs-params"> value </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = value;
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

	}

	<span class="hljs-keyword">get</span> <span class="hljs-title function_">w</span>() {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span>;

	}

	<span class="hljs-keyword">set</span> <span class="hljs-title function_">w</span>(<span class="hljs-params"> value </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = value;
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

	}

	<span class="hljs-title function_">set</span>(<span class="hljs-params"> x, y, z, w </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = x;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = y;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = z;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = w;

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">clone</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">constructor</span>(<span class="hljs-params"> <span class="hljs-variable language_">this</span>._x, <span class="hljs-variable language_">this</span>._y, <span class="hljs-variable language_">this</span>._z, <span class="hljs-variable language_">this</span>._w </span>);

	}

	<span class="hljs-title function_">copy</span>(<span class="hljs-params"> quaternion </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = quaternion.<span class="hljs-property">x</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = quaternion.<span class="hljs-property">y</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = quaternion.<span class="hljs-property">z</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = quaternion.<span class="hljs-property">w</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">setFromEuler</span>(<span class="hljs-params"> euler, update = <span class="hljs-literal">true</span> </span>) {

		<span class="hljs-keyword">const</span> x = euler.<span class="hljs-property">_x</span>, y = euler.<span class="hljs-property">_y</span>, z = euler.<span class="hljs-property">_z</span>, order = euler.<span class="hljs-property">_order</span>;

		<span class="hljs-comment">// http://www.mathworks.com/matlabcentral/fileexchange/</span>
		<span class="hljs-comment">// 	20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/</span>
		<span class="hljs-comment">//	content/SpinCalc.m</span>

		<span class="hljs-keyword">const</span> cos = <span class="hljs-title class_">Math</span>.<span class="hljs-property">cos</span>;
		<span class="hljs-keyword">const</span> sin = <span class="hljs-title class_">Math</span>.<span class="hljs-property">sin</span>;

		<span class="hljs-keyword">const</span> c1 = <span class="hljs-title function_">cos</span>( x / <span class="hljs-number">2</span> );
		<span class="hljs-keyword">const</span> c2 = <span class="hljs-title function_">cos</span>( y / <span class="hljs-number">2</span> );
		<span class="hljs-keyword">const</span> c3 = <span class="hljs-title function_">cos</span>( z / <span class="hljs-number">2</span> );

		<span class="hljs-keyword">const</span> s1 = <span class="hljs-title function_">sin</span>( x / <span class="hljs-number">2</span> );
		<span class="hljs-keyword">const</span> s2 = <span class="hljs-title function_">sin</span>( y / <span class="hljs-number">2</span> );
		<span class="hljs-keyword">const</span> s3 = <span class="hljs-title function_">sin</span>( z / <span class="hljs-number">2</span> );

		<span class="hljs-keyword">switch</span> ( order ) {

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;XYZ&#x27;</span>:
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = s1 * c2 * c3 + c1 * s2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = c1 * s2 * c3 - s1 * c2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = c1 * c2 * s3 + s1 * s2 * c3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = c1 * c2 * c3 - s1 * s2 * s3;
				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;YXZ&#x27;</span>:
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = s1 * c2 * c3 + c1 * s2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = c1 * s2 * c3 - s1 * c2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = c1 * c2 * s3 - s1 * s2 * c3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = c1 * c2 * c3 + s1 * s2 * s3;
				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ZXY&#x27;</span>:
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = s1 * c2 * c3 - c1 * s2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = c1 * s2 * c3 + s1 * c2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = c1 * c2 * s3 + s1 * s2 * c3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = c1 * c2 * c3 - s1 * s2 * s3;
				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ZYX&#x27;</span>:
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = s1 * c2 * c3 - c1 * s2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = c1 * s2 * c3 + s1 * c2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = c1 * c2 * s3 - s1 * s2 * c3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = c1 * c2 * c3 + s1 * s2 * s3;
				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;YZX&#x27;</span>:
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = s1 * c2 * c3 + c1 * s2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = c1 * s2 * c3 + s1 * c2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = c1 * c2 * s3 - s1 * s2 * c3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = c1 * c2 * c3 - s1 * s2 * s3;
				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;XZY&#x27;</span>:
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = s1 * c2 * c3 - c1 * s2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = c1 * s2 * c3 - s1 * c2 * s3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = c1 * c2 * s3 + s1 * s2 * c3;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = c1 * c2 * c3 + s1 * s2 * s3;
				<span class="hljs-keyword">break</span>;

			<span class="hljs-attr">default</span>:
				<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>( <span class="hljs-string">&#x27;THREE.Quaternion: .setFromEuler() encountered an unknown order: &#x27;</span> + order );

		}

		<span class="hljs-keyword">if</span> ( update === <span class="hljs-literal">true</span> ) <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">setFromAxisAngle</span>(<span class="hljs-params"> axis, angle </span>) {

		<span class="hljs-comment">// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm</span>

		<span class="hljs-comment">// assumes axis is normalized</span>

		<span class="hljs-keyword">const</span> halfAngle = angle / <span class="hljs-number">2</span>, s = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( halfAngle );

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = axis.<span class="hljs-property">x</span> * s;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = axis.<span class="hljs-property">y</span> * s;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = axis.<span class="hljs-property">z</span> * s;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( halfAngle );

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">setFromRotationMatrix</span>(<span class="hljs-params"> m </span>) {

		<span class="hljs-comment">// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm</span>

		<span class="hljs-comment">// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)</span>

		<span class="hljs-keyword">const</span> te = m.<span class="hljs-property">elements</span>,

			m11 = te[ <span class="hljs-number">0</span> ], m12 = te[ <span class="hljs-number">4</span> ], m13 = te[ <span class="hljs-number">8</span> ],
			m21 = te[ <span class="hljs-number">1</span> ], m22 = te[ <span class="hljs-number">5</span> ], m23 = te[ <span class="hljs-number">9</span> ],
			m31 = te[ <span class="hljs-number">2</span> ], m32 = te[ <span class="hljs-number">6</span> ], m33 = te[ <span class="hljs-number">10</span> ],

			trace = m11 + m22 + m33;

		<span class="hljs-keyword">if</span> ( trace &gt; <span class="hljs-number">0</span> ) {

			<span class="hljs-keyword">const</span> s = <span class="hljs-number">0.5</span> / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( trace + <span class="hljs-number">1.0</span> );

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = <span class="hljs-number">0.25</span> / s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = ( m32 - m23 ) * s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = ( m13 - m31 ) * s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = ( m21 - m12 ) * s;

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( m11 &gt; m22 &amp;&amp; m11 &gt; m33 ) {

			<span class="hljs-keyword">const</span> s = <span class="hljs-number">2.0</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( <span class="hljs-number">1.0</span> + m11 - m22 - m33 );

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = ( m32 - m23 ) / s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-number">0.25</span> * s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = ( m12 + m21 ) / s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = ( m13 + m31 ) / s;

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( m22 &gt; m33 ) {

			<span class="hljs-keyword">const</span> s = <span class="hljs-number">2.0</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( <span class="hljs-number">1.0</span> + m22 - m11 - m33 );

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = ( m13 - m31 ) / s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = ( m12 + m21 ) / s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-number">0.25</span> * s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = ( m23 + m32 ) / s;

		} <span class="hljs-keyword">else</span> {

			<span class="hljs-keyword">const</span> s = <span class="hljs-number">2.0</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( <span class="hljs-number">1.0</span> + m33 - m11 - m22 );

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = ( m21 - m12 ) / s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = ( m13 + m31 ) / s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = ( m23 + m32 ) / s;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-number">0.25</span> * s;

		}

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">setFromUnitVectors</span>(<span class="hljs-params"> vFrom, vTo </span>) {

		<span class="hljs-comment">// assumes direction vectors vFrom and vTo are normalized</span>

		<span class="hljs-keyword">let</span> r = vFrom.<span class="hljs-title function_">dot</span>( vTo ) + <span class="hljs-number">1</span>;

		<span class="hljs-keyword">if</span> ( r &lt; <span class="hljs-title class_">Number</span>.<span class="hljs-property">EPSILON</span> ) {

			<span class="hljs-comment">// vFrom and vTo point in opposite directions</span>

			r = <span class="hljs-number">0</span>;

			<span class="hljs-keyword">if</span> ( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( vFrom.<span class="hljs-property">x</span> ) &gt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( vFrom.<span class="hljs-property">z</span> ) ) {

				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = - vFrom.<span class="hljs-property">y</span>;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = vFrom.<span class="hljs-property">x</span>;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-number">0</span>;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = r;

			} <span class="hljs-keyword">else</span> {

				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-number">0</span>;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = - vFrom.<span class="hljs-property">z</span>;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = vFrom.<span class="hljs-property">y</span>;
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = r;

			}

		} <span class="hljs-keyword">else</span> {

			<span class="hljs-comment">// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3</span>

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = vFrom.<span class="hljs-property">y</span> * vTo.<span class="hljs-property">z</span> - vFrom.<span class="hljs-property">z</span> * vTo.<span class="hljs-property">y</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = vFrom.<span class="hljs-property">z</span> * vTo.<span class="hljs-property">x</span> - vFrom.<span class="hljs-property">x</span> * vTo.<span class="hljs-property">z</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = vFrom.<span class="hljs-property">x</span> * vTo.<span class="hljs-property">y</span> - vFrom.<span class="hljs-property">y</span> * vTo.<span class="hljs-property">x</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = r;

		}

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">normalize</span>();

	}

	<span class="hljs-title function_">angleTo</span>(<span class="hljs-params"> q </span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">acos</span>( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( <span class="hljs-title function_">clamp</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">dot</span>( q ), - <span class="hljs-number">1</span>, <span class="hljs-number">1</span> ) ) );
	}

	<span class="hljs-title function_">rotateTowards</span>(<span class="hljs-params"> q, step </span>) {

		<span class="hljs-keyword">const</span> angle = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">angleTo</span>( q );

		<span class="hljs-keyword">if</span> ( angle === <span class="hljs-number">0</span> ) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

		<span class="hljs-keyword">const</span> t = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>( <span class="hljs-number">1</span>, step / angle );

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">slerp</span>( q, t );

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">identity</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>( <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span> );

	}

	<span class="hljs-title function_">invert</span>(<span class="hljs-params"></span>) {

		<span class="hljs-comment">// quaternion is assumed to have unit length</span>

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">conjugate</span>();

	}

	<span class="hljs-title function_">conjugate</span>(<span class="hljs-params"></span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> *= - <span class="hljs-number">1</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> *= - <span class="hljs-number">1</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> *= - <span class="hljs-number">1</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">dot</span>(<span class="hljs-params"> v </span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> * v.<span class="hljs-property">_x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> * v.<span class="hljs-property">_y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> * v.<span class="hljs-property">_z</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> * v.<span class="hljs-property">_w</span>;

	}

	<span class="hljs-title function_">lengthSq</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span>;

	}

	<span class="hljs-title function_">length</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> );

	}

	<span class="hljs-title function_">normalize</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">let</span> l = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">length</span>();

		<span class="hljs-keyword">if</span> ( l === <span class="hljs-number">0</span> ) {

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-number">0</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-number">0</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-number">0</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = <span class="hljs-number">1</span>;

		} <span class="hljs-keyword">else</span> {

			l = <span class="hljs-number">1</span> / l;

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> * l;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> * l;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> * l;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> * l;

		}

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">multiply</span>(<span class="hljs-params"> q </span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyQuaternions</span>( <span class="hljs-variable language_">this</span>, q );

	}

	<span class="hljs-title function_">premultiply</span>(<span class="hljs-params"> q </span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyQuaternions</span>( q, <span class="hljs-variable language_">this</span> );

	}

	<span class="hljs-title function_">multiplyQuaternions</span>(<span class="hljs-params"> a, b </span>) {

		<span class="hljs-comment">// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm</span>

		<span class="hljs-keyword">const</span> qax = a.<span class="hljs-property">_x</span>, qay = a.<span class="hljs-property">_y</span>, qaz = a.<span class="hljs-property">_z</span>, qaw = a.<span class="hljs-property">_w</span>;
		<span class="hljs-keyword">const</span> qbx = b.<span class="hljs-property">_x</span>, qby = b.<span class="hljs-property">_y</span>, qbz = b.<span class="hljs-property">_z</span>, qbw = b.<span class="hljs-property">_w</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">slerp</span>(<span class="hljs-params"> qb, t </span>) {

		<span class="hljs-keyword">if</span> ( t === <span class="hljs-number">0</span> ) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
		<span class="hljs-keyword">if</span> ( t === <span class="hljs-number">1</span> ) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">copy</span>( qb );

		<span class="hljs-keyword">const</span> x = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span>, y = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span>, z = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span>, w = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span>;

		<span class="hljs-comment">// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/</span>

		<span class="hljs-keyword">let</span> cosHalfTheta = w * qb.<span class="hljs-property">_w</span> + x * qb.<span class="hljs-property">_x</span> + y * qb.<span class="hljs-property">_y</span> + z * qb.<span class="hljs-property">_z</span>;

		<span class="hljs-keyword">if</span> ( cosHalfTheta &lt; <span class="hljs-number">0</span> ) {

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = - qb.<span class="hljs-property">_w</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = - qb.<span class="hljs-property">_x</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = - qb.<span class="hljs-property">_y</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = - qb.<span class="hljs-property">_z</span>;

			cosHalfTheta = - cosHalfTheta;

		} <span class="hljs-keyword">else</span> {

			<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">copy</span>( qb );

		}

		<span class="hljs-keyword">if</span> ( cosHalfTheta &gt;= <span class="hljs-number">1.0</span> ) {

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = w;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = x;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = y;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = z;

			<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

		}

		<span class="hljs-keyword">const</span> sqrSinHalfTheta = <span class="hljs-number">1.0</span> - cosHalfTheta * cosHalfTheta;

		<span class="hljs-keyword">if</span> ( sqrSinHalfTheta &lt;= <span class="hljs-title class_">Number</span>.<span class="hljs-property">EPSILON</span> ) {

			<span class="hljs-keyword">const</span> s = <span class="hljs-number">1</span> - t;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = s * w + t * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = s * x + t * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = s * y + t * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span>;
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = s * z + t * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span>;

			<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">normalize</span>(); <span class="hljs-comment">// normalize calls _onChangeCallback()</span>

			<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

		}

		<span class="hljs-keyword">const</span> sinHalfTheta = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( sqrSinHalfTheta );
		<span class="hljs-keyword">const</span> halfTheta = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( sinHalfTheta, cosHalfTheta );
		<span class="hljs-keyword">const</span> ratioA = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( ( <span class="hljs-number">1</span> - t ) * halfTheta ) / sinHalfTheta,
			ratioB = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( t * halfTheta ) / sinHalfTheta;

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = ( w * ratioA + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> * ratioB );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = ( x * ratioA + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> * ratioB );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = ( y * ratioA + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> * ratioB );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = ( z * ratioA + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> * ratioB );

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">slerpQuaternions</span>(<span class="hljs-params"> qa, qb, t </span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">copy</span>( qa ).<span class="hljs-title function_">slerp</span>( qb, t );

	}

	<span class="hljs-title function_">random</span>(<span class="hljs-params"></span>) {

		<span class="hljs-comment">// sets this quaternion to a uniform random unit quaternnion</span>

		<span class="hljs-comment">// Ken Shoemake</span>
		<span class="hljs-comment">// Uniform random rotations</span>
		<span class="hljs-comment">// D. Kirk, editor, Graphics Gems III, pages 124-132. Academic Press, New York, 1992.</span>

		<span class="hljs-keyword">const</span> theta1 = <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>();
		<span class="hljs-keyword">const</span> theta2 = <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>();

		<span class="hljs-keyword">const</span> x0 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>();
		<span class="hljs-keyword">const</span> r1 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( <span class="hljs-number">1</span> - x0 );
		<span class="hljs-keyword">const</span> r2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( x0 );

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(
			r1 * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( theta1 ),
			r1 * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( theta1 ),
			r2 * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( theta2 ),
			r2 * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( theta2 ),
		);

	}

	<span class="hljs-title function_">equals</span>(<span class="hljs-params"> quaternion </span>) {

		<span class="hljs-keyword">return</span> ( quaternion.<span class="hljs-property">_x</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> ) &amp;&amp; ( quaternion.<span class="hljs-property">_y</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> ) &amp;&amp; ( quaternion.<span class="hljs-property">_z</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> ) &amp;&amp; ( quaternion.<span class="hljs-property">_w</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> );

	}

	<span class="hljs-title function_">fromArray</span>(<span class="hljs-params"> array, offset = <span class="hljs-number">0</span> </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = array[ offset ];
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = array[ offset + <span class="hljs-number">1</span> ];
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = array[ offset + <span class="hljs-number">2</span> ];
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = array[ offset + <span class="hljs-number">3</span> ];

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">toArray</span>(<span class="hljs-params"> array = [], offset = <span class="hljs-number">0</span> </span>) {

		array[ offset ] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span>;
		array[ offset + <span class="hljs-number">1</span> ] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span>;
		array[ offset + <span class="hljs-number">2</span> ] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span>;
		array[ offset + <span class="hljs-number">3</span> ] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span>;

		<span class="hljs-keyword">return</span> array;

	}

	<span class="hljs-title function_">fromBufferAttribute</span>(<span class="hljs-params"> attribute, index </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = attribute.<span class="hljs-title function_">getX</span>( index );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = attribute.<span class="hljs-title function_">getY</span>( index );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = attribute.<span class="hljs-title function_">getZ</span>( index );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span> = attribute.<span class="hljs-title function_">getW</span>( index );

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">toJSON</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toArray</span>();

	}

	<span class="hljs-title function_">_onChange</span>(<span class="hljs-params"> callback </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_onChangeCallback</span> = callback;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">_onChangeCallback</span>(<span class="hljs-params"></span>) {}

	*[ <span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span> ]() {

		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span>;
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span>;
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span>;
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_w</span>;

	}

}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Vector3</span> {
	<span class="hljs-title function_">constructor</span>(<span class="hljs-params"> x = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>, z = <span class="hljs-number">0</span> </span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = x;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = y;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = z;
	}

	<span class="hljs-title function_">set</span>(<span class="hljs-params"> x, y, z </span>) {
		<span class="hljs-keyword">if</span> ( z === <span class="hljs-literal">undefined</span> ) z = <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span>; <span class="hljs-comment">// sprite.scale.set(x,y)</span>

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = x;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = y;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = z;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">clone</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">constructor</span>(<span class="hljs-params"> <span class="hljs-variable language_">this</span>.x, <span class="hljs-variable language_">this</span>.y, <span class="hljs-variable language_">this</span>.z </span>);
	}

	<span class="hljs-title function_">copy</span>(<span class="hljs-params"> v </span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = v.<span class="hljs-property">x</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = v.<span class="hljs-property">y</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = v.<span class="hljs-property">z</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">add</span>(<span class="hljs-params"> v </span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> + v.<span class="hljs-property">x</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> + v.<span class="hljs-property">y</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> + v.<span class="hljs-property">z</span> );
	}

	<span class="hljs-title function_">divide</span>(<span class="hljs-params"> v </span>) {
		v = <span class="hljs-keyword">typeof</span> v === <span class="hljs-string">&#x27;number&#x27;</span> ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( v, v, v ) : v;
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> / v.<span class="hljs-property">x</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> / v.<span class="hljs-property">y</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> / v.<span class="hljs-property">z</span> );
	}

	<span class="hljs-title function_">dot</span>(<span class="hljs-params"> v </span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * v.<span class="hljs-property">x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * v.<span class="hljs-property">y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * v.<span class="hljs-property">z</span>;
	}

	<span class="hljs-title function_">equals</span>(<span class="hljs-params"> v </span>) {
		<span class="hljs-keyword">return</span> v.<span class="hljs-property">x</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> &amp;&amp; v.<span class="hljs-property">y</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> &amp;&amp; v.<span class="hljs-property">z</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span>;
	}

	<span class="hljs-title function_">cross</span>(<span class="hljs-params"> v </span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>(
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * v.<span class="hljs-property">z</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * v.<span class="hljs-property">y</span>,
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * v.<span class="hljs-property">x</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * v.<span class="hljs-property">z</span>,
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * v.<span class="hljs-property">y</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * v.<span class="hljs-property">x</span>
		);
	}

	<span class="hljs-title function_">rotateX</span>(<span class="hljs-params"> angle </span>) {
		<span class="hljs-keyword">const</span> cos = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( angle );
		<span class="hljs-keyword">const</span> sin = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( angle );

		<span class="hljs-keyword">const</span> y = <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * cos - <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * sin;
		<span class="hljs-keyword">const</span> z = <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * sin + <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * cos;

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span>, y, z );
	}

	<span class="hljs-title function_">rotateY</span>(<span class="hljs-params"> angle </span>) {
		<span class="hljs-keyword">const</span> cos = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( angle );
		<span class="hljs-keyword">const</span> sin = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( angle );

		<span class="hljs-keyword">const</span> x = <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * cos - <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * sin;
		<span class="hljs-keyword">const</span> z = <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * sin + <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * cos;

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( x, <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span>, z );
	}

	<span class="hljs-title function_">rotateZ</span>(<span class="hljs-params"> angle </span>) {
		<span class="hljs-keyword">const</span> cos = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( angle );
		<span class="hljs-keyword">const</span> sin = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( angle );

		<span class="hljs-keyword">const</span> x = <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * cos - <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * sin;
		<span class="hljs-keyword">const</span> y = <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * sin + <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * cos;

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( x, y, <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> );
	}
	

	<span class="hljs-title function_">valueOf</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">return</span> [ <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> ];
	}

	<span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-string">`(<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.x}</span>, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.y}</span>, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.z}</span>)`</span>;
	}

	<span class="hljs-title function_">applyAxisAngle</span>(<span class="hljs-params"> axis, angle </span>) {
		<span class="hljs-keyword">const</span> quaternion = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Quaternion</span>().<span class="hljs-title function_">setFromAxisAngle</span>( axis, angle );
		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyQuaternion</span>( quaternion );
	}

	<span class="hljs-title function_">applyQuaternion</span>(<span class="hljs-params"> q </span>) {
		<span class="hljs-keyword">const</span> x = <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span>, y = <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span>, z = <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span>;
		<span class="hljs-keyword">const</span> qx = q.<span class="hljs-property">x</span>, qy = q.<span class="hljs-property">y</span>, qz = q.<span class="hljs-property">z</span>, qw = q.<span class="hljs-property">w</span>;

		<span class="hljs-comment">// calculate quat * vector</span>

		<span class="hljs-keyword">const</span> ix = qw * x + qy * z - qz * y;
		<span class="hljs-keyword">const</span> iy = qw * y + qz * x - qx * z;
		<span class="hljs-keyword">const</span> iz = qw * z + qx * y - qy * x;
		<span class="hljs-keyword">const</span> iw = - qx * x - qy * y - qz * z;

		<span class="hljs-comment">// calculate result * inverse quat</span>

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = ix * qw + iw * - qx + iy * - qz - iz * - qy;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = iy * qw + iw * - qy + iz * - qx - ix * - qz;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = iz * qw + iw * - qz + ix * - qy - iy * - qx;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">subVectors</span>(<span class="hljs-params"> a, b </span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = a.<span class="hljs-property">x</span> - b.<span class="hljs-property">x</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = a.<span class="hljs-property">y</span> - b.<span class="hljs-property">y</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = a.<span class="hljs-property">z</span> - b.<span class="hljs-property">z</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">multiplyScalar</span>(<span class="hljs-params"> scalar </span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> *= scalar;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> *= scalar;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> *= scalar;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">divideScalar</span>(<span class="hljs-params"> scalar </span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyScalar</span>( <span class="hljs-number">1</span> / scalar );
	}

	<span class="hljs-title function_">lengthSq</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span>;
	}

	<span class="hljs-title function_">length</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> );
	}

	<span class="hljs-title function_">normalize</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">divideScalar</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">length</span>() || <span class="hljs-number">1</span> );
	}

	<span class="hljs-title function_">sub</span>(<span class="hljs-params"> v </span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> -= v.<span class="hljs-property">x</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> -= v.<span class="hljs-property">y</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> -= v.<span class="hljs-property">z</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">crossVectors</span>(<span class="hljs-params"> a, b </span>) {
		<span class="hljs-keyword">const</span> ax = a.<span class="hljs-property">x</span>, ay = a.<span class="hljs-property">y</span>, az = a.<span class="hljs-property">z</span>;
		<span class="hljs-keyword">const</span> bx = b.<span class="hljs-property">x</span>, by = b.<span class="hljs-property">y</span>, bz = b.<span class="hljs-property">z</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = ay * bz - az * by;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = az * bx - ax * bz;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = ax * by - ay * bx;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">setFromMatrixPosition</span>(<span class="hljs-params"> m </span>) {
		<span class="hljs-keyword">const</span> e = m.<span class="hljs-property">elements</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = e[ <span class="hljs-number">12</span> ];
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = e[ <span class="hljs-number">13</span> ];
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = e[ <span class="hljs-number">14</span> ];

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	*[ <span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span> ]() {
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span>;
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span>;
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span>;
	}

}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">WebGLCoordinateSystem</span> = <span class="hljs-number">2000</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title class_">WebGPUCoordinateSystem</span> = <span class="hljs-number">2001</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Matrix4</span> {
	<span class="hljs-title function_">constructor</span>(<span class="hljs-params"> n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 </span>) {
		<span class="hljs-title class_">Matrix4</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">isMatrix4</span> = <span class="hljs-literal">true</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span> = [
			<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>
		];

		<span class="hljs-keyword">if</span> ( n11 !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 );
		}

	}

	<span class="hljs-title function_">set</span>(<span class="hljs-params"> n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 </span>) {
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;
  
		te[ <span class="hljs-number">0</span> ] = n11; te[ <span class="hljs-number">4</span> ] = n12; te[ <span class="hljs-number">8</span> ] = n13; te[ <span class="hljs-number">12</span> ] = n14;
		te[ <span class="hljs-number">1</span> ] = n21; te[ <span class="hljs-number">5</span> ] = n22; te[ <span class="hljs-number">9</span> ] = n23; te[ <span class="hljs-number">13</span> ] = n24;
		te[ <span class="hljs-number">2</span> ] = n31; te[ <span class="hljs-number">6</span> ] = n32; te[ <span class="hljs-number">10</span> ] = n33; te[ <span class="hljs-number">14</span> ] = n34;
		te[ <span class="hljs-number">3</span> ] = n41; te[ <span class="hljs-number">7</span> ] = n42; te[ <span class="hljs-number">11</span> ] = n43; te[ <span class="hljs-number">15</span> ] = n44;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">identity</span>(<span class="hljs-params"></span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

			<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">clone</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>().<span class="hljs-title function_">fromArray</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span> );
	}

	<span class="hljs-title function_">copy</span>(<span class="hljs-params"> m </span>) {
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> me = m.<span class="hljs-property">elements</span>;

		te[ <span class="hljs-number">0</span> ] = me[ <span class="hljs-number">0</span> ]; te[ <span class="hljs-number">1</span> ] = me[ <span class="hljs-number">1</span> ]; te[ <span class="hljs-number">2</span> ] = me[ <span class="hljs-number">2</span> ]; te[ <span class="hljs-number">3</span> ] = me[ <span class="hljs-number">3</span> ];
		te[ <span class="hljs-number">4</span> ] = me[ <span class="hljs-number">4</span> ]; te[ <span class="hljs-number">5</span> ] = me[ <span class="hljs-number">5</span> ]; te[ <span class="hljs-number">6</span> ] = me[ <span class="hljs-number">6</span> ]; te[ <span class="hljs-number">7</span> ] = me[ <span class="hljs-number">7</span> ];
		te[ <span class="hljs-number">8</span> ] = me[ <span class="hljs-number">8</span> ]; te[ <span class="hljs-number">9</span> ] = me[ <span class="hljs-number">9</span> ]; te[ <span class="hljs-number">10</span> ] = me[ <span class="hljs-number">10</span> ]; te[ <span class="hljs-number">11</span> ] = me[ <span class="hljs-number">11</span> ];
		te[ <span class="hljs-number">12</span> ] = me[ <span class="hljs-number">12</span> ]; te[ <span class="hljs-number">13</span> ] = me[ <span class="hljs-number">13</span> ]; te[ <span class="hljs-number">14</span> ] = me[ <span class="hljs-number">14</span> ]; te[ <span class="hljs-number">15</span> ] = me[ <span class="hljs-number">15</span> ];

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">copyPosition</span>(<span class="hljs-params"> m </span>) {
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>, me = m.<span class="hljs-property">elements</span>;

		te[ <span class="hljs-number">12</span> ] = me[ <span class="hljs-number">12</span> ];
		te[ <span class="hljs-number">13</span> ] = me[ <span class="hljs-number">13</span> ];
		te[ <span class="hljs-number">14</span> ] = me[ <span class="hljs-number">14</span> ];

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">setFromMatrix3</span>(<span class="hljs-params"> m </span>) {
		<span class="hljs-keyword">const</span> me = m.<span class="hljs-property">elements</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

			me[ <span class="hljs-number">0</span> ], me[ <span class="hljs-number">3</span> ], me[ <span class="hljs-number">6</span> ], <span class="hljs-number">0</span>,
			me[ <span class="hljs-number">1</span> ], me[ <span class="hljs-number">4</span> ], me[ <span class="hljs-number">7</span> ], <span class="hljs-number">0</span>,
			me[ <span class="hljs-number">2</span> ], me[ <span class="hljs-number">5</span> ], me[ <span class="hljs-number">8</span> ], <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">extractBasis</span>(<span class="hljs-params"> xAxis, yAxis, zAxis </span>) {
		xAxis.<span class="hljs-title function_">setFromMatrixColumn</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-number">0</span> );
		yAxis.<span class="hljs-title function_">setFromMatrixColumn</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-number">1</span> );
		zAxis.<span class="hljs-title function_">setFromMatrixColumn</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-number">2</span> );

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">makeBasis</span>(<span class="hljs-params"> xAxis, yAxis, zAxis </span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(
			xAxis.<span class="hljs-property">x</span>, yAxis.<span class="hljs-property">x</span>, zAxis.<span class="hljs-property">x</span>, <span class="hljs-number">0</span>,
			xAxis.<span class="hljs-property">y</span>, yAxis.<span class="hljs-property">y</span>, zAxis.<span class="hljs-property">y</span>, <span class="hljs-number">0</span>,
			xAxis.<span class="hljs-property">z</span>, yAxis.<span class="hljs-property">z</span>, zAxis.<span class="hljs-property">z</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>
		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">extractRotation</span>(<span class="hljs-params"> m </span>) {
		<span class="hljs-comment">// this method does not support reflection matrices</span>

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> me = m.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">const</span> scaleX = <span class="hljs-number">1</span> / _v1.<span class="hljs-title function_">setFromMatrixColumn</span>( m, <span class="hljs-number">0</span> ).<span class="hljs-title function_">length</span>();
		<span class="hljs-keyword">const</span> scaleY = <span class="hljs-number">1</span> / _v1.<span class="hljs-title function_">setFromMatrixColumn</span>( m, <span class="hljs-number">1</span> ).<span class="hljs-title function_">length</span>();
		<span class="hljs-keyword">const</span> scaleZ = <span class="hljs-number">1</span> / _v1.<span class="hljs-title function_">setFromMatrixColumn</span>( m, <span class="hljs-number">2</span> ).<span class="hljs-title function_">length</span>();

		te[ <span class="hljs-number">0</span> ] = me[ <span class="hljs-number">0</span> ] * scaleX;
		te[ <span class="hljs-number">1</span> ] = me[ <span class="hljs-number">1</span> ] * scaleX;
		te[ <span class="hljs-number">2</span> ] = me[ <span class="hljs-number">2</span> ] * scaleX;
		te[ <span class="hljs-number">3</span> ] = <span class="hljs-number">0</span>;

		te[ <span class="hljs-number">4</span> ] = me[ <span class="hljs-number">4</span> ] * scaleY;
		te[ <span class="hljs-number">5</span> ] = me[ <span class="hljs-number">5</span> ] * scaleY;
		te[ <span class="hljs-number">6</span> ] = me[ <span class="hljs-number">6</span> ] * scaleY;
		te[ <span class="hljs-number">7</span> ] = <span class="hljs-number">0</span>;

		te[ <span class="hljs-number">8</span> ] = me[ <span class="hljs-number">8</span> ] * scaleZ;
		te[ <span class="hljs-number">9</span> ] = me[ <span class="hljs-number">9</span> ] * scaleZ;
		te[ <span class="hljs-number">10</span> ] = me[ <span class="hljs-number">10</span> ] * scaleZ;
		te[ <span class="hljs-number">11</span> ] = <span class="hljs-number">0</span>;

		te[ <span class="hljs-number">12</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">13</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">14</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">15</span> ] = <span class="hljs-number">1</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">makeRotationFromEuler</span>(<span class="hljs-params"> euler </span>) {
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">const</span> x = euler.<span class="hljs-property">x</span>, y = euler.<span class="hljs-property">y</span>, z = euler.<span class="hljs-property">z</span>;
		<span class="hljs-keyword">const</span> a = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( x ), b = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( x );
		<span class="hljs-keyword">const</span> c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( y ), d = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( y );
		<span class="hljs-keyword">const</span> e = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( z ), f = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( z );

		<span class="hljs-keyword">if</span> ( euler.<span class="hljs-property">order</span> === <span class="hljs-string">&#x27;XYZ&#x27;</span> ) {

			<span class="hljs-keyword">const</span> ae = a * e, af = a * f, be = b * e, bf = b * f;

			te[ <span class="hljs-number">0</span> ] = c * e;
			te[ <span class="hljs-number">4</span> ] = - c * f;
			te[ <span class="hljs-number">8</span> ] = d;

			te[ <span class="hljs-number">1</span> ] = af + be * d;
			te[ <span class="hljs-number">5</span> ] = ae - bf * d;
			te[ <span class="hljs-number">9</span> ] = - b * c;

			te[ <span class="hljs-number">2</span> ] = bf - ae * d;
			te[ <span class="hljs-number">6</span> ] = be + af * d;
			te[ <span class="hljs-number">10</span> ] = a * c;

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( euler.<span class="hljs-property">order</span> === <span class="hljs-string">&#x27;YXZ&#x27;</span> ) {

			<span class="hljs-keyword">const</span> ce = c * e, cf = c * f, de = d * e, df = d * f;

			te[ <span class="hljs-number">0</span> ] = ce + df * b;
			te[ <span class="hljs-number">4</span> ] = de * b - cf;
			te[ <span class="hljs-number">8</span> ] = a * d;

			te[ <span class="hljs-number">1</span> ] = a * f;
			te[ <span class="hljs-number">5</span> ] = a * e;
			te[ <span class="hljs-number">9</span> ] = - b;

			te[ <span class="hljs-number">2</span> ] = cf * b - de;
			te[ <span class="hljs-number">6</span> ] = df + ce * b;
			te[ <span class="hljs-number">10</span> ] = a * c;

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( euler.<span class="hljs-property">order</span> === <span class="hljs-string">&#x27;ZXY&#x27;</span> ) {

			<span class="hljs-keyword">const</span> ce = c * e, cf = c * f, de = d * e, df = d * f;

			te[ <span class="hljs-number">0</span> ] = ce - df * b;
			te[ <span class="hljs-number">4</span> ] = - a * f;
			te[ <span class="hljs-number">8</span> ] = de + cf * b;

			te[ <span class="hljs-number">1</span> ] = cf + de * b;
			te[ <span class="hljs-number">5</span> ] = a * e;
			te[ <span class="hljs-number">9</span> ] = df - ce * b;

			te[ <span class="hljs-number">2</span> ] = - a * d;
			te[ <span class="hljs-number">6</span> ] = b;
			te[ <span class="hljs-number">10</span> ] = a * c;

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( euler.<span class="hljs-property">order</span> === <span class="hljs-string">&#x27;ZYX&#x27;</span> ) {

			<span class="hljs-keyword">const</span> ae = a * e, af = a * f, be = b * e, bf = b * f;

			te[ <span class="hljs-number">0</span> ] = c * e;
			te[ <span class="hljs-number">4</span> ] = be * d - af;
			te[ <span class="hljs-number">8</span> ] = ae * d + bf;

			te[ <span class="hljs-number">1</span> ] = c * f;
			te[ <span class="hljs-number">5</span> ] = bf * d + ae;
			te[ <span class="hljs-number">9</span> ] = af * d - be;

			te[ <span class="hljs-number">2</span> ] = - d;
			te[ <span class="hljs-number">6</span> ] = b * c;
			te[ <span class="hljs-number">10</span> ] = a * c;

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( euler.<span class="hljs-property">order</span> === <span class="hljs-string">&#x27;YZX&#x27;</span> ) {

			<span class="hljs-keyword">const</span> ac = a * c, ad = a * d, bc = b * c, bd = b * d;

			te[ <span class="hljs-number">0</span> ] = c * e;
			te[ <span class="hljs-number">4</span> ] = bd - ac * f;
			te[ <span class="hljs-number">8</span> ] = bc * f + ad;

			te[ <span class="hljs-number">1</span> ] = f;
			te[ <span class="hljs-number">5</span> ] = a * e;
			te[ <span class="hljs-number">9</span> ] = - b * e;

			te[ <span class="hljs-number">2</span> ] = - d * e;
			te[ <span class="hljs-number">6</span> ] = ad * f + bc;
			te[ <span class="hljs-number">10</span> ] = ac - bd * f;

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( euler.<span class="hljs-property">order</span> === <span class="hljs-string">&#x27;XZY&#x27;</span> ) {

			<span class="hljs-keyword">const</span> ac = a * c, ad = a * d, bc = b * c, bd = b * d;

			te[ <span class="hljs-number">0</span> ] = c * e;
			te[ <span class="hljs-number">4</span> ] = - f;
			te[ <span class="hljs-number">8</span> ] = d * e;

			te[ <span class="hljs-number">1</span> ] = ac * f + bd;
			te[ <span class="hljs-number">5</span> ] = a * e;
			te[ <span class="hljs-number">9</span> ] = ad * f - bc;

			te[ <span class="hljs-number">2</span> ] = bc * f - ad;
			te[ <span class="hljs-number">6</span> ] = b * e;
			te[ <span class="hljs-number">10</span> ] = bd * f + ac;
		}

		<span class="hljs-comment">// bottom row</span>
		te[ <span class="hljs-number">3</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">7</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">11</span> ] = <span class="hljs-number">0</span>;

		<span class="hljs-comment">// last column</span>
		te[ <span class="hljs-number">12</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">13</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">14</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">15</span> ] = <span class="hljs-number">1</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">makeRotationFromQuaternion</span>(<span class="hljs-params"> q </span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">compose</span>( _zero, q, _one );
	}

	<span class="hljs-title function_">lookAt</span>(<span class="hljs-params"> eye, target, up </span>) {
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		_z.<span class="hljs-title function_">subVectors</span>( eye, target );

		<span class="hljs-keyword">if</span> ( _z.<span class="hljs-title function_">lengthSq</span>() === <span class="hljs-number">0</span> ) {
			<span class="hljs-comment">// eye and target are in the same position</span>

			_z.<span class="hljs-property">z</span> = <span class="hljs-number">1</span>;
		}

		_z.<span class="hljs-title function_">normalize</span>();
		_x.<span class="hljs-title function_">crossVectors</span>( up, _z );

		<span class="hljs-keyword">if</span> ( _x.<span class="hljs-title function_">lengthSq</span>() === <span class="hljs-number">0</span> ) {
			<span class="hljs-comment">// up and z are parallel</span>

			<span class="hljs-keyword">if</span> ( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( up.<span class="hljs-property">z</span> ) === <span class="hljs-number">1</span> ) {

				_z.<span class="hljs-property">x</span> += <span class="hljs-number">0.0001</span>;

			} <span class="hljs-keyword">else</span> {

				_z.<span class="hljs-property">z</span> += <span class="hljs-number">0.0001</span>;

			}

			_z.<span class="hljs-title function_">normalize</span>();
			_x.<span class="hljs-title function_">crossVectors</span>( up, _z );

		}

		_x.<span class="hljs-title function_">normalize</span>();
		_y.<span class="hljs-title function_">crossVectors</span>( _z, _x );

		te[ <span class="hljs-number">0</span> ] = _x.<span class="hljs-property">x</span>; te[ <span class="hljs-number">4</span> ] = _y.<span class="hljs-property">x</span>; te[ <span class="hljs-number">8</span> ] = _z.<span class="hljs-property">x</span>;
		te[ <span class="hljs-number">1</span> ] = _x.<span class="hljs-property">y</span>; te[ <span class="hljs-number">5</span> ] = _y.<span class="hljs-property">y</span>; te[ <span class="hljs-number">9</span> ] = _z.<span class="hljs-property">y</span>;
		te[ <span class="hljs-number">2</span> ] = _x.<span class="hljs-property">z</span>; te[ <span class="hljs-number">6</span> ] = _y.<span class="hljs-property">z</span>; te[ <span class="hljs-number">10</span> ] = _z.<span class="hljs-property">z</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">multiply</span>(<span class="hljs-params"> m </span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyMatrices</span>( <span class="hljs-variable language_">this</span>, m );

	}

	<span class="hljs-title function_">premultiply</span>(<span class="hljs-params"> m </span>) {
		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyMatrices</span>( m, <span class="hljs-variable language_">this</span> );
	}

	<span class="hljs-title function_">multiplyMatrices</span>(<span class="hljs-params"> a, b </span>) {
		<span class="hljs-keyword">const</span> ae = a.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> be = b.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">const</span> a11 = ae[ <span class="hljs-number">0</span> ], a12 = ae[ <span class="hljs-number">4</span> ], a13 = ae[ <span class="hljs-number">8</span> ], a14 = ae[ <span class="hljs-number">12</span> ];
		<span class="hljs-keyword">const</span> a21 = ae[ <span class="hljs-number">1</span> ], a22 = ae[ <span class="hljs-number">5</span> ], a23 = ae[ <span class="hljs-number">9</span> ], a24 = ae[ <span class="hljs-number">13</span> ];
		<span class="hljs-keyword">const</span> a31 = ae[ <span class="hljs-number">2</span> ], a32 = ae[ <span class="hljs-number">6</span> ], a33 = ae[ <span class="hljs-number">10</span> ], a34 = ae[ <span class="hljs-number">14</span> ];
		<span class="hljs-keyword">const</span> a41 = ae[ <span class="hljs-number">3</span> ], a42 = ae[ <span class="hljs-number">7</span> ], a43 = ae[ <span class="hljs-number">11</span> ], a44 = ae[ <span class="hljs-number">15</span> ];

		<span class="hljs-keyword">const</span> b11 = be[ <span class="hljs-number">0</span> ], b12 = be[ <span class="hljs-number">4</span> ], b13 = be[ <span class="hljs-number">8</span> ], b14 = be[ <span class="hljs-number">12</span> ];
		<span class="hljs-keyword">const</span> b21 = be[ <span class="hljs-number">1</span> ], b22 = be[ <span class="hljs-number">5</span> ], b23 = be[ <span class="hljs-number">9</span> ], b24 = be[ <span class="hljs-number">13</span> ];
		<span class="hljs-keyword">const</span> b31 = be[ <span class="hljs-number">2</span> ], b32 = be[ <span class="hljs-number">6</span> ], b33 = be[ <span class="hljs-number">10</span> ], b34 = be[ <span class="hljs-number">14</span> ];
		<span class="hljs-keyword">const</span> b41 = be[ <span class="hljs-number">3</span> ], b42 = be[ <span class="hljs-number">7</span> ], b43 = be[ <span class="hljs-number">11</span> ], b44 = be[ <span class="hljs-number">15</span> ];

		te[ <span class="hljs-number">0</span> ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;
		te[ <span class="hljs-number">4</span> ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;
		te[ <span class="hljs-number">8</span> ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;
		te[ <span class="hljs-number">12</span> ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;

		te[ <span class="hljs-number">1</span> ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;
		te[ <span class="hljs-number">5</span> ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;
		te[ <span class="hljs-number">9</span> ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;
		te[ <span class="hljs-number">13</span> ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;

		te[ <span class="hljs-number">2</span> ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;
		te[ <span class="hljs-number">6</span> ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;
		te[ <span class="hljs-number">10</span> ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;
		te[ <span class="hljs-number">14</span> ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;

		te[ <span class="hljs-number">3</span> ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;
		te[ <span class="hljs-number">7</span> ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;
		te[ <span class="hljs-number">11</span> ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;
		te[ <span class="hljs-number">15</span> ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">multiplyScalar</span>(<span class="hljs-params"> s </span>) {
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		te[ <span class="hljs-number">0</span> ] *= s; te[ <span class="hljs-number">4</span> ] *= s; te[ <span class="hljs-number">8</span> ] *= s; te[ <span class="hljs-number">12</span> ] *= s;
		te[ <span class="hljs-number">1</span> ] *= s; te[ <span class="hljs-number">5</span> ] *= s; te[ <span class="hljs-number">9</span> ] *= s; te[ <span class="hljs-number">13</span> ] *= s;
		te[ <span class="hljs-number">2</span> ] *= s; te[ <span class="hljs-number">6</span> ] *= s; te[ <span class="hljs-number">10</span> ] *= s; te[ <span class="hljs-number">14</span> ] *= s;
		te[ <span class="hljs-number">3</span> ] *= s; te[ <span class="hljs-number">7</span> ] *= s; te[ <span class="hljs-number">11</span> ] *= s; te[ <span class="hljs-number">15</span> ] *= s;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
	}

	<span class="hljs-title function_">determinant</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">const</span> n11 = te[ <span class="hljs-number">0</span> ], n12 = te[ <span class="hljs-number">4</span> ], n13 = te[ <span class="hljs-number">8</span> ], n14 = te[ <span class="hljs-number">12</span> ];
		<span class="hljs-keyword">const</span> n21 = te[ <span class="hljs-number">1</span> ], n22 = te[ <span class="hljs-number">5</span> ], n23 = te[ <span class="hljs-number">9</span> ], n24 = te[ <span class="hljs-number">13</span> ];
		<span class="hljs-keyword">const</span> n31 = te[ <span class="hljs-number">2</span> ], n32 = te[ <span class="hljs-number">6</span> ], n33 = te[ <span class="hljs-number">10</span> ], n34 = te[ <span class="hljs-number">14</span> ];
		<span class="hljs-keyword">const</span> n41 = te[ <span class="hljs-number">3</span> ], n42 = te[ <span class="hljs-number">7</span> ], n43 = te[ <span class="hljs-number">11</span> ], n44 = te[ <span class="hljs-number">15</span> ];

		<span class="hljs-comment">//<span class="hljs-doctag">TODO:</span> make this more efficient</span>
		<span class="hljs-comment">//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )</span>

		<span class="hljs-keyword">return</span> (
			n41 * (
				+ n14 * n23 * n32
				 - n13 * n24 * n32
				 - n14 * n22 * n33
				 + n12 * n24 * n33
				 + n13 * n22 * n34
				 - n12 * n23 * n34
			) +
			n42 * (
				+ n11 * n23 * n34
				 - n11 * n24 * n33
				 + n14 * n21 * n33
				 - n13 * n21 * n34
				 + n13 * n24 * n31
				 - n14 * n23 * n31
			) +
			n43 * (
				+ n11 * n24 * n32
				 - n11 * n22 * n34
				 - n14 * n21 * n32
				 + n12 * n21 * n34
				 + n14 * n22 * n31
				 - n12 * n24 * n31
			) +
			n44 * (
				- n13 * n22 * n31
				 - n11 * n23 * n32
				 + n11 * n22 * n33
				 + n13 * n21 * n32
				 - n12 * n21 * n33
				 + n12 * n23 * n31
			)

		);
	}

	<span class="hljs-title function_">transpose</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">let</span> tmp;

		tmp = te[ <span class="hljs-number">1</span> ]; te[ <span class="hljs-number">1</span> ] = te[ <span class="hljs-number">4</span> ]; te[ <span class="hljs-number">4</span> ] = tmp;
		tmp = te[ <span class="hljs-number">2</span> ]; te[ <span class="hljs-number">2</span> ] = te[ <span class="hljs-number">8</span> ]; te[ <span class="hljs-number">8</span> ] = tmp;
		tmp = te[ <span class="hljs-number">6</span> ]; te[ <span class="hljs-number">6</span> ] = te[ <span class="hljs-number">9</span> ]; te[ <span class="hljs-number">9</span> ] = tmp;

		tmp = te[ <span class="hljs-number">3</span> ]; te[ <span class="hljs-number">3</span> ] = te[ <span class="hljs-number">12</span> ]; te[ <span class="hljs-number">12</span> ] = tmp;
		tmp = te[ <span class="hljs-number">7</span> ]; te[ <span class="hljs-number">7</span> ] = te[ <span class="hljs-number">13</span> ]; te[ <span class="hljs-number">13</span> ] = tmp;
		tmp = te[ <span class="hljs-number">11</span> ]; te[ <span class="hljs-number">11</span> ] = te[ <span class="hljs-number">14</span> ]; te[ <span class="hljs-number">14</span> ] = tmp;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">setPosition</span>(<span class="hljs-params"> x, y, z </span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">if</span> ( x.<span class="hljs-property">isVector3</span> ) {

			te[ <span class="hljs-number">12</span> ] = x.<span class="hljs-property">x</span>;
			te[ <span class="hljs-number">13</span> ] = x.<span class="hljs-property">y</span>;
			te[ <span class="hljs-number">14</span> ] = x.<span class="hljs-property">z</span>;

		} <span class="hljs-keyword">else</span> {

			te[ <span class="hljs-number">12</span> ] = x;
			te[ <span class="hljs-number">13</span> ] = y;
			te[ <span class="hljs-number">14</span> ] = z;

		}

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">invert</span>(<span class="hljs-params"></span>) {

		<span class="hljs-comment">// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm</span>
		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>,

			n11 = te[ <span class="hljs-number">0</span> ], n21 = te[ <span class="hljs-number">1</span> ], n31 = te[ <span class="hljs-number">2</span> ], n41 = te[ <span class="hljs-number">3</span> ],
			n12 = te[ <span class="hljs-number">4</span> ], n22 = te[ <span class="hljs-number">5</span> ], n32 = te[ <span class="hljs-number">6</span> ], n42 = te[ <span class="hljs-number">7</span> ],
			n13 = te[ <span class="hljs-number">8</span> ], n23 = te[ <span class="hljs-number">9</span> ], n33 = te[ <span class="hljs-number">10</span> ], n43 = te[ <span class="hljs-number">11</span> ],
			n14 = te[ <span class="hljs-number">12</span> ], n24 = te[ <span class="hljs-number">13</span> ], n34 = te[ <span class="hljs-number">14</span> ], n44 = te[ <span class="hljs-number">15</span> ],

			t11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,
			t12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,
			t13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,
			t14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;

		<span class="hljs-keyword">const</span> det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;

		<span class="hljs-keyword">if</span> ( det === <span class="hljs-number">0</span> ) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>( <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span> );

		<span class="hljs-keyword">const</span> detInv = <span class="hljs-number">1</span> / det;

		te[ <span class="hljs-number">0</span> ] = t11 * detInv;
		te[ <span class="hljs-number">1</span> ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;
		te[ <span class="hljs-number">2</span> ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;
		te[ <span class="hljs-number">3</span> ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;

		te[ <span class="hljs-number">4</span> ] = t12 * detInv;
		te[ <span class="hljs-number">5</span> ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;
		te[ <span class="hljs-number">6</span> ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;
		te[ <span class="hljs-number">7</span> ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;

		te[ <span class="hljs-number">8</span> ] = t13 * detInv;
		te[ <span class="hljs-number">9</span> ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;
		te[ <span class="hljs-number">10</span> ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;
		te[ <span class="hljs-number">11</span> ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;

		te[ <span class="hljs-number">12</span> ] = t14 * detInv;
		te[ <span class="hljs-number">13</span> ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;
		te[ <span class="hljs-number">14</span> ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;
		te[ <span class="hljs-number">15</span> ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">scale</span>(<span class="hljs-params"> v </span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> x = v.<span class="hljs-property">x</span>, y = v.<span class="hljs-property">y</span>, z = v.<span class="hljs-property">z</span>;

		te[ <span class="hljs-number">0</span> ] *= x; te[ <span class="hljs-number">4</span> ] *= y; te[ <span class="hljs-number">8</span> ] *= z;
		te[ <span class="hljs-number">1</span> ] *= x; te[ <span class="hljs-number">5</span> ] *= y; te[ <span class="hljs-number">9</span> ] *= z;
		te[ <span class="hljs-number">2</span> ] *= x; te[ <span class="hljs-number">6</span> ] *= y; te[ <span class="hljs-number">10</span> ] *= z;
		te[ <span class="hljs-number">3</span> ] *= x; te[ <span class="hljs-number">7</span> ] *= y; te[ <span class="hljs-number">11</span> ] *= z;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">getMaxScaleOnAxis</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">const</span> scaleXSq = te[ <span class="hljs-number">0</span> ] * te[ <span class="hljs-number">0</span> ] + te[ <span class="hljs-number">1</span> ] * te[ <span class="hljs-number">1</span> ] + te[ <span class="hljs-number">2</span> ] * te[ <span class="hljs-number">2</span> ];
		<span class="hljs-keyword">const</span> scaleYSq = te[ <span class="hljs-number">4</span> ] * te[ <span class="hljs-number">4</span> ] + te[ <span class="hljs-number">5</span> ] * te[ <span class="hljs-number">5</span> ] + te[ <span class="hljs-number">6</span> ] * te[ <span class="hljs-number">6</span> ];
		<span class="hljs-keyword">const</span> scaleZSq = te[ <span class="hljs-number">8</span> ] * te[ <span class="hljs-number">8</span> ] + te[ <span class="hljs-number">9</span> ] * te[ <span class="hljs-number">9</span> ] + te[ <span class="hljs-number">10</span> ] * te[ <span class="hljs-number">10</span> ];

		<span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>( scaleXSq, scaleYSq, scaleZSq ) );

	}

	<span class="hljs-title function_">makeTranslation</span>(<span class="hljs-params"> x, y, z </span>) {

		<span class="hljs-keyword">if</span> ( x.<span class="hljs-property">isVector3</span> ) {

			<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

				<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, x.<span class="hljs-property">x</span>,
				<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, x.<span class="hljs-property">y</span>,
				<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, x.<span class="hljs-property">z</span>,
				<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

			);

		} <span class="hljs-keyword">else</span> {

			<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

				<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, x,
				<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, y,
				<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, z,
				<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

			);

		}

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">makeRotationX</span>(<span class="hljs-params"> theta </span>) {

		<span class="hljs-keyword">const</span> c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( theta ), s = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( theta );

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

			<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, c, - s, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, s, c, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">makeRotationY</span>(<span class="hljs-params"> theta </span>) {

		<span class="hljs-keyword">const</span> c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( theta ), s = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( theta );

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

			 c, <span class="hljs-number">0</span>, s, <span class="hljs-number">0</span>,
			 <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			- s, <span class="hljs-number">0</span>, c, <span class="hljs-number">0</span>,
			 <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">makeRotationZ</span>(<span class="hljs-params"> theta </span>) {

		<span class="hljs-keyword">const</span> c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( theta ), s = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( theta );

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

			c, - s, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			s, c, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">makeRotationAxis</span>(<span class="hljs-params"> axis, angle </span>) {

		<span class="hljs-comment">// Based on http://www.gamedev.net/reference/articles/article1199.asp</span>

		<span class="hljs-keyword">const</span> c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>( angle );
		<span class="hljs-keyword">const</span> s = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>( angle );
		<span class="hljs-keyword">const</span> t = <span class="hljs-number">1</span> - c;
		<span class="hljs-keyword">const</span> x = axis.<span class="hljs-property">x</span>, y = axis.<span class="hljs-property">y</span>, z = axis.<span class="hljs-property">z</span>;
		<span class="hljs-keyword">const</span> tx = t * x, ty = t * y;

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

			tx * x + c, tx * y - s * z, tx * z + s * y, <span class="hljs-number">0</span>,
			tx * y + s * z, ty * y + c, ty * z - s * x, <span class="hljs-number">0</span>,
			tx * z - s * y, ty * z + s * x, t * z * z + c, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">makeScale</span>(<span class="hljs-params"> x, y, z </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

			x, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, y, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, z, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">makeShear</span>(<span class="hljs-params"> xy, xz, yx, yz, zx, zy </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(

			<span class="hljs-number">1</span>, yx, zx, <span class="hljs-number">0</span>,
			xy, <span class="hljs-number">1</span>, zy, <span class="hljs-number">0</span>,
			xz, yz, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>,
			<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>

		);

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">compose</span>(<span class="hljs-params"> position, quaternion, scale </span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">const</span> x = quaternion.<span class="hljs-property">_x</span>, y = quaternion.<span class="hljs-property">_y</span>, z = quaternion.<span class="hljs-property">_z</span>, w = quaternion.<span class="hljs-property">_w</span>;
		<span class="hljs-keyword">const</span> x2 = x + x,	y2 = y + y, z2 = z + z;
		<span class="hljs-keyword">const</span> xx = x * x2, xy = x * y2, xz = x * z2;
		<span class="hljs-keyword">const</span> yy = y * y2, yz = y * z2, zz = z * z2;
		<span class="hljs-keyword">const</span> wx = w * x2, wy = w * y2, wz = w * z2;

		<span class="hljs-keyword">const</span> sx = scale.<span class="hljs-property">x</span>, sy = scale.<span class="hljs-property">y</span>, sz = scale.<span class="hljs-property">z</span>;

		te[ <span class="hljs-number">0</span> ] = ( <span class="hljs-number">1</span> - ( yy + zz ) ) * sx;
		te[ <span class="hljs-number">1</span> ] = ( xy + wz ) * sx;
		te[ <span class="hljs-number">2</span> ] = ( xz - wy ) * sx;
		te[ <span class="hljs-number">3</span> ] = <span class="hljs-number">0</span>;

		te[ <span class="hljs-number">4</span> ] = ( xy - wz ) * sy;
		te[ <span class="hljs-number">5</span> ] = ( <span class="hljs-number">1</span> - ( xx + zz ) ) * sy;
		te[ <span class="hljs-number">6</span> ] = ( yz + wx ) * sy;
		te[ <span class="hljs-number">7</span> ] = <span class="hljs-number">0</span>;

		te[ <span class="hljs-number">8</span> ] = ( xz + wy ) * sz;
		te[ <span class="hljs-number">9</span> ] = ( yz - wx ) * sz;
		te[ <span class="hljs-number">10</span> ] = ( <span class="hljs-number">1</span> - ( xx + yy ) ) * sz;
		te[ <span class="hljs-number">11</span> ] = <span class="hljs-number">0</span>;

		te[ <span class="hljs-number">12</span> ] = position.<span class="hljs-property">x</span>;
		te[ <span class="hljs-number">13</span> ] = position.<span class="hljs-property">y</span>;
		te[ <span class="hljs-number">14</span> ] = position.<span class="hljs-property">z</span>;
		te[ <span class="hljs-number">15</span> ] = <span class="hljs-number">1</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">decompose</span>(<span class="hljs-params"> position, quaternion, scale </span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">let</span> sx = _v1.<span class="hljs-title function_">set</span>( te[ <span class="hljs-number">0</span> ], te[ <span class="hljs-number">1</span> ], te[ <span class="hljs-number">2</span> ] ).<span class="hljs-title function_">length</span>();
		<span class="hljs-keyword">const</span> sy = _v1.<span class="hljs-title function_">set</span>( te[ <span class="hljs-number">4</span> ], te[ <span class="hljs-number">5</span> ], te[ <span class="hljs-number">6</span> ] ).<span class="hljs-title function_">length</span>();
		<span class="hljs-keyword">const</span> sz = _v1.<span class="hljs-title function_">set</span>( te[ <span class="hljs-number">8</span> ], te[ <span class="hljs-number">9</span> ], te[ <span class="hljs-number">10</span> ] ).<span class="hljs-title function_">length</span>();

		<span class="hljs-comment">// if determine is negative, we need to invert one scale</span>
		<span class="hljs-keyword">const</span> det = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">determinant</span>();
		<span class="hljs-keyword">if</span> ( det &lt; <span class="hljs-number">0</span> ) sx = - sx;

		position.<span class="hljs-property">x</span> = te[ <span class="hljs-number">12</span> ];
		position.<span class="hljs-property">y</span> = te[ <span class="hljs-number">13</span> ];
		position.<span class="hljs-property">z</span> = te[ <span class="hljs-number">14</span> ];

		<span class="hljs-comment">// scale the rotation part</span>
		_m1$1.<span class="hljs-title function_">copy</span>( <span class="hljs-variable language_">this</span> );

		<span class="hljs-keyword">const</span> invSX = <span class="hljs-number">1</span> / sx;
		<span class="hljs-keyword">const</span> invSY = <span class="hljs-number">1</span> / sy;
		<span class="hljs-keyword">const</span> invSZ = <span class="hljs-number">1</span> / sz;

		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">0</span> ] *= invSX;
		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">1</span> ] *= invSX;
		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">2</span> ] *= invSX;

		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">4</span> ] *= invSY;
		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">5</span> ] *= invSY;
		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">6</span> ] *= invSY;

		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">8</span> ] *= invSZ;
		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">9</span> ] *= invSZ;
		_m1$1.<span class="hljs-property">elements</span>[ <span class="hljs-number">10</span> ] *= invSZ;

		quaternion.<span class="hljs-title function_">setFromRotationMatrix</span>( _m1$1 );

		scale.<span class="hljs-property">x</span> = sx;
		scale.<span class="hljs-property">y</span> = sy;
		scale.<span class="hljs-property">z</span> = sz;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">makePerspective</span>(<span class="hljs-params"> left, right, top, bottom, near, far, coordinateSystem = WebGLCoordinateSystem </span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> x = <span class="hljs-number">2</span> * near / ( right - left );
		<span class="hljs-keyword">const</span> y = <span class="hljs-number">2</span> * near / ( top - bottom );

		<span class="hljs-keyword">const</span> a = ( right + left ) / ( right - left );
		<span class="hljs-keyword">const</span> b = ( top + bottom ) / ( top - bottom );

		<span class="hljs-keyword">let</span> c, d;

		<span class="hljs-keyword">if</span> ( coordinateSystem === <span class="hljs-title class_">WebGLCoordinateSystem</span> ) {

			c = - ( far + near ) / ( far - near );
			d = ( - <span class="hljs-number">2</span> * far * near ) / ( far - near );

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( coordinateSystem === <span class="hljs-title class_">WebGPUCoordinateSystem</span> ) {

			c = - far / ( far - near );
			d = ( - far * near ) / ( far - near );

		} <span class="hljs-keyword">else</span> {

			<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>( <span class="hljs-string">&#x27;THREE.Matrix4.makePerspective(): Invalid coordinate system: &#x27;</span> + coordinateSystem );

		}

		te[ <span class="hljs-number">0</span> ] = x;	te[ <span class="hljs-number">4</span> ] = <span class="hljs-number">0</span>;	te[ <span class="hljs-number">8</span> ] = a; 	te[ <span class="hljs-number">12</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">1</span> ] = <span class="hljs-number">0</span>;	te[ <span class="hljs-number">5</span> ] = y;	te[ <span class="hljs-number">9</span> ] = b; 	te[ <span class="hljs-number">13</span> ] = <span class="hljs-number">0</span>;
		te[ <span class="hljs-number">2</span> ] = <span class="hljs-number">0</span>;	te[ <span class="hljs-number">6</span> ] = <span class="hljs-number">0</span>;	te[ <span class="hljs-number">10</span> ] = c; 	te[ <span class="hljs-number">14</span> ] = d;
		te[ <span class="hljs-number">3</span> ] = <span class="hljs-number">0</span>;	te[ <span class="hljs-number">7</span> ] = <span class="hljs-number">0</span>;	te[ <span class="hljs-number">11</span> ] = - <span class="hljs-number">1</span>;	te[ <span class="hljs-number">15</span> ] = <span class="hljs-number">0</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">makeOrthographic</span>(<span class="hljs-params"> left, right, top, bottom, near, far, coordinateSystem = WebGLCoordinateSystem </span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> w = <span class="hljs-number">1.0</span> / ( right - left );
		<span class="hljs-keyword">const</span> h = <span class="hljs-number">1.0</span> / ( top - bottom );
		<span class="hljs-keyword">const</span> p = <span class="hljs-number">1.0</span> / ( far - near );

		<span class="hljs-keyword">const</span> x = ( right + left ) * w;
		<span class="hljs-keyword">const</span> y = ( top + bottom ) * h;

		<span class="hljs-keyword">let</span> z, zInv;

		<span class="hljs-keyword">if</span> ( coordinateSystem === <span class="hljs-title class_">WebGLCoordinateSystem</span> ) {

			z = ( far + near ) * p;
			zInv = - <span class="hljs-number">2</span> * p;

		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( coordinateSystem === <span class="hljs-title class_">WebGPUCoordinateSystem</span> ) {

			z = near * p;
			zInv = - <span class="hljs-number">1</span> * p;

		} <span class="hljs-keyword">else</span> {

			<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>( <span class="hljs-string">&#x27;THREE.Matrix4.makeOrthographic(): Invalid coordinate system: &#x27;</span> + coordinateSystem );

		}

		te[ <span class="hljs-number">0</span> ] = <span class="hljs-number">2</span> * w;	te[ <span class="hljs-number">4</span> ] = <span class="hljs-number">0</span>;		te[ <span class="hljs-number">8</span> ] = <span class="hljs-number">0</span>; 		te[ <span class="hljs-number">12</span> ] = - x;
		te[ <span class="hljs-number">1</span> ] = <span class="hljs-number">0</span>; 		te[ <span class="hljs-number">5</span> ] = <span class="hljs-number">2</span> * h;	te[ <span class="hljs-number">9</span> ] = <span class="hljs-number">0</span>; 		te[ <span class="hljs-number">13</span> ] = - y;
		te[ <span class="hljs-number">2</span> ] = <span class="hljs-number">0</span>; 		te[ <span class="hljs-number">6</span> ] = <span class="hljs-number">0</span>;		te[ <span class="hljs-number">10</span> ] = zInv;	te[ <span class="hljs-number">14</span> ] = - z;
		te[ <span class="hljs-number">3</span> ] = <span class="hljs-number">0</span>; 		te[ <span class="hljs-number">7</span> ] = <span class="hljs-number">0</span>;		te[ <span class="hljs-number">11</span> ] = <span class="hljs-number">0</span>;		te[ <span class="hljs-number">15</span> ] = <span class="hljs-number">1</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">equals</span>(<span class="hljs-params"> matrix </span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> me = matrix.<span class="hljs-property">elements</span>;

		<span class="hljs-keyword">for</span> ( <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i ++ ) {

			<span class="hljs-keyword">if</span> ( te[ i ] !== me[ i ] ) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

		}

		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

	}

	<span class="hljs-title function_">fromArray</span>(<span class="hljs-params"> array, offset = <span class="hljs-number">0</span> </span>) {

		<span class="hljs-keyword">for</span> ( <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i ++ ) {

			<span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>[ i ] = array[ i + offset ];

		}

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">toArray</span>(<span class="hljs-params"> array = [], offset = <span class="hljs-number">0</span> </span>) {

		<span class="hljs-keyword">const</span> te = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>;

		array[ offset ] = te[ <span class="hljs-number">0</span> ];
		array[ offset + <span class="hljs-number">1</span> ] = te[ <span class="hljs-number">1</span> ];
		array[ offset + <span class="hljs-number">2</span> ] = te[ <span class="hljs-number">2</span> ];
		array[ offset + <span class="hljs-number">3</span> ] = te[ <span class="hljs-number">3</span> ];

		array[ offset + <span class="hljs-number">4</span> ] = te[ <span class="hljs-number">4</span> ];
		array[ offset + <span class="hljs-number">5</span> ] = te[ <span class="hljs-number">5</span> ];
		array[ offset + <span class="hljs-number">6</span> ] = te[ <span class="hljs-number">6</span> ];
		array[ offset + <span class="hljs-number">7</span> ] = te[ <span class="hljs-number">7</span> ];

		array[ offset + <span class="hljs-number">8</span> ] = te[ <span class="hljs-number">8</span> ];
		array[ offset + <span class="hljs-number">9</span> ] = te[ <span class="hljs-number">9</span> ];
		array[ offset + <span class="hljs-number">10</span> ] = te[ <span class="hljs-number">10</span> ];
		array[ offset + <span class="hljs-number">11</span> ] = te[ <span class="hljs-number">11</span> ];

		array[ offset + <span class="hljs-number">12</span> ] = te[ <span class="hljs-number">12</span> ];
		array[ offset + <span class="hljs-number">13</span> ] = te[ <span class="hljs-number">13</span> ];
		array[ offset + <span class="hljs-number">14</span> ] = te[ <span class="hljs-number">14</span> ];
		array[ offset + <span class="hljs-number">15</span> ] = te[ <span class="hljs-number">15</span> ];

		<span class="hljs-keyword">return</span> array;

	}

}

<span class="hljs-keyword">const</span> _v1 = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>();
<span class="hljs-keyword">const</span> _m1$1 = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>();
<span class="hljs-keyword">const</span> _zero = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span> );
<span class="hljs-keyword">const</span> _one = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span> );
<span class="hljs-keyword">const</span> _x = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>();
<span class="hljs-keyword">const</span> _y = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>();
<span class="hljs-keyword">const</span> _z = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>();

<span class="hljs-keyword">const</span> _matrix = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>();
<span class="hljs-keyword">const</span> _quaternion = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Quaternion</span>();

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Euler</span> {

	<span class="hljs-title function_">constructor</span>(<span class="hljs-params"> x = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>, z = <span class="hljs-number">0</span>, order = Euler.DEFAULT_ORDER </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">isEuler</span> = <span class="hljs-literal">true</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = x;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = y;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = z;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span> = order;

	}

	<span class="hljs-keyword">get</span> <span class="hljs-title function_">x</span>() {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span>;

	}

	<span class="hljs-keyword">set</span> <span class="hljs-title function_">x</span>(<span class="hljs-params"> value </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = value;
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

	}

	<span class="hljs-keyword">get</span> <span class="hljs-title function_">y</span>() {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span>;

	}

	<span class="hljs-keyword">set</span> <span class="hljs-title function_">y</span>(<span class="hljs-params"> value </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = value;
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

	}

	<span class="hljs-keyword">get</span> <span class="hljs-title function_">z</span>() {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span>;

	}

	<span class="hljs-keyword">set</span> <span class="hljs-title function_">z</span>(<span class="hljs-params"> value </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = value;
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

	}

	<span class="hljs-keyword">get</span> <span class="hljs-title function_">order</span>() {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span>;

	}

	<span class="hljs-keyword">set</span> <span class="hljs-title function_">order</span>(<span class="hljs-params"> value </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span> = value;
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

	}

	<span class="hljs-title function_">set</span>(<span class="hljs-params"> x, y, z, order = <span class="hljs-variable language_">this</span>._order </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = x;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = y;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = z;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span> = order;

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">clone</span>(<span class="hljs-params"></span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">constructor</span>(<span class="hljs-params"> <span class="hljs-variable language_">this</span>._x, <span class="hljs-variable language_">this</span>._y, <span class="hljs-variable language_">this</span>._z, <span class="hljs-variable language_">this</span>._order </span>);

	}

	<span class="hljs-title function_">copy</span>(<span class="hljs-params"> euler </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = euler.<span class="hljs-property">_x</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = euler.<span class="hljs-property">_y</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = euler.<span class="hljs-property">_z</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span> = euler.<span class="hljs-property">_order</span>;

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">setFromRotationMatrix</span>(<span class="hljs-params"> m, order = <span class="hljs-variable language_">this</span>._order, update = <span class="hljs-literal">true</span> </span>) {

		<span class="hljs-comment">// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)</span>

		<span class="hljs-keyword">const</span> te = m.<span class="hljs-property">elements</span>;
		<span class="hljs-keyword">const</span> m11 = te[ <span class="hljs-number">0</span> ], m12 = te[ <span class="hljs-number">4</span> ], m13 = te[ <span class="hljs-number">8</span> ];
		<span class="hljs-keyword">const</span> m21 = te[ <span class="hljs-number">1</span> ], m22 = te[ <span class="hljs-number">5</span> ], m23 = te[ <span class="hljs-number">9</span> ];
		<span class="hljs-keyword">const</span> m31 = te[ <span class="hljs-number">2</span> ], m32 = te[ <span class="hljs-number">6</span> ], m33 = te[ <span class="hljs-number">10</span> ];

		<span class="hljs-keyword">switch</span> ( order ) {

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;XYZ&#x27;</span>:

				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">asin</span>( <span class="hljs-title function_">clamp</span>( m13, - <span class="hljs-number">1</span>, <span class="hljs-number">1</span> ) );

				<span class="hljs-keyword">if</span> ( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( m13 ) &lt; <span class="hljs-number">0.9999999</span> ) {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m23, m33 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m12, m11 );

				} <span class="hljs-keyword">else</span> {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m32, m22 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-number">0</span>;

				}

				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;YXZ&#x27;</span>:

				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">asin</span>( - <span class="hljs-title function_">clamp</span>( m23, - <span class="hljs-number">1</span>, <span class="hljs-number">1</span> ) );

				<span class="hljs-keyword">if</span> ( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( m23 ) &lt; <span class="hljs-number">0.9999999</span> ) {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m13, m33 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m21, m22 );

				} <span class="hljs-keyword">else</span> {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m31, m11 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-number">0</span>;

				}

				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ZXY&#x27;</span>:

				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">asin</span>( <span class="hljs-title function_">clamp</span>( m32, - <span class="hljs-number">1</span>, <span class="hljs-number">1</span> ) );

				<span class="hljs-keyword">if</span> ( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( m32 ) &lt; <span class="hljs-number">0.9999999</span> ) {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m31, m33 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m12, m22 );

				} <span class="hljs-keyword">else</span> {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-number">0</span>;
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m21, m11 );

				}

				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ZYX&#x27;</span>:

				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">asin</span>( - <span class="hljs-title function_">clamp</span>( m31, - <span class="hljs-number">1</span>, <span class="hljs-number">1</span> ) );

				<span class="hljs-keyword">if</span> ( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( m31 ) &lt; <span class="hljs-number">0.9999999</span> ) {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m32, m33 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m21, m11 );

				} <span class="hljs-keyword">else</span> {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-number">0</span>;
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m12, m22 );

				}

				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;YZX&#x27;</span>:

				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">asin</span>( <span class="hljs-title function_">clamp</span>( m21, - <span class="hljs-number">1</span>, <span class="hljs-number">1</span> ) );

				<span class="hljs-keyword">if</span> ( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( m21 ) &lt; <span class="hljs-number">0.9999999</span> ) {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m23, m22 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m31, m11 );

				} <span class="hljs-keyword">else</span> {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-number">0</span>;
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m13, m33 );

				}

				<span class="hljs-keyword">break</span>;

			<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;XZY&#x27;</span>:

				<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">asin</span>( - <span class="hljs-title function_">clamp</span>( m12, - <span class="hljs-number">1</span>, <span class="hljs-number">1</span> ) );

				<span class="hljs-keyword">if</span> ( <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( m12 ) &lt; <span class="hljs-number">0.9999999</span> ) {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m32, m22 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( m13, m11 );

				} <span class="hljs-keyword">else</span> {

					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>( - m23, m33 );
					<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = <span class="hljs-number">0</span>;

				}

				<span class="hljs-keyword">break</span>;

			<span class="hljs-attr">default</span>:

				<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>( <span class="hljs-string">&#x27;THREE.Euler: .setFromRotationMatrix() encountered an unknown order: &#x27;</span> + order );

		}

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span> = order;

		<span class="hljs-keyword">if</span> ( update === <span class="hljs-literal">true</span> ) <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">setFromQuaternion</span>(<span class="hljs-params"> q, order, update </span>) {

		_matrix.<span class="hljs-title function_">makeRotationFromQuaternion</span>( q );

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setFromRotationMatrix</span>( _matrix, order, update );

	}

	<span class="hljs-title function_">setFromVector3</span>(<span class="hljs-params"> v, order = <span class="hljs-variable language_">this</span>._order </span>) {

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>( v.<span class="hljs-property">x</span>, v.<span class="hljs-property">y</span>, v.<span class="hljs-property">z</span>, order );

	}

	<span class="hljs-title function_">reorder</span>(<span class="hljs-params"> newOrder </span>) {

		<span class="hljs-comment">// WARNING: this discards revolution information -bhouston</span>

		_quaternion.<span class="hljs-title function_">setFromEuler</span>( <span class="hljs-variable language_">this</span> );

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setFromQuaternion</span>( _quaternion, newOrder );

	}

	<span class="hljs-title function_">equals</span>(<span class="hljs-params"> euler </span>) {

		<span class="hljs-keyword">return</span> ( euler.<span class="hljs-property">_x</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> ) &amp;&amp; ( euler.<span class="hljs-property">_y</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> ) &amp;&amp; ( euler.<span class="hljs-property">_z</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> ) &amp;&amp; ( euler.<span class="hljs-property">_order</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span> );

	}

	<span class="hljs-title function_">fromArray</span>(<span class="hljs-params"> array </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span> = array[ <span class="hljs-number">0</span> ];
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span> = array[ <span class="hljs-number">1</span> ];
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span> = array[ <span class="hljs-number">2</span> ];
		<span class="hljs-keyword">if</span> ( array[ <span class="hljs-number">3</span> ] !== <span class="hljs-literal">undefined</span> ) <span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span> = array[ <span class="hljs-number">3</span> ];

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onChangeCallback</span>();

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">toArray</span>(<span class="hljs-params"> array = [], offset = <span class="hljs-number">0</span> </span>) {

		array[ offset ] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span>;
		array[ offset + <span class="hljs-number">1</span> ] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span>;
		array[ offset + <span class="hljs-number">2</span> ] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span>;
		array[ offset + <span class="hljs-number">3</span> ] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span>;

		<span class="hljs-keyword">return</span> array;

	}

	<span class="hljs-title function_">_onChange</span>(<span class="hljs-params"> callback </span>) {

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">_onChangeCallback</span> = callback;

		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

	}

	<span class="hljs-title function_">_onChangeCallback</span>(<span class="hljs-params"></span>) {}

	*[ <span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span> ]() {

		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_x</span>;
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_y</span>;
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_z</span>;
		<span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_order</span>;

	}

}

<span class="hljs-title class_">Euler</span>.<span class="hljs-property">DEFAULT_ORDER</span> = <span class="hljs-string">&#x27;XYZ&#x27;</span>;

<span class="hljs-keyword">const</span> _m1 = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>();
<span class="hljs-keyword">const</span> _target = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>();
<span class="hljs-keyword">const</span> _position = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>();

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Object3D</span> {
	<span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">up</span> = <span class="hljs-title class_">Object3D</span>.<span class="hljs-property">DEFAULT_UP</span>.<span class="hljs-title function_">clone</span>();
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">position</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>();
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span> =  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Euler</span>();
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">quaternion</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Quaternion</span>();
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">scale</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span> );

		<span class="hljs-keyword">const</span> <span class="hljs-title function_">onRotationChange</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">quaternion</span>.<span class="hljs-title function_">setFromEuler</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span>, <span class="hljs-literal">false</span> );
		<span class="hljs-keyword">const</span> <span class="hljs-title function_">onQuaternionChange</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span>.<span class="hljs-title function_">setFromQuaternion</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">quaternion</span>, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">false</span> );

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span>.<span class="hljs-title function_">_onChange</span>( onRotationChange );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">quaternion</span>.<span class="hljs-title function_">_onChange</span>( onQuaternionChange );

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrix</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>();
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorld</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>();
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorldNeedsUpdate</span> = <span class="hljs-literal">false</span>;
	}

	<span class="hljs-title function_">lookAt</span>(<span class="hljs-params"> x, y, z </span>) {
		<span class="hljs-keyword">if</span> ( x.<span class="hljs-property">isVector3</span> ) {
			_target.<span class="hljs-title function_">copy</span>( x );
		} <span class="hljs-keyword">else</span> {
			_target.<span class="hljs-title function_">set</span>( x, y, z );
		}

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateWorldMatrix</span>( <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span> );
		_position.<span class="hljs-title function_">setFromMatrixPosition</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorld</span> );
		_m1.<span class="hljs-title function_">lookAt</span>( _position, _target, <span class="hljs-variable language_">this</span>.<span class="hljs-property">up</span> );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">quaternion</span>.<span class="hljs-title function_">setFromRotationMatrix</span>( _m1 );
	}

	<span class="hljs-title function_">updateMatrix</span>(<span class="hljs-params"></span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrix</span>.<span class="hljs-title function_">compose</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">position</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">quaternion</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">scale</span> );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorldNeedsUpdate</span> = <span class="hljs-literal">true</span>;
	}

	<span class="hljs-title function_">updateMatrixWorld</span>(<span class="hljs-params"> force </span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateMatrix</span>();
		
		<span class="hljs-keyword">if</span> ( <span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorldNeedsUpdate</span> || force ) {
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorld</span>.<span class="hljs-title function_">copy</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">matrix</span> );
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorldNeedsUpdate</span> = <span class="hljs-literal">false</span>;

			force = <span class="hljs-literal">true</span>;
		}
	}

	<span class="hljs-title function_">updateWorldMatrix</span>(<span class="hljs-params"> updateParents, updateChildren </span>) {
		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateMatrix</span>();

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorld</span>.<span class="hljs-title function_">copy</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">matrix</span> );
	}
}

<span class="hljs-title class_">Object3D</span>.<span class="hljs-property">DEFAULT_UP</span> = <span class="hljs-comment">/*@__PURE__*/</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>( <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span> );

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Camera</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Object3D</span> {
	<span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
		<span class="hljs-variable language_">super</span>();

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorldInverse</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>();
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">projectionMatrix</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>();
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">projectionMatrixInverse</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Matrix4</span>();
	}

	<span class="hljs-title function_">updateMatrixWorld</span>(<span class="hljs-params"> force </span>) {
		<span class="hljs-variable language_">super</span>.<span class="hljs-title function_">updateMatrixWorld</span>( force );

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorldInverse</span>.<span class="hljs-title function_">copy</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorld</span> ).<span class="hljs-title function_">invert</span>();
	}
 
	<span class="hljs-title function_">updateWorldMatrix</span>(<span class="hljs-params"> updateParents, updateChildren </span>) {
		<span class="hljs-variable language_">super</span>.<span class="hljs-title function_">updateWorldMatrix</span>( updateParents, updateChildren );

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorldInverse</span>.<span class="hljs-title function_">copy</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">matrixWorld</span> ).<span class="hljs-title function_">invert</span>();
	}
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">DEG2RAD</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> / <span class="hljs-number">180</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">PerspectiveCamera</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Camera</span> {
	<span class="hljs-title function_">constructor</span>(<span class="hljs-params"> fov = <span class="hljs-number">50</span>, aspect = <span class="hljs-number">1</span>, near = <span class="hljs-number">0.1</span>, far = <span class="hljs-number">2000</span> </span>) {
		<span class="hljs-variable language_">super</span>();

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">isPerspectiveCamera</span> = <span class="hljs-literal">true</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">fov</span> = fov;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">zoom</span> = <span class="hljs-number">1</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">near</span> = near;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">far</span> = far;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">focus</span> = <span class="hljs-number">10</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">aspect</span> = aspect;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">view</span> = <span class="hljs-literal">null</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">filmGauge</span> = <span class="hljs-number">35</span>;	<span class="hljs-comment">// width of the film (default in millimeters)</span>
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">filmOffset</span> = <span class="hljs-number">0</span>;	<span class="hljs-comment">// horizontal film offset (same unit as gauge)</span>

		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateProjectionMatrix</span>();
	}

	<span class="hljs-title function_">updateProjectionMatrix</span>(<span class="hljs-params"></span>) {
		<span class="hljs-keyword">const</span> near = <span class="hljs-variable language_">this</span>.<span class="hljs-property">near</span>;
		<span class="hljs-keyword">let</span> top = near * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">tan</span>( <span class="hljs-title class_">DEG2RAD</span> * <span class="hljs-number">0.5</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">fov</span> ) / <span class="hljs-variable language_">this</span>.<span class="hljs-property">zoom</span>;
		<span class="hljs-keyword">let</span> height = <span class="hljs-number">2</span> * top;
		<span class="hljs-keyword">let</span> width = <span class="hljs-variable language_">this</span>.<span class="hljs-property">aspect</span> * height;
		<span class="hljs-keyword">let</span> left = - <span class="hljs-number">0.5</span> * width;

		<span class="hljs-keyword">const</span> skew = <span class="hljs-variable language_">this</span>.<span class="hljs-property">filmOffset</span>;
		<span class="hljs-keyword">if</span> ( skew !== <span class="hljs-number">0</span> ) left += near * skew / <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFilmWidth</span>();

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">projectionMatrix</span>.<span class="hljs-title function_">makePerspective</span>( left, left + width, top, top - height, near, <span class="hljs-variable language_">this</span>.<span class="hljs-property">far</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">coordinateSystem</span> );

		<span class="hljs-variable language_">this</span>.<span class="hljs-property">projectionMatrixInverse</span>.<span class="hljs-title function_">copy</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">projectionMatrix</span> ).<span class="hljs-title function_">invert</span>();
	}
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">epsilon</span> = value =&gt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>( value ) &lt; <span class="hljs-number">1e-10</span> ? <span class="hljs-number">0</span> : value;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CSS3DRenderer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">camera, viewElement = <span class="hljs-literal">null</span>, cameraElement = <span class="hljs-literal">null</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span> = camera;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">widthHalf</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">heightHalf</span> = <span class="hljs-number">0</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewElement</span> = viewElement || <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>( <span class="hljs-string">&#x27;div&#x27;</span> );

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cameraElement</span> = cameraElement || <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>( <span class="hljs-string">&#x27;div&#x27;</span> );
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">cameraElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">transformStyle</span> = <span class="hljs-string">&#x27;preserve-3d&#x27;</span>;
		<span class="hljs-variable language_">this</span>.<span class="hljs-property">viewElement</span>.<span class="hljs-title function_">appendChild</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">cameraElement</span> );
  }

  <span class="hljs-title function_">getCameraCSSMatrix</span>(<span class="hljs-params"> matrix </span>) {
    <span class="hljs-keyword">const</span> elements = matrix.<span class="hljs-property">elements</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;matrix3d(&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">0</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( - elements[ <span class="hljs-number">1</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">2</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">3</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">4</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( - elements[ <span class="hljs-number">5</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">6</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">7</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">8</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( - elements[ <span class="hljs-number">9</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">10</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">11</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">12</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( - elements[ <span class="hljs-number">13</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">14</span> ] ) + <span class="hljs-string">&#x27;,&#x27;</span> +
      <span class="hljs-title function_">epsilon</span>( elements[ <span class="hljs-number">15</span> ] ) +
    <span class="hljs-string">&#x27;)&#x27;</span>;
  }

  <span class="hljs-title function_">setSize</span>(<span class="hljs-params">width, height</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">widthHalf</span> = width / <span class="hljs-number">2</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">heightHalf</span> = height / <span class="hljs-number">2</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = width + <span class="hljs-string">&#x27;px&#x27;</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = height + <span class="hljs-string">&#x27;px&#x27;</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cameraElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = width + <span class="hljs-string">&#x27;px&#x27;</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cameraElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = height + <span class="hljs-string">&#x27;px&#x27;</span>;
  }

  render () {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;render&#x27;</span>);
    <span class="hljs-keyword">const</span> camera = <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>;
    <span class="hljs-keyword">const</span> cameraElement = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cameraElement</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewElement</span>;
    <span class="hljs-keyword">const</span> _widthHalf = <span class="hljs-variable language_">this</span>.<span class="hljs-property">widthHalf</span>;
    <span class="hljs-keyword">const</span> _heightHalf = <span class="hljs-variable language_">this</span>.<span class="hljs-property">heightHalf</span>;

    <span class="hljs-keyword">const</span> fov = camera.<span class="hljs-property">projectionMatrix</span>.<span class="hljs-property">elements</span>[ <span class="hljs-number">5</span> ] * _heightHalf;

    camera.<span class="hljs-title function_">updateMatrixWorld</span>();

    <span class="hljs-keyword">let</span> tx, ty;

    <span class="hljs-keyword">if</span> ( camera.<span class="hljs-property">isOrthographicCamera</span> ) {
      tx = - ( camera.<span class="hljs-property">right</span> + camera.<span class="hljs-property">left</span> ) / <span class="hljs-number">2</span>;
      ty = ( camera.<span class="hljs-property">top</span> + camera.<span class="hljs-property">bottom</span> ) / <span class="hljs-number">2</span>;
    }

    <span class="hljs-keyword">const</span> p = fov * <span class="hljs-number">40</span>;

    <span class="hljs-keyword">const</span> scaleByViewOffset = camera.<span class="hljs-property">view</span> &amp;&amp; camera.<span class="hljs-property">view</span>.<span class="hljs-property">enabled</span> ? camera.<span class="hljs-property">view</span>.<span class="hljs-property">height</span> / camera.<span class="hljs-property">view</span>.<span class="hljs-property">fullHeight</span> : <span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> cameraCSSMatrix = camera.<span class="hljs-property">isOrthographicCamera</span> ?
      <span class="hljs-string">`scale( <span class="hljs-subst">${ scaleByViewOffset }</span> )`</span> + <span class="hljs-string">&#x27;scale(&#x27;</span> + fov + <span class="hljs-string">&#x27;)&#x27;</span> + <span class="hljs-string">&#x27;translate(&#x27;</span> + <span class="hljs-title function_">epsilon</span>( tx ) + <span class="hljs-string">&#x27;px,&#x27;</span> + <span class="hljs-title function_">epsilon</span>( ty ) + <span class="hljs-string">&#x27;px)&#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCameraCSSMatrix</span>( camera.<span class="hljs-property">matrixWorldInverse</span> ) :
      <span class="hljs-string">`scale( <span class="hljs-subst">${ scaleByViewOffset }</span> )`</span> + <span class="hljs-string">&#x27;translateZ(&#x27;</span> + fov + <span class="hljs-string">&#x27;px)&#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCameraCSSMatrix</span>( camera.<span class="hljs-property">matrixWorldInverse</span> );
    <span class="hljs-keyword">const</span> perspective = camera.<span class="hljs-property">isPerspectiveCamera</span> ? <span class="hljs-string">&#x27;perspective(&#x27;</span> + p + <span class="hljs-string">&#x27;px) &#x27;</span> : <span class="hljs-string">&#x27;&#x27;</span>;

    <span class="hljs-keyword">const</span> style = perspective + cameraCSSMatrix +
      <span class="hljs-string">&#x27;translate(&#x27;</span> + _widthHalf + <span class="hljs-string">&#x27;px,&#x27;</span> + _heightHalf + <span class="hljs-string">&#x27;px)&#x27;</span>;

    cameraElement.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = style;
  };
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventDispatcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  }

  <span class="hljs-title function_">addEventListener</span>(<span class="hljs-params">type, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">has</span>(type)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">set</span>(type, []);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">get</span>(type).<span class="hljs-title function_">push</span>(callback);
  }

  <span class="hljs-title function_">removeEventListener</span>(<span class="hljs-params">type, callback</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">has</span>(type)) {
      <span class="hljs-keyword">const</span> callbacks = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">get</span>(type);
      <span class="hljs-keyword">const</span> index = callbacks.<span class="hljs-title function_">indexOf</span>(callback);
      <span class="hljs-keyword">if</span> (index !== -<span class="hljs-number">1</span>) {
        callbacks.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
      }
    }
  }

  <span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">has</span>(event.<span class="hljs-property">type</span>)) {
      <span class="hljs-keyword">const</span> callbacks = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">get</span>(event.<span class="hljs-property">type</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> callback <span class="hljs-keyword">of</span> callbacks) {
        <span class="hljs-title function_">callback</span>(event);
      }
    }
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrbitControls</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventDispatcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">camera, domElement</span>) {
    <span class="hljs-variable language_">super</span>();

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span> = camera;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span> = domElement;

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseDown</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseDown</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseMove</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseMove</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseUp</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseUp</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onWheel</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">onWheel</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDragging</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span> = {
      <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,
    };
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mouse</span> = {
      <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,
    };
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = camera.<span class="hljs-property">position</span>.<span class="hljs-property">z</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// Add event listeners for mouse down, mouse move, mouse up, and wheel events</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mousedown&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseDown</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mousemove&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseMove</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mouseup&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseUp</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;wheel&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onWheel</span>);
  }

  <span class="hljs-title function_">dispose</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// Remove event listeners for mouse down, mouse move, mouse up, and wheel events</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;mousedown&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseDown</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;mousemove&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseMove</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;mouseup&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMouseUp</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domElement</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;wheel&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onWheel</span>);
  }

  <span class="hljs-title function_">onMouseDown</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDragging</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mouse</span>.<span class="hljs-property">x</span> = event.<span class="hljs-property">clientX</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mouse</span>.<span class="hljs-property">y</span> = event.<span class="hljs-property">clientY</span>;
  }

  <span class="hljs-title function_">onMouseMove</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDragging</span>) {
      <span class="hljs-keyword">const</span> deltaX = event.<span class="hljs-property">clientX</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">mouse</span>.<span class="hljs-property">x</span>;
      <span class="hljs-keyword">const</span> deltaY = event.<span class="hljs-property">clientY</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">mouse</span>.<span class="hljs-property">y</span>;

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">mouse</span>.<span class="hljs-property">x</span> = event.<span class="hljs-property">clientX</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">mouse</span>.<span class="hljs-property">y</span> = event.<span class="hljs-property">clientY</span>;

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span>.<span class="hljs-property">y</span> -= deltaX * <span class="hljs-number">0.5</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span>.<span class="hljs-property">x</span> += deltaY * <span class="hljs-number">0.5</span>;

      <span class="hljs-keyword">const</span> radius = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-property">x</span> ** <span class="hljs-number">2</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-property">y</span> ** <span class="hljs-number">2</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-property">z</span> ** <span class="hljs-number">2</span>);
      <span class="hljs-keyword">const</span> theta = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-property">x</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-property">z</span>);
      <span class="hljs-keyword">const</span> phi = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">acos</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-property">y</span> / radius);

      <span class="hljs-keyword">const</span> deltaTheta = deltaX * -<span class="hljs-number">0.01</span>;
      <span class="hljs-keyword">const</span> deltaPhi = deltaY * <span class="hljs-number">0.01</span>;

      <span class="hljs-keyword">const</span> newTheta = theta + deltaTheta;
      <span class="hljs-keyword">const</span> newPhi = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(phi - deltaPhi, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> - <span class="hljs-number">0.01</span>), <span class="hljs-number">0.01</span>);

      <span class="hljs-keyword">const</span> x = radius * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(newPhi) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(newTheta);
      <span class="hljs-keyword">const</span> y = radius * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(newPhi);
      <span class="hljs-keyword">const</span> z = radius * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(newPhi) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(newTheta);

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(x, y, z);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-title function_">lookAt</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-title function_">updateProjectionMatrix</span>();

      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>();
      
    }
  }

  <span class="hljs-title function_">onMouseUp</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDragging</span> = <span class="hljs-literal">false</span>;
  }

  <span class="hljs-title function_">onWheel</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-comment">// Handle wheel event</span>
    <span class="hljs-keyword">const</span> deltaZ = event.<span class="hljs-property">deltaY</span> * <span class="hljs-number">0.4</span>;
    
    <span class="hljs-keyword">const</span> direction = <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-title function_">clone</span>().<span class="hljs-title function_">normalize</span>();
    <span class="hljs-keyword">const</span> newPosition = <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-title function_">clone</span>().<span class="hljs-title function_">sub</span>(direction.<span class="hljs-title function_">multiplyScalar</span>(deltaZ));
    <span class="hljs-keyword">const</span> { x, y, z } = newPosition;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(x, y, z);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-title function_">lookAt</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">camera</span>.<span class="hljs-title function_">updateProjectionMatrix</span>();
  
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>();
    <span class="hljs-comment">// Update positionZ based on wheel delta</span>

    event.<span class="hljs-title function_">preventDefault</span>();
  }

  <span class="hljs-title function_">update</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// Update camera rotation and position</span>
    



    <span class="hljs-comment">// Dispatch a change event</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">dispatchEvent</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;change&#x27;</span> });
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Scene</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {
  #camera;
  #renderer;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>();

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleResize</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleResize</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">render</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">render</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);

    <span class="hljs-comment">// Add any initialization code here</span>
    <span class="hljs-keyword">const</span> shadowRoot = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachShadow</span>({ <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;open&#x27;</span> });
    shadowRoot.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
      &lt;style&gt;
        :host {
          display: block;
          min-height: 250px;
          display: flex;
          overflow: hidden;
          position: relative;
          perspective: 300px;
          -webkit-perspective: 300px;
          perspective-origin: center center;
          transform-style: preserve-3d;
          aspect-ratio: 16/9;
          padding: 0;
        }

        :host * {
          transform-style: preserve-3d;
          box-sizing: border-box;
        }

        :host .view {
          width: 100%;
          height: 100%;
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          transform-style: preserve-3d;
        }

        :host slot {
          display: block;
          transform-style: preserve-3d;
        }

      &lt;/style&gt;
      &lt;div class=&quot;view&quot;&gt;
        &lt;div class=&quot;camera&quot;&gt;
          &lt;slot&gt;&lt;/slot&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    `</span>;

    <span class="hljs-keyword">const</span> { width, height } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getBoundingClientRect</span>();

    <span class="hljs-variable language_">this</span>.#camera = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerspectiveCamera</span>(<span class="hljs-number">50</span>, width / height, <span class="hljs-number">0.1</span>, <span class="hljs-number">1000</span>);
    <span class="hljs-variable language_">this</span>.#camera.<span class="hljs-property">position</span>.<span class="hljs-property">x</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.#camera.<span class="hljs-property">position</span>.<span class="hljs-property">y</span> = <span class="hljs-number">100</span>;
    <span class="hljs-variable language_">this</span>.#camera.<span class="hljs-property">position</span>.<span class="hljs-property">z</span> = <span class="hljs-number">580</span>;
    
    <span class="hljs-keyword">const</span> viewElement = shadowRoot.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.view&#x27;</span>);
    <span class="hljs-keyword">const</span> cameraElement = shadowRoot.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.camera&#x27;</span>);

    <span class="hljs-variable language_">this</span>.#renderer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CSS3DRenderer</span>(<span class="hljs-variable language_">this</span>.#camera, viewElement, cameraElement);
    <span class="hljs-variable language_">this</span>.#renderer.<span class="hljs-title function_">setSize</span>(width, height);

    <span class="hljs-keyword">const</span> controls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrbitControls</span>(<span class="hljs-variable language_">this</span>.#camera, viewElement);
    controls.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;change&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">render</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();

    <span class="hljs-variable language_">this</span>.#camera.<span class="hljs-title function_">lookAt</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  }

  <span class="hljs-keyword">get</span> <span class="hljs-title function_">camera</span>() {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.#camera;
  }

  <span class="hljs-title function_">connectedCallback</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleResize</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();
  }

  <span class="hljs-title function_">handleResize</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> { width, height } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getBoundingClientRect</span>();

    <span class="hljs-variable language_">this</span>.#camera.<span class="hljs-property">aspect</span> = width / height;
    <span class="hljs-variable language_">this</span>.#camera.<span class="hljs-title function_">updateProjectionMatrix</span>();
    <span class="hljs-variable language_">this</span>.#renderer.<span class="hljs-title function_">setSize</span>(width, height);
  }

  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.#renderer.<span class="hljs-title function_">render</span>();
  }
}

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;c3-scene&#x27;</span>, C3Scene);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">camelize</span> = (<span class="hljs-params">str</span>) =&gt; str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/-./g</span>, <span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> s.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">toUpperCase</span>());

<span class="hljs-keyword">const</span> <span class="hljs-title function_">decamelize</span> = (<span class="hljs-params">str</span>) =&gt; str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/([a-z])([A-Z])/g</span>, <span class="hljs-string">&#x27;$1-$2&#x27;</span>).<span class="hljs-title function_">toLowerCase</span>();

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getStylesheet</span> = (<span class="hljs-params">shadowRoot</span>) =&gt; {
  <span class="hljs-keyword">let</span> style = shadowRoot.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;style[data-c3-style-handle]&#x27;</span>);

  <span class="hljs-keyword">if</span> (!style) {
    style = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;style&#x27;</span>);
    style.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-c3-style-handle&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
    shadowRoot.<span class="hljs-title function_">appendChild</span>(style);
  }

  <span class="hljs-keyword">return</span> style.<span class="hljs-property">sheet</span>;
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">CSSStyleMixin</span> = (<span class="hljs-params">
  clazz,
  props,
  isVar = <span class="hljs-literal">false</span>,
  callback = (target, prop, newValue) =&gt;
      target.dispatchEvent(<span class="hljs-keyword">new</span> CustomEvent(<span class="hljs-string">&#x27;change&#x27;</span>, { bubbles: <span class="hljs-literal">false</span>, detail: { name: prop, value: newValue } }))
</span>) =&gt; {
  props.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">prop</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> name = <span class="hljs-keyword">typeof</span> prop === <span class="hljs-string">&#x27;string&#x27;</span> ? prop : prop[<span class="hljs-number">1</span>];
    prop = <span class="hljs-keyword">typeof</span> prop === <span class="hljs-string">&#x27;string&#x27;</span> ? prop : prop[<span class="hljs-number">0</span>];
  
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;DEFINE: &#x27;</span>, clazz.<span class="hljs-property">name</span>, prop, name, isVar ? <span class="hljs-string">&#x27;VAR&#x27;</span> : <span class="hljs-string">&#x27;VALUE&#x27;</span>);
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(clazz.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, prop, {
      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;GET VALUE: &#x27;</span>, clazz.<span class="hljs-property">name</span>, prop);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-property">host</span>).<span class="hljs-title function_">getPropertyValue</span>(
          isVar ? <span class="hljs-string">`--<span class="hljs-subst">${name}</span>`</span> : name
        );
      },
      <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;SET VALUE: &#x27;</span>, clazz.<span class="hljs-property">name</span>, prop, value);
        <span class="hljs-keyword">const</span> sheet = <span class="hljs-title function_">getStylesheet</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>);
        <span class="hljs-keyword">const</span> rule = [...sheet.<span class="hljs-property">cssRules</span>].<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">rule</span> =&gt;</span> rule.<span class="hljs-property">selectorText</span> === <span class="hljs-string">&#x27;:host&#x27;</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">const</span> hyphenated = <span class="hljs-title function_">decamelize</span>(name);
        <span class="hljs-keyword">const</span> oldValue = <span class="hljs-variable language_">this</span>[prop];

        <span class="hljs-keyword">if</span> (rule) {
          rule.<span class="hljs-property">style</span>.<span class="hljs-title function_">setProperty</span>(isVar ? <span class="hljs-string">`--<span class="hljs-subst">${name}</span>`</span> : hyphenated, value);
        } <span class="hljs-keyword">else</span> {
          sheet.<span class="hljs-title function_">insertRule</span>(<span class="hljs-string">`:host {
            <span class="hljs-subst">${isVar ? <span class="hljs-string">`--<span class="hljs-subst">${name}</span>`</span> : hyphenated}</span>: <span class="hljs-subst">${value}</span>;
          }`</span>, <span class="hljs-number">0</span>);
        }

        <span class="hljs-keyword">const</span> newValue = <span class="hljs-variable language_">this</span>[prop];

        <span class="hljs-keyword">if</span> (oldValue !== newValue &amp;&amp; callback) {
          <span class="hljs-title function_">callback</span>(<span class="hljs-variable language_">this</span>, prop, newValue, oldValue);
        }
      }
    });
  });
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Object</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {
  #style;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>();

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">render</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">render</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachShadow</span>({ <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;open&#x27;</span> });

    <span class="hljs-comment">// Create stylesheet</span>
    <span class="hljs-variable language_">this</span>.#style = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;style&#x27;</span>);
    <span class="hljs-variable language_">this</span>.#style.<span class="hljs-property">textContent</span> = <span class="hljs-string">`
      :host {
        position: absolute;
        top: 0;
        left: 0;
        width: 0;
        height: 0;
        display: block;
        pointer-events: auto;
        user-select: none;
        transform-style: preserve-3d;
      }

      :host * {
        transform-style: preserve-3d;
      }

      :host::before {
        content: &#x27;&#x27;;
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        outline: 5px solid blue;
        transform-style: preserve-3d;
      }
    `</span>;
  
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.#style);
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">observedAttributes</span>() {
    <span class="hljs-keyword">return</span> [
      <span class="hljs-string">&#x27;position&#x27;</span>,
      <span class="hljs-string">&#x27;rotate&#x27;</span>,
      <span class="hljs-string">&#x27;scale&#x27;</span>,
      <span class="hljs-string">&#x27;animation&#x27;</span>,
      <span class="hljs-string">&#x27;background&#x27;</span>,
      <span class="hljs-string">&#x27;color&#x27;</span>
    ];
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getPosition</span>(<span class="hljs-params">target</span>) {
    <span class="hljs-keyword">const</span> position = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(target).<span class="hljs-title function_">getPropertyValue</span>(<span class="hljs-string">&#x27;translate&#x27;</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;position&#x27;</span>, position);
    <span class="hljs-keyword">const</span> [x = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>, z = <span class="hljs-number">0</span>] = position
      .<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/\s+/</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">n = <span class="hljs-string">&#x27;&#x27;</span></span>) =&gt;</span> <span class="hljs-title class_">Number</span>(n.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/px$/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)))
      .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> !<span class="hljs-built_in">isNaN</span>(n) ? n : <span class="hljs-number">0</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>(x, y, z);
  }

  <span class="hljs-title function_">connectedCallback</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>());
  }

  <span class="hljs-title function_">attributeChangedCallback</span>(<span class="hljs-params">name, oldValue, newValue</span>) {
    <span class="hljs-keyword">if</span> (oldValue === newValue) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">const</span> prop = <span class="hljs-title function_">camelize</span>(name);

    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">has</span>(<span class="hljs-variable language_">this</span>, prop)) {
      <span class="hljs-variable language_">this</span>[prop] = newValue;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();
    }
  }

  <span class="hljs-keyword">get</span> <span class="hljs-title function_">x</span>() {
    <span class="hljs-keyword">return</span> C3Object.<span class="hljs-title function_">getPosition</span>(<span class="hljs-variable language_">this</span>).<span class="hljs-property">x</span>;
  }

  <span class="hljs-keyword">get</span> <span class="hljs-title function_">y</span>() {
    <span class="hljs-keyword">return</span> C3Object.<span class="hljs-title function_">getPosition</span>(<span class="hljs-variable language_">this</span>).<span class="hljs-property">y</span>;
  }

  <span class="hljs-keyword">get</span> <span class="hljs-title function_">z</span>() {
    <span class="hljs-keyword">return</span> C3Object.<span class="hljs-title function_">getPosition</span>(<span class="hljs-variable language_">this</span>).<span class="hljs-property">y</span>;
  }

  <span class="hljs-keyword">get</span> <span class="hljs-title function_">scene</span>() {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">closest</span>(<span class="hljs-string">&#x27;c3-scene&#x27;</span>);
  }

  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {
    
  }
}

<span class="hljs-title class_">CSSStyleMixin</span>(C3Object, [
  [<span class="hljs-string">&#x27;position&#x27;</span>, <span class="hljs-string">&#x27;translate&#x27;</span>],
  <span class="hljs-string">&#x27;rotate&#x27;</span>,
  <span class="hljs-string">&#x27;scale&#x27;</span>,
  <span class="hljs-string">&#x27;animation&#x27;</span>
]);

<span class="hljs-keyword">const</span> box = <span class="hljs-string">`
  &lt;style scoped&gt;
    :host {
      --width: 200px;
      --height: 200px;
      --depth: 200px;
      --background: rgba(0, 255, 255, 0.6);
    }

    :host .cube {
      position: absolute;
      top: 0;
      left: 0;
      width: var(--width);
      height: var(--height);
      transform-style: preserve-3d;
      transform: translate3d(-50%, -50%, calc(var(--depth) / 2 - var(--width) / 2));
      
    }

    :host .face {
      width: var(--width);
      height: var(--height);
      display: block;
      position: absolute;
      background: var(--background, &#x27;gray&#x27;);
      /* backface-visibility: hidden; */
      transform-style: preserve-3d;
      /*border: 1px solid red;*/
    }

    /*
    .face {
      position: absolute;
      width: var(--width);
      height: var(--height);
      border: 2px solid black;
      background: var(--background, &#x27;gray&#x27;);
      backface-visibility: hidden;
      transform-style: preserve-3d;
    }*/
  
    :host .front {
      transform: rotateY( 0deg) translateZ(calc(var(--width) / 2));
      transform-origin:  0;
    }

    :host .back {
      transform: rotateX( 180deg) translateZ(calc( var(--depth) - var(--width) / 2 )) ;
    }

    :host .right {
      width: var(--depth);
      transform: rotateY( 90deg) translateX(calc(var(--depth) / 2 - var(--width) / 2)) translateZ(calc( var(--width) - var(--depth) / 2 )) scaleX(-1);
    }

    :host .left {
      width: var(--depth);
      transform: rotateY( -90deg) translateX(calc(var(--width) / 2 - var(--depth) / 2)) translateZ(calc(var(--depth) / 2 ))  scaleX(-1); 
    }

    :host .top {
      height: var(--depth);
      transform: rotateX( 90deg) translateY(calc(var(--width) / 2 - var(--depth) / 2)) translateX(0)  translateZ(calc(var(--depth) / 2)) scaleY(-1);
    }

    :host .bottom {
      height: var(--depth);
      transform: rotateX( -90deg) translateY(calc( var(--depth) / 2 - var(--width) / 2))  translateZ(calc(var(--height) - var(--depth) / 2))  scaleY(-1);
    }
   
    
    
  &lt;/style&gt;
  &lt;div class=&quot;cube&quot;&gt;
    &lt;div class=&quot;face front&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;face back&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;face right&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;face left&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;face top&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;face bottom&quot;&gt;&lt;/div&gt;
  &lt;/div&gt;
`</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Box</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">C3Object</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">observedAttributes</span>() {
    <span class="hljs-keyword">return</span> [
      ...C3Object.<span class="hljs-property">observedAttributes</span>,
      <span class="hljs-string">&#x27;background&#x27;</span>,
      <span class="hljs-string">&#x27;width&#x27;</span>,
      <span class="hljs-string">&#x27;height&#x27;</span>,
      <span class="hljs-string">&#x27;depth&#x27;</span>
    ];
  }

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>();

    <span class="hljs-keyword">const</span> shape = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
    shape.<span class="hljs-property">style</span>.<span class="hljs-property">transformStyle</span> = <span class="hljs-string">&#x27;preserve-3d&#x27;</span>;
    shape.<span class="hljs-property">innerHTML</span> = box;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(shape);
  }
}

<span class="hljs-title class_">CSSStyleMixin</span>(C3Box, [
  <span class="hljs-string">&#x27;background&#x27;</span>,
  <span class="hljs-string">&#x27;width&#x27;</span>,
  <span class="hljs-string">&#x27;height&#x27;</span>,
  <span class="hljs-string">&#x27;depth&#x27;</span>
], <span class="hljs-literal">true</span>);

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;c3-box&#x27;</span>, C3Box);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Grid</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">C3Object</span> {
  #style;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>();

    <span class="hljs-variable language_">this</span>.#style = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;style&#x27;</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.#style);
  }

  <span class="hljs-title function_">connectedCallback</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();
  }

  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">render</span>();
    <span class="hljs-keyword">const</span> size = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;size&#x27;</span>) || <span class="hljs-string">&#x27;200px&#x27;</span>);
    <span class="hljs-keyword">const</span> divisions = <span class="hljs-built_in">parseInt</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;divisions&#x27;</span>) || <span class="hljs-string">&#x27;10&#x27;</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-property">host</span>.<span class="hljs-property">style</span>.<span class="hljs-title function_">setProperty</span>(<span class="hljs-string">&#x27;--color&#x27;</span>, <span class="hljs-string">&#x27;rgba(2555, 255, 255, 0.5)&#x27;</span>);

   <span class="hljs-variable language_">this</span>.#style.<span class="hljs-property">textContent</span> = <span class="hljs-string">`
      :host {
        --size: <span class="hljs-subst">${size}</span>px;
        --divisions: <span class="hljs-subst">${divisions}</span>;
      }
      
      :host::after {
        --stroke: 2.5px;
        --tile: calc(var(--size) / var(--divisions));
        content: &#x27;&#x27;;
        position: absolute;
        top: 0;
        left: 0;
        width: calc(var(--size) + var(--stroke));
        height: calc(var(--size) + var(--stroke));
        background: repeating-linear-gradient(90deg, var(--color), var(--color) 1px, transparent 1px, transparent var(--tile)) 
            , repeating-linear-gradient(180deg, var(--color), var(--color) 1px, transparent 1px, transparent var(--tile));
        transform: rotateX(90deg)  translate(-50%, -50%);
        transform-style: preserve-3d;
        transform-origin: 0 0;
      }
    `</span>;
  }
}

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;c3-grid&#x27;</span>, C3Grid);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Group</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">C3Object</span> {
  #slot;
  <span class="hljs-comment">// #mutationObserver;</span>

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">observedAttributes</span>() {
    <span class="hljs-keyword">return</span> [...C3Object.<span class="hljs-property">observedAttributes</span>];
  }

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>();

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSlotChange</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSlotChange</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
    
    <span class="hljs-keyword">const</span> slot = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;slot&#x27;</span>);
    slot.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;block&#x27;</span>;
    slot.<span class="hljs-property">style</span>.<span class="hljs-property">transformStyle</span> = <span class="hljs-string">&#x27;preserve-3d&#x27;</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(slot);

    slot.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;slotchange&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSlotChange</span>);

    <span class="hljs-comment">// this.#mutationObserver = new MutationObserver(mutations =&gt; {</span>
    <span class="hljs-comment">//   console.log(&#x27;MUTATION: &#x27;, mutations);</span>
    <span class="hljs-comment">//   for (let mutation of mutations) {</span>
    <span class="hljs-comment">//     if (mutation.type === &#x27;childList&#x27;) {</span>
    <span class="hljs-comment">//       console.log(&#x27;A child node has been added or removed.&#x27;);</span>

    <span class="hljs-comment">//       mutation.addedNodes.forEach(node =&gt; {</span>
    <span class="hljs-comment">//         if (node instanceof C3Object) {</span>
    <span class="hljs-comment">//           node.addEventListener(&#x27;change&#x27;, this.handleChildrenChange);</span>
    <span class="hljs-comment">//         }</span>
    <span class="hljs-comment">//       });</span>

    <span class="hljs-comment">//       mutation.removedNodes.forEach(node =&gt; {</span>
    <span class="hljs-comment">//         if (node instanceof C3Object) {</span>
    <span class="hljs-comment">//           node.removeEventListener(&#x27;change&#x27;, this.handleChildrenChange);</span>
    <span class="hljs-comment">//         }</span>
    <span class="hljs-comment">//       });</span>
    <span class="hljs-comment">//     }</span>
    <span class="hljs-comment">//   }</span>
    <span class="hljs-comment">// });</span>

    <span class="hljs-variable language_">this</span>.#slot = slot;
    
    <span class="hljs-comment">// this.#mutationObserver.observe(this.#slot, { childList: true });</span>
  }

  <span class="hljs-title function_">disconnectedCallback</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// this.#mutationObserver.unobserve(this.#slot);</span>
    <span class="hljs-comment">// this.#mutationObserver.disconnect();</span>
    <span class="hljs-variable language_">this</span>.#slot.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;slotchange&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSlotChange</span>);
  }

  <span class="hljs-comment">// handleChildrenChange() {</span>
  <span class="hljs-comment">//   console.log(&#x27;*********** children change...&#x27;);</span>
  <span class="hljs-comment">//   this.render();</span>
  <span class="hljs-comment">// }</span>

  <span class="hljs-title function_">handleSlotChange</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// this.#slot.assignedNodes().forEach(node =&gt; {</span>
    <span class="hljs-comment">//   if (node instanceof C3Object) {</span>
    <span class="hljs-comment">//     node.removeEventListener(&#x27;change&#x27;, this.handleChildrenChange);</span>
    <span class="hljs-comment">//     node.addEventListener(&#x27;change&#x27;, this.handleChildrenChange);</span>
    <span class="hljs-comment">//   }</span>
    <span class="hljs-comment">// });</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;****** slot change...&#x27;</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();
  }
}

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;c3-group&#x27;</span>, C3Group);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getDefaultExportFromCjs</span> (x) {
	<span class="hljs-keyword">return</span> x &amp;&amp; x.<span class="hljs-property">__esModule</span> &amp;&amp; <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(x, <span class="hljs-string">&#x27;default&#x27;</span>) ? x[<span class="hljs-string">&#x27;default&#x27;</span>] : x;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getAugmentedNamespace</span>(<span class="hljs-params">n</span>) {
  <span class="hljs-keyword">if</span> (n.<span class="hljs-property">__esModule</span>) <span class="hljs-keyword">return</span> n;
  <span class="hljs-keyword">var</span> f = n.<span class="hljs-property">default</span>;
	<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> f == <span class="hljs-string">&quot;function&quot;</span>) {
		<span class="hljs-keyword">var</span> a = <span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span> () {
			<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span> <span class="hljs-keyword">instanceof</span> a) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">construct</span>(f, <span class="hljs-variable language_">arguments</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">constructor</span>);
			}
			<span class="hljs-keyword">return</span> f.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>);
		};
		a.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = f.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
  } <span class="hljs-keyword">else</span> a = {};
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(a, <span class="hljs-string">&#x27;__esModule&#x27;</span>, {<span class="hljs-attr">value</span>: <span class="hljs-literal">true</span>});
	<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(n).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">k</span>) {
		<span class="hljs-keyword">var</span> d = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyDescriptor</span>(n, k);
		<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(a, k, d.<span class="hljs-property">get</span> ? d : {
			<span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
			<span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
				<span class="hljs-keyword">return</span> n[k];
			}
		});
	});
	<span class="hljs-keyword">return</span> a;
}

<span class="hljs-keyword">var</span> dist = {};

<span class="hljs-keyword">var</span> <span class="hljs-title class_">QuickHull</span> = {};

<span class="hljs-keyword">var</span> subtract_1 = subtract$1;

<span class="hljs-comment">/**
 * Subtracts vector b from vector a
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} out the receiving vector
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the first operand
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} b the second operand
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">vec3</span>} <span class="hljs-variable">out</span>
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">subtract$1</span>(<span class="hljs-params">out, a, b</span>) {
    out[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>] - b[<span class="hljs-number">0</span>];
    out[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] - b[<span class="hljs-number">1</span>];
    out[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>] - b[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">return</span> out
}

<span class="hljs-keyword">var</span> cross_1 = cross$2;

<span class="hljs-comment">/**
 * Computes the cross product of two vec3&#x27;s
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} out the receiving vector
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the first operand
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} b the second operand
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">vec3</span>} <span class="hljs-variable">out</span>
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">cross$2</span>(<span class="hljs-params">out, a, b</span>) {
    <span class="hljs-keyword">var</span> ax = a[<span class="hljs-number">0</span>], ay = a[<span class="hljs-number">1</span>], az = a[<span class="hljs-number">2</span>],
        bx = b[<span class="hljs-number">0</span>], by = b[<span class="hljs-number">1</span>], bz = b[<span class="hljs-number">2</span>];

    out[<span class="hljs-number">0</span>] = ay * bz - az * by;
    out[<span class="hljs-number">1</span>] = az * bx - ax * bz;
    out[<span class="hljs-number">2</span>] = ax * by - ay * bx;
    <span class="hljs-keyword">return</span> out
}

<span class="hljs-keyword">var</span> squaredLength_1 = squaredLength$1;

<span class="hljs-comment">/**
 * Calculates the squared length of a vec3
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a vector to calculate squared length of
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Number</span>} squared length of a
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">squaredLength$1</span>(<span class="hljs-params">a</span>) {
    <span class="hljs-keyword">var</span> x = a[<span class="hljs-number">0</span>],
        y = a[<span class="hljs-number">1</span>],
        z = a[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">return</span> x*x + y*y + z*z
}

<span class="hljs-keyword">var</span> subtract = subtract_1;
<span class="hljs-keyword">var</span> cross$1 = cross_1;
<span class="hljs-keyword">var</span> squaredLength = squaredLength_1;
<span class="hljs-keyword">var</span> ab = [];
<span class="hljs-keyword">var</span> ap = [];
<span class="hljs-keyword">var</span> cr = [];

<span class="hljs-keyword">var</span> squared = <span class="hljs-keyword">function</span> (<span class="hljs-params">p, a, b</span>) {
  <span class="hljs-comment">// // == vector solution</span>
  <span class="hljs-comment">// var normalize = require(&#x27;gl-vec3/normalize&#x27;)</span>
  <span class="hljs-comment">// var scaleAndAdd = require(&#x27;gl-vec3/scaleAndAdd&#x27;)</span>
  <span class="hljs-comment">// var dot = require(&#x27;gl-vec3/dot&#x27;)</span>
  <span class="hljs-comment">// var squaredDistance = require(&#x27;gl-vec3/squaredDistance&#x27;)</span>
  <span class="hljs-comment">// // n = vector `ab` normalized</span>
  <span class="hljs-comment">// var n = []</span>
  <span class="hljs-comment">// // projection = projection of `point` on `n`</span>
  <span class="hljs-comment">// var projection = []</span>
  <span class="hljs-comment">// normalize(n, subtract(n, a, b))</span>
  <span class="hljs-comment">// scaleAndAdd(projection, a, n, dot(n, p))</span>
  <span class="hljs-comment">// return squaredDistance(projection, p)</span>

  <span class="hljs-comment">// == parallelogram solution</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">//            s</span>
  <span class="hljs-comment">//      __a________b__</span>
  <span class="hljs-comment">//       /   |    /</span>
  <span class="hljs-comment">//      /   h|   /</span>
  <span class="hljs-comment">//     /_____|__/</span>
  <span class="hljs-comment">//    p</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">//  s = b - a</span>
  <span class="hljs-comment">//  area = s * h</span>
  <span class="hljs-comment">//  |ap x s| = s * h</span>
  <span class="hljs-comment">//  h = |ap x s| / s</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-title function_">subtract</span>(ab, b, a);
  <span class="hljs-title function_">subtract</span>(ap, p, a);
  <span class="hljs-keyword">var</span> area = <span class="hljs-title function_">squaredLength</span>(<span class="hljs-title function_">cross$1</span>(cr, ap, ab));
  <span class="hljs-keyword">var</span> s = <span class="hljs-title function_">squaredLength</span>(ab);
  <span class="hljs-keyword">if</span> (s === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;a and b are the same point&#x27;</span>)
  }
  <span class="hljs-keyword">return</span> area / s
};

<span class="hljs-comment">/*
 * point-line-distance
 *
 * Copyright (c) 2015 Mauricio Poppe
 * Licensed under the MIT license.
 */</span>

<span class="hljs-keyword">var</span> distanceSquared = squared;

<span class="hljs-keyword">var</span> pointLineDistance = <span class="hljs-keyword">function</span> (<span class="hljs-params">point, a, b</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(<span class="hljs-title function_">distanceSquared</span>(point, a, b))
};

<span class="hljs-keyword">var</span> normalize_1 = normalize$1;

<span class="hljs-comment">/**
 * Normalize a vec3
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} out the receiving vector
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a vector to normalize
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">vec3</span>} <span class="hljs-variable">out</span>
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">normalize$1</span>(<span class="hljs-params">out, a</span>) {
    <span class="hljs-keyword">var</span> x = a[<span class="hljs-number">0</span>],
        y = a[<span class="hljs-number">1</span>],
        z = a[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">var</span> len = x*x + y*y + z*z;
    <span class="hljs-keyword">if</span> (len &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">//<span class="hljs-doctag">TODO:</span> evaluate use of glm_invsqrt here?</span>
        len = <span class="hljs-number">1</span> / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(len);
        out[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>] * len;
        out[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] * len;
        out[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>] * len;
    }
    <span class="hljs-keyword">return</span> out
}

<span class="hljs-keyword">var</span> normalize = normalize_1;
<span class="hljs-keyword">var</span> sub = subtract_1;
<span class="hljs-keyword">var</span> cross = cross_1;
<span class="hljs-keyword">var</span> tmp = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];

<span class="hljs-keyword">var</span> getPlaneNormal = planeNormal;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">planeNormal</span> (out, point1, point2, point3) {
  <span class="hljs-title function_">sub</span>(out, point1, point2);
  <span class="hljs-title function_">sub</span>(tmp, point2, point3);
  <span class="hljs-title function_">cross</span>(out, out, tmp);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">normalize</span>(out, out)
}

<span class="hljs-keyword">var</span> dot_1 = dot;

<span class="hljs-comment">/**
 * Calculates the dot product of two vec3&#x27;s
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the first operand
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} b the second operand
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Number</span>} dot product of a and b
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">dot</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-keyword">return</span> a[<span class="hljs-number">0</span>] * b[<span class="hljs-number">0</span>] + a[<span class="hljs-number">1</span>] * b[<span class="hljs-number">1</span>] + a[<span class="hljs-number">2</span>] * b[<span class="hljs-number">2</span>]
}

<span class="hljs-keyword">var</span> <span class="hljs-title class_">VertexList</span> = {};

(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-built_in">exports</span></span>) {

	<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&quot;__esModule&quot;</span>, {
	  <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span>
	});
	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-params">instance, Constructor</span>) { <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Constructor</span>)) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;Cannot call a class as a function&quot;</span>); } }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-params">target, props</span>) { <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; props.<span class="hljs-property">length</span>; i++) { <span class="hljs-keyword">var</span> descriptor = props[i]; descriptor.<span class="hljs-property">enumerable</span> = descriptor.<span class="hljs-property">enumerable</span> || <span class="hljs-literal">false</span>; descriptor.<span class="hljs-property">configurable</span> = <span class="hljs-literal">true</span>; <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;value&quot;</span> <span class="hljs-keyword">in</span> descriptor) descriptor.<span class="hljs-property">writable</span> = <span class="hljs-literal">true</span>; <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(target, descriptor.<span class="hljs-property">key</span>, descriptor); } }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_createClass</span>(<span class="hljs-params">Constructor, protoProps, staticProps</span>) { <span class="hljs-keyword">if</span> (protoProps) <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, protoProps); <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-title class_">Constructor</span>, <span class="hljs-string">&quot;prototype&quot;</span>, { <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span> }); <span class="hljs-keyword">return</span> <span class="hljs-title class_">Constructor</span>; }

	<span class="hljs-keyword">var</span> <span class="hljs-title class_">VertexList</span> = <span class="hljs-comment">/*#__PURE__*/</span><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
	  <span class="hljs-keyword">function</span> <span class="hljs-title function_">VertexList</span>(<span class="hljs-params"></span>) {
	    <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-title class_">VertexList</span>);

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = <span class="hljs-literal">null</span>;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = <span class="hljs-literal">null</span>;
	  }

	  <span class="hljs-title function_">_createClass</span>(<span class="hljs-title class_">VertexList</span>, [{
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;clear&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = <span class="hljs-literal">null</span>;
	    }
	    <span class="hljs-comment">/**
	     * Inserts a `node` before `target`, it&#x27;s assumed that
	     * `target` belongs to this doubly linked list
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">target</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">node</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;insertBefore&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">insertBefore</span>(<span class="hljs-params">target, node</span>) {
	      node.<span class="hljs-property">prev</span> = target.<span class="hljs-property">prev</span>;
	      node.<span class="hljs-property">next</span> = target;

	      <span class="hljs-keyword">if</span> (!node.<span class="hljs-property">prev</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = node;
	      } <span class="hljs-keyword">else</span> {
	        node.<span class="hljs-property">prev</span>.<span class="hljs-property">next</span> = node;
	      }

	      target.<span class="hljs-property">prev</span> = node;
	    }
	    <span class="hljs-comment">/**
	     * Inserts a `node` after `target`, it&#x27;s assumed that
	     * `target` belongs to this doubly linked list
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Vertex</span>} <span class="hljs-variable">target</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Vertex</span>} <span class="hljs-variable">node</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;insertAfter&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">insertAfter</span>(<span class="hljs-params">target, node</span>) {
	      node.<span class="hljs-property">prev</span> = target;
	      node.<span class="hljs-property">next</span> = target.<span class="hljs-property">next</span>;

	      <span class="hljs-keyword">if</span> (!node.<span class="hljs-property">next</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = node;
	      } <span class="hljs-keyword">else</span> {
	        node.<span class="hljs-property">next</span>.<span class="hljs-property">prev</span> = node;
	      }

	      target.<span class="hljs-property">next</span> = node;
	    }
	    <span class="hljs-comment">/**
	     * Appends a `node` to the end of this doubly linked list
	     * Note: `node.next` will be unlinked from `node`
	     * Note: if `node` is part of another linked list call `addAll` instead
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">node</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;add&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">node</span>) {
	      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = node;
	      } <span class="hljs-keyword">else</span> {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">next</span> = node;
	      }

	      node.<span class="hljs-property">prev</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>; <span class="hljs-comment">// since node is the new end it doesn&#x27;t have a next node</span>

	      node.<span class="hljs-property">next</span> = <span class="hljs-literal">null</span>;
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = node;
	    }
	    <span class="hljs-comment">/**
	     * Appends a chain of nodes where `node` is the head,
	     * the difference with `add` is that it correctly sets the position
	     * of the node list `tail` property
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">node</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;addAll&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">addAll</span>(<span class="hljs-params">node</span>) {
	      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = node;
	      } <span class="hljs-keyword">else</span> {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">next</span> = node;
	      }

	      node.<span class="hljs-property">prev</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>; <span class="hljs-comment">// find the end of the list</span>

	      <span class="hljs-keyword">while</span> (node.<span class="hljs-property">next</span>) {
	        node = node.<span class="hljs-property">next</span>;
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = node;
	    }
	    <span class="hljs-comment">/**
	     * Deletes a `node` from this linked list, it&#x27;s assumed that `node` is a
	     * member of this linked list
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">node</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;remove&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">remove</span>(<span class="hljs-params">node</span>) {
	      <span class="hljs-keyword">if</span> (!node.<span class="hljs-property">prev</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = node.<span class="hljs-property">next</span>;
	      } <span class="hljs-keyword">else</span> {
	        node.<span class="hljs-property">prev</span>.<span class="hljs-property">next</span> = node.<span class="hljs-property">next</span>;
	      }

	      <span class="hljs-keyword">if</span> (!node.<span class="hljs-property">next</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = node.<span class="hljs-property">prev</span>;
	      } <span class="hljs-keyword">else</span> {
	        node.<span class="hljs-property">next</span>.<span class="hljs-property">prev</span> = node.<span class="hljs-property">prev</span>;
	      }
	    }
	    <span class="hljs-comment">/**
	     * Removes a chain of nodes whose head is `a` and whose tail is `b`,
	     * it&#x27;s assumed that `a` and `b` belong to this list and also that `a`
	     * comes before `b` in the linked list
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">a</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">b</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;removeChain&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">removeChain</span>(<span class="hljs-params">a, b</span>) {
	      <span class="hljs-keyword">if</span> (!a.<span class="hljs-property">prev</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = b.<span class="hljs-property">next</span>;
	      } <span class="hljs-keyword">else</span> {
	        a.<span class="hljs-property">prev</span>.<span class="hljs-property">next</span> = b.<span class="hljs-property">next</span>;
	      }

	      <span class="hljs-keyword">if</span> (!b.<span class="hljs-property">next</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = a.<span class="hljs-property">prev</span>;
	      } <span class="hljs-keyword">else</span> {
	        b.<span class="hljs-property">next</span>.<span class="hljs-property">prev</span> = a.<span class="hljs-property">prev</span>;
	      }
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;first&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">first</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;isEmpty&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">return</span> !<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
	    }
	  }]);

	  <span class="hljs-keyword">return</span> <span class="hljs-title class_">VertexList</span>;
	}();

	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-title class_">VertexList</span>; 
} (<span class="hljs-title class_">VertexList</span>));

<span class="hljs-keyword">var</span> <span class="hljs-title class_">Vertex</span> = {};

(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-built_in">exports</span></span>) {

	<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&quot;__esModule&quot;</span>, {
	  <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span>
	});
	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_createClass</span>(<span class="hljs-params">Constructor, protoProps, staticProps</span>) { <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-title class_">Constructor</span>, <span class="hljs-string">&quot;prototype&quot;</span>, { <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span> }); <span class="hljs-keyword">return</span> <span class="hljs-title class_">Constructor</span>; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-params">instance, Constructor</span>) { <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Constructor</span>)) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;Cannot call a class as a function&quot;</span>); } }

	<span class="hljs-keyword">var</span> <span class="hljs-title class_">Vertex</span> = <span class="hljs-comment">/*#__PURE__*/</span><span class="hljs-title function_">_createClass</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">Vertex</span>(<span class="hljs-params">point, index</span>) {
	  <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-title class_">Vertex</span>);

	  <span class="hljs-variable language_">this</span>.<span class="hljs-property">point</span> = point; <span class="hljs-comment">// index in the input array</span>

	  <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> = index; <span class="hljs-comment">// vertex is a double linked list node</span>

	  <span class="hljs-variable language_">this</span>.<span class="hljs-property">next</span> = <span class="hljs-literal">null</span>;
	  <span class="hljs-variable language_">this</span>.<span class="hljs-property">prev</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// the face that is able to see this point</span>

	  <span class="hljs-variable language_">this</span>.<span class="hljs-property">face</span> = <span class="hljs-literal">null</span>;
	});

	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-title class_">Vertex</span>; 
} (<span class="hljs-title class_">Vertex</span>));

<span class="hljs-keyword">var</span> <span class="hljs-title class_">Face</span> = {};

<span class="hljs-keyword">var</span> add_1 = add;

<span class="hljs-comment">/**
 * Adds two vec3&#x27;s
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} out the receiving vector
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the first operand
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} b the second operand
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">vec3</span>} <span class="hljs-variable">out</span>
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">out, a, b</span>) {
    out[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>] + b[<span class="hljs-number">0</span>];
    out[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] + b[<span class="hljs-number">1</span>];
    out[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>] + b[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">return</span> out
}

<span class="hljs-keyword">var</span> copy_1 = copy;

<span class="hljs-comment">/**
 * Copy the values from one vec3 to another
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} out the receiving vector
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the source vector
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">vec3</span>} <span class="hljs-variable">out</span>
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">copy</span>(<span class="hljs-params">out, a</span>) {
    out[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>];
    out[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>];
    out[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">return</span> out
}

<span class="hljs-keyword">var</span> length_1 = length;

<span class="hljs-comment">/**
 * Calculates the length of a vec3
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a vector to calculate length of
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Number</span>} length of a
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">length</span>(<span class="hljs-params">a</span>) {
    <span class="hljs-keyword">var</span> x = a[<span class="hljs-number">0</span>],
        y = a[<span class="hljs-number">1</span>],
        z = a[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(x*x + y*y + z*z)
}

<span class="hljs-keyword">var</span> scale_1 = scale;

<span class="hljs-comment">/**
 * Scales a vec3 by a scalar number
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} out the receiving vector
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the vector to scale
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} b amount to scale the vector by
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">vec3</span>} <span class="hljs-variable">out</span>
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">scale</span>(<span class="hljs-params">out, a, b</span>) {
    out[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>] * b;
    out[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] * b;
    out[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>] * b;
    <span class="hljs-keyword">return</span> out
}

<span class="hljs-keyword">var</span> scaleAndAdd_1 = scaleAndAdd;

<span class="hljs-comment">/**
 * Adds two vec3&#x27;s after scaling the second operand by a scalar value
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} out the receiving vector
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the first operand
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} b the second operand
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} scale the amount to scale b by before adding
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">vec3</span>} <span class="hljs-variable">out</span>
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">scaleAndAdd</span>(<span class="hljs-params">out, a, b, scale</span>) {
    out[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>] + (b[<span class="hljs-number">0</span>] * scale);
    out[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] + (b[<span class="hljs-number">1</span>] * scale);
    out[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>] + (b[<span class="hljs-number">2</span>] * scale);
    <span class="hljs-keyword">return</span> out
}

<span class="hljs-keyword">var</span> <span class="hljs-title class_">HalfEdge</span> = {};

<span class="hljs-keyword">var</span> distance_1 = distance;

<span class="hljs-comment">/**
 * Calculates the euclidian distance between two vec3&#x27;s
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the first operand
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} b the second operand
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Number</span>} distance between a and b
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">distance</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-keyword">var</span> x = b[<span class="hljs-number">0</span>] - a[<span class="hljs-number">0</span>],
        y = b[<span class="hljs-number">1</span>] - a[<span class="hljs-number">1</span>],
        z = b[<span class="hljs-number">2</span>] - a[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(x*x + y*y + z*z)
}

<span class="hljs-keyword">var</span> squaredDistance_1 = squaredDistance;

<span class="hljs-comment">/**
 * Calculates the squared euclidian distance between two vec3&#x27;s
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} a the first operand
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">vec3</span>} b the second operand
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Number</span>} squared distance between a and b
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">squaredDistance</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-keyword">var</span> x = b[<span class="hljs-number">0</span>] - a[<span class="hljs-number">0</span>],
        y = b[<span class="hljs-number">1</span>] - a[<span class="hljs-number">1</span>],
        z = b[<span class="hljs-number">2</span>] - a[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">return</span> x*x + y*y + z*z
}

<span class="hljs-keyword">var</span> <span class="hljs-variable language_">global</span>$1 = (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">global</span> !== <span class="hljs-string">&quot;undefined&quot;</span> ? <span class="hljs-variable language_">global</span> :
  <span class="hljs-keyword">typeof</span> self !== <span class="hljs-string">&quot;undefined&quot;</span> ? self :
  <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">&quot;undefined&quot;</span> ? <span class="hljs-variable language_">window</span> : {});

<span class="hljs-comment">// shim for using process in browser</span>
<span class="hljs-comment">// based off https://github.com/defunctzombie/node-process/blob/master/browser.js</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">defaultSetTimout</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;setTimeout has not been defined&#x27;</span>);
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defaultClearTimeout</span> () {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;clearTimeout has not been defined&#x27;</span>);
}
<span class="hljs-keyword">var</span> cachedSetTimeout = defaultSetTimout;
<span class="hljs-keyword">var</span> cachedClearTimeout = defaultClearTimeout;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">global</span>$1.<span class="hljs-property">setTimeout</span> === <span class="hljs-string">&#x27;function&#x27;</span>) {
    cachedSetTimeout = <span class="hljs-built_in">setTimeout</span>;
}
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">global</span>$1.<span class="hljs-property">clearTimeout</span> === <span class="hljs-string">&#x27;function&#x27;</span>) {
    cachedClearTimeout = <span class="hljs-built_in">clearTimeout</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">runTimeout</span>(<span class="hljs-params">fun</span>) {
    <span class="hljs-keyword">if</span> (cachedSetTimeout === <span class="hljs-built_in">setTimeout</span>) {
        <span class="hljs-comment">//normal enviroments in sane situations</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">setTimeout</span>(fun, <span class="hljs-number">0</span>);
    }
    <span class="hljs-comment">// if setTimeout wasn&#x27;t available but was latter defined</span>
    <span class="hljs-keyword">if</span> ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) &amp;&amp; <span class="hljs-built_in">setTimeout</span>) {
        cachedSetTimeout = <span class="hljs-built_in">setTimeout</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">setTimeout</span>(fun, <span class="hljs-number">0</span>);
    }
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// when when somebody has screwed with setTimeout but no I.E. maddness</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">cachedSetTimeout</span>(fun, <span class="hljs-number">0</span>);
    } <span class="hljs-keyword">catch</span>(e){
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// When we are in I.E. but the script has been evaled so I.E. doesn&#x27;t trust the global object when called normally</span>
            <span class="hljs-keyword">return</span> cachedSetTimeout.<span class="hljs-title function_">call</span>(<span class="hljs-literal">null</span>, fun, <span class="hljs-number">0</span>);
        } <span class="hljs-keyword">catch</span>(e){
            <span class="hljs-comment">// same as above but when it&#x27;s a version of I.E. that must have the global object for &#x27;this&#x27;, hopfully our context correct otherwise it will throw a global error</span>
            <span class="hljs-keyword">return</span> cachedSetTimeout.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, fun, <span class="hljs-number">0</span>);
        }
    }


}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">runClearTimeout</span>(<span class="hljs-params">marker</span>) {
    <span class="hljs-keyword">if</span> (cachedClearTimeout === <span class="hljs-built_in">clearTimeout</span>) {
        <span class="hljs-comment">//normal enviroments in sane situations</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">clearTimeout</span>(marker);
    }
    <span class="hljs-comment">// if clearTimeout wasn&#x27;t available but was latter defined</span>
    <span class="hljs-keyword">if</span> ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) &amp;&amp; <span class="hljs-built_in">clearTimeout</span>) {
        cachedClearTimeout = <span class="hljs-built_in">clearTimeout</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">clearTimeout</span>(marker);
    }
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// when when somebody has screwed with setTimeout but no I.E. maddness</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">cachedClearTimeout</span>(marker);
    } <span class="hljs-keyword">catch</span> (e){
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// When we are in I.E. but the script has been evaled so I.E. doesn&#x27;t  trust the global object when called normally</span>
            <span class="hljs-keyword">return</span> cachedClearTimeout.<span class="hljs-title function_">call</span>(<span class="hljs-literal">null</span>, marker);
        } <span class="hljs-keyword">catch</span> (e){
            <span class="hljs-comment">// same as above but when it&#x27;s a version of I.E. that must have the global object for &#x27;this&#x27;, hopfully our context correct otherwise it will throw a global error.</span>
            <span class="hljs-comment">// Some versions of I.E. have different rules for clearTimeout vs setTimeout</span>
            <span class="hljs-keyword">return</span> cachedClearTimeout.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, marker);
        }
    }



}
<span class="hljs-keyword">var</span> queue = [];
<span class="hljs-keyword">var</span> draining = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> currentQueue;
<span class="hljs-keyword">var</span> queueIndex = -<span class="hljs-number">1</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">cleanUpNextTick</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (!draining || !currentQueue) {
        <span class="hljs-keyword">return</span>;
    }
    draining = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (currentQueue.<span class="hljs-property">length</span>) {
        queue = currentQueue.<span class="hljs-title function_">concat</span>(queue);
    } <span class="hljs-keyword">else</span> {
        queueIndex = -<span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">if</span> (queue.<span class="hljs-property">length</span>) {
        <span class="hljs-title function_">drainQueue</span>();
    }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">drainQueue</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (draining) {
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> timeout = <span class="hljs-title function_">runTimeout</span>(cleanUpNextTick);
    draining = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">var</span> len = queue.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">while</span>(len) {
        currentQueue = queue;
        queue = [];
        <span class="hljs-keyword">while</span> (++queueIndex &lt; len) {
            <span class="hljs-keyword">if</span> (currentQueue) {
                currentQueue[queueIndex].<span class="hljs-title function_">run</span>();
            }
        }
        queueIndex = -<span class="hljs-number">1</span>;
        len = queue.<span class="hljs-property">length</span>;
    }
    currentQueue = <span class="hljs-literal">null</span>;
    draining = <span class="hljs-literal">false</span>;
    <span class="hljs-title function_">runClearTimeout</span>(timeout);
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">nextTick</span>(<span class="hljs-params">fun</span>) {
    <span class="hljs-keyword">var</span> args = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) {
            args[i - <span class="hljs-number">1</span>] = <span class="hljs-variable language_">arguments</span>[i];
        }
    }
    queue.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Item</span>(fun, args));
    <span class="hljs-keyword">if</span> (queue.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; !draining) {
        <span class="hljs-title function_">runTimeout</span>(drainQueue);
    }
}
<span class="hljs-comment">// v8 likes predictible objects</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Item</span>(<span class="hljs-params">fun, array</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fun</span> = fun;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span> = array;
}
<span class="hljs-title class_">Item</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">run</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fun</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span>);
};
<span class="hljs-keyword">var</span> title = <span class="hljs-string">&#x27;browser&#x27;</span>;
<span class="hljs-keyword">var</span> platform = <span class="hljs-string">&#x27;browser&#x27;</span>;
<span class="hljs-keyword">var</span> browser$1 = <span class="hljs-literal">true</span>;
<span class="hljs-keyword">var</span> env = {};
<span class="hljs-keyword">var</span> argv = [];
<span class="hljs-keyword">var</span> version = <span class="hljs-string">&#x27;&#x27;</span>; <span class="hljs-comment">// empty string to avoid regexp issues</span>
<span class="hljs-keyword">var</span> versions = {};
<span class="hljs-keyword">var</span> release = {};
<span class="hljs-keyword">var</span> config = {};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">noop</span>(<span class="hljs-params"></span>) {}

<span class="hljs-keyword">var</span> on = noop;
<span class="hljs-keyword">var</span> addListener = noop;
<span class="hljs-keyword">var</span> once = noop;
<span class="hljs-keyword">var</span> off = noop;
<span class="hljs-keyword">var</span> removeListener = noop;
<span class="hljs-keyword">var</span> removeAllListeners = noop;
<span class="hljs-keyword">var</span> emit = noop;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">binding</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;process.binding is not supported&#x27;</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">cwd</span> () { <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;/&#x27;</span> }
<span class="hljs-keyword">function</span> <span class="hljs-title function_">chdir</span> (dir) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;process.chdir is not supported&#x27;</span>);
}<span class="hljs-keyword">function</span> <span class="hljs-title function_">umask</span>(<span class="hljs-params"></span>) { <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; }

<span class="hljs-comment">// from https://github.com/kumavis/browser-process-hrtime/blob/master/index.js</span>
<span class="hljs-keyword">var</span> performance = <span class="hljs-variable language_">global</span>$1.<span class="hljs-property">performance</span> || {};
<span class="hljs-keyword">var</span> performanceNow =
  performance.<span class="hljs-property">now</span>        ||
  performance.<span class="hljs-property">mozNow</span>     ||
  performance.<span class="hljs-property">msNow</span>      ||
  performance.<span class="hljs-property">oNow</span>       ||
  performance.<span class="hljs-property">webkitNow</span>  ||
  <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){ <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">getTime</span>() };

<span class="hljs-comment">// generate timestamp or delta</span>
<span class="hljs-comment">// see http://nodejs.org/api/process.html#process_process_hrtime</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">hrtime</span>(<span class="hljs-params">previousTimestamp</span>){
  <span class="hljs-keyword">var</span> clocktime = performanceNow.<span class="hljs-title function_">call</span>(performance)*<span class="hljs-number">1e-3</span>;
  <span class="hljs-keyword">var</span> seconds = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(clocktime);
  <span class="hljs-keyword">var</span> nanoseconds = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((clocktime%<span class="hljs-number">1</span>)*<span class="hljs-number">1e9</span>);
  <span class="hljs-keyword">if</span> (previousTimestamp) {
    seconds = seconds - previousTimestamp[<span class="hljs-number">0</span>];
    nanoseconds = nanoseconds - previousTimestamp[<span class="hljs-number">1</span>];
    <span class="hljs-keyword">if</span> (nanoseconds&lt;<span class="hljs-number">0</span>) {
      seconds--;
      nanoseconds += <span class="hljs-number">1e9</span>;
    }
  }
  <span class="hljs-keyword">return</span> [seconds,nanoseconds]
}

<span class="hljs-keyword">var</span> startTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
<span class="hljs-keyword">function</span> <span class="hljs-title function_">uptime</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">var</span> currentTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
  <span class="hljs-keyword">var</span> dif = currentTime - startTime;
  <span class="hljs-keyword">return</span> dif / <span class="hljs-number">1000</span>;
}

<span class="hljs-keyword">var</span> browser$1$1 = {
  <span class="hljs-attr">nextTick</span>: nextTick,
  <span class="hljs-attr">title</span>: title,
  <span class="hljs-attr">browser</span>: browser$1,
  <span class="hljs-attr">env</span>: env,
  <span class="hljs-attr">argv</span>: argv,
  <span class="hljs-attr">version</span>: version,
  <span class="hljs-attr">versions</span>: versions,
  <span class="hljs-attr">on</span>: on,
  <span class="hljs-attr">addListener</span>: addListener,
  <span class="hljs-attr">once</span>: once,
  <span class="hljs-attr">off</span>: off,
  <span class="hljs-attr">removeListener</span>: removeListener,
  <span class="hljs-attr">removeAllListeners</span>: removeAllListeners,
  <span class="hljs-attr">emit</span>: emit,
  <span class="hljs-attr">binding</span>: binding,
  <span class="hljs-attr">cwd</span>: cwd,
  <span class="hljs-attr">chdir</span>: chdir,
  <span class="hljs-attr">umask</span>: umask,
  <span class="hljs-attr">hrtime</span>: hrtime,
  <span class="hljs-attr">platform</span>: platform,
  <span class="hljs-attr">release</span>: release,
  <span class="hljs-attr">config</span>: config,
  <span class="hljs-attr">uptime</span>: uptime
};

<span class="hljs-keyword">var</span> src = {<span class="hljs-attr">exports</span>: {}};

<span class="hljs-keyword">var</span> browser = {<span class="hljs-attr">exports</span>: {}};

<span class="hljs-comment">/**
 * Helpers.
 */</span>

<span class="hljs-keyword">var</span> ms;
<span class="hljs-keyword">var</span> hasRequiredMs;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">requireMs</span> () {
	<span class="hljs-keyword">if</span> (hasRequiredMs) <span class="hljs-keyword">return</span> ms;
	hasRequiredMs = <span class="hljs-number">1</span>;
	<span class="hljs-keyword">var</span> s = <span class="hljs-number">1000</span>;
	<span class="hljs-keyword">var</span> m = s * <span class="hljs-number">60</span>;
	<span class="hljs-keyword">var</span> h = m * <span class="hljs-number">60</span>;
	<span class="hljs-keyword">var</span> d = h * <span class="hljs-number">24</span>;
	<span class="hljs-keyword">var</span> w = d * <span class="hljs-number">7</span>;
	<span class="hljs-keyword">var</span> y = d * <span class="hljs-number">365.25</span>;

	<span class="hljs-comment">/**
	 * Parse or format the given `val`.
	 *
	 * Options:
	 *
	 *  - `long` verbose formatting [false]
	 *
	 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String|Number</span>} <span class="hljs-variable">val</span>
	 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} [options]
	 * <span class="hljs-doctag">@throws</span> {<span class="hljs-type">Error</span>} throw an error if val is not a non-empty string or a number
	 * <span class="hljs-doctag">@return</span> {<span class="hljs-type">String|Number</span>}
	 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span>
	 */</span>

	ms = <span class="hljs-keyword">function</span>(<span class="hljs-params">val, options</span>) {
	  options = options || {};
	  <span class="hljs-keyword">var</span> type = <span class="hljs-keyword">typeof</span> val;
	  <span class="hljs-keyword">if</span> (type === <span class="hljs-string">&#x27;string&#x27;</span> &amp;&amp; val.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title function_">parse</span>(val);
	  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">&#x27;number&#x27;</span> &amp;&amp; <span class="hljs-built_in">isFinite</span>(val)) {
	    <span class="hljs-keyword">return</span> options.<span class="hljs-property">long</span> ? <span class="hljs-title function_">fmtLong</span>(val) : <span class="hljs-title function_">fmtShort</span>(val);
	  }
	  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(
	    <span class="hljs-string">&#x27;val is not a non-empty string or a valid number. val=&#x27;</span> +
	      <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(val)
	  );
	};

	<span class="hljs-comment">/**
	 * Parse the given `str` and return milliseconds.
	 *
	 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} <span class="hljs-variable">str</span>
	 * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Number</span>}
	 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
	 */</span>

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">str</span>) {
	  str = <span class="hljs-title class_">String</span>(str);
	  <span class="hljs-keyword">if</span> (str.<span class="hljs-property">length</span> &gt; <span class="hljs-number">100</span>) {
	    <span class="hljs-keyword">return</span>;
	  }
	  <span class="hljs-keyword">var</span> match = <span class="hljs-regexp">/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i</span>.<span class="hljs-title function_">exec</span>(
	    str
	  );
	  <span class="hljs-keyword">if</span> (!match) {
	    <span class="hljs-keyword">return</span>;
	  }
	  <span class="hljs-keyword">var</span> n = <span class="hljs-built_in">parseFloat</span>(match[<span class="hljs-number">1</span>]);
	  <span class="hljs-keyword">var</span> type = (match[<span class="hljs-number">2</span>] || <span class="hljs-string">&#x27;ms&#x27;</span>).<span class="hljs-title function_">toLowerCase</span>();
	  <span class="hljs-keyword">switch</span> (type) {
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;years&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;year&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;yrs&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;yr&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;y&#x27;</span>:
	      <span class="hljs-keyword">return</span> n * y;
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;weeks&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;week&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;w&#x27;</span>:
	      <span class="hljs-keyword">return</span> n * w;
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;days&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;day&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:
	      <span class="hljs-keyword">return</span> n * d;
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hours&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hour&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hrs&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hr&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;h&#x27;</span>:
	      <span class="hljs-keyword">return</span> n * h;
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;minutes&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;minute&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;mins&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;min&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;m&#x27;</span>:
	      <span class="hljs-keyword">return</span> n * m;
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;seconds&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;second&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;secs&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;sec&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:
	      <span class="hljs-keyword">return</span> n * s;
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;milliseconds&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;millisecond&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;msecs&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;msec&#x27;</span>:
	    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ms&#x27;</span>:
	      <span class="hljs-keyword">return</span> n;
	    <span class="hljs-attr">default</span>:
	      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
	  }
	}

	<span class="hljs-comment">/**
	 * Short format for `ms`.
	 *
	 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} <span class="hljs-variable">ms</span>
	 * <span class="hljs-doctag">@return</span> {<span class="hljs-type">String</span>}
	 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
	 */</span>

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">fmtShort</span>(<span class="hljs-params">ms</span>) {
	  <span class="hljs-keyword">var</span> msAbs = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(ms);
	  <span class="hljs-keyword">if</span> (msAbs &gt;= d) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(ms / d) + <span class="hljs-string">&#x27;d&#x27;</span>;
	  }
	  <span class="hljs-keyword">if</span> (msAbs &gt;= h) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(ms / h) + <span class="hljs-string">&#x27;h&#x27;</span>;
	  }
	  <span class="hljs-keyword">if</span> (msAbs &gt;= m) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(ms / m) + <span class="hljs-string">&#x27;m&#x27;</span>;
	  }
	  <span class="hljs-keyword">if</span> (msAbs &gt;= s) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(ms / s) + <span class="hljs-string">&#x27;s&#x27;</span>;
	  }
	  <span class="hljs-keyword">return</span> ms + <span class="hljs-string">&#x27;ms&#x27;</span>;
	}

	<span class="hljs-comment">/**
	 * Long format for `ms`.
	 *
	 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} <span class="hljs-variable">ms</span>
	 * <span class="hljs-doctag">@return</span> {<span class="hljs-type">String</span>}
	 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
	 */</span>

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">fmtLong</span>(<span class="hljs-params">ms</span>) {
	  <span class="hljs-keyword">var</span> msAbs = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(ms);
	  <span class="hljs-keyword">if</span> (msAbs &gt;= d) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title function_">plural</span>(ms, msAbs, d, <span class="hljs-string">&#x27;day&#x27;</span>);
	  }
	  <span class="hljs-keyword">if</span> (msAbs &gt;= h) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title function_">plural</span>(ms, msAbs, h, <span class="hljs-string">&#x27;hour&#x27;</span>);
	  }
	  <span class="hljs-keyword">if</span> (msAbs &gt;= m) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title function_">plural</span>(ms, msAbs, m, <span class="hljs-string">&#x27;minute&#x27;</span>);
	  }
	  <span class="hljs-keyword">if</span> (msAbs &gt;= s) {
	    <span class="hljs-keyword">return</span> <span class="hljs-title function_">plural</span>(ms, msAbs, s, <span class="hljs-string">&#x27;second&#x27;</span>);
	  }
	  <span class="hljs-keyword">return</span> ms + <span class="hljs-string">&#x27; ms&#x27;</span>;
	}

	<span class="hljs-comment">/**
	 * Pluralization helper.
	 */</span>

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">plural</span>(<span class="hljs-params">ms, msAbs, n, name</span>) {
	  <span class="hljs-keyword">var</span> isPlural = msAbs &gt;= n * <span class="hljs-number">1.5</span>;
	  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(ms / n) + <span class="hljs-string">&#x27; &#x27;</span> + name + (isPlural ? <span class="hljs-string">&#x27;s&#x27;</span> : <span class="hljs-string">&#x27;&#x27;</span>);
	}
	<span class="hljs-keyword">return</span> ms;
}

<span class="hljs-keyword">var</span> common;
<span class="hljs-keyword">var</span> hasRequiredCommon;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">requireCommon</span> () {
	<span class="hljs-keyword">if</span> (hasRequiredCommon) <span class="hljs-keyword">return</span> common;
	hasRequiredCommon = <span class="hljs-number">1</span>;
	<span class="hljs-comment">/**
	 * This is the common logic for both the Node.js and web browser
	 * implementations of `debug()`.
	 */</span>

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params">env</span>) {
		createDebug.<span class="hljs-property">debug</span> = createDebug;
		createDebug.<span class="hljs-property">default</span> = createDebug;
		createDebug.<span class="hljs-property">coerce</span> = coerce;
		createDebug.<span class="hljs-property">disable</span> = disable;
		createDebug.<span class="hljs-property">enable</span> = enable;
		createDebug.<span class="hljs-property">enabled</span> = enabled;
		createDebug.<span class="hljs-property">humanize</span> = requireMs();
		createDebug.<span class="hljs-property">destroy</span> = destroy;

		<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(env).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
			createDebug[key] = env[key];
		});

		<span class="hljs-comment">/**
		* The currently active debug mode names, and names to skip.
		*/</span>

		createDebug.<span class="hljs-property">names</span> = [];
		createDebug.<span class="hljs-property">skips</span> = [];

		<span class="hljs-comment">/**
		* Map of special &quot;%n&quot; handling functions, for the debug &quot;format&quot; argument.
		*
		* Valid key names are a single, lower or upper-case letter, i.e. &quot;n&quot; and &quot;N&quot;.
		*/</span>
		createDebug.<span class="hljs-property">formatters</span> = {};

		<span class="hljs-comment">/**
		* Selects a color for a debug namespace
		* <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} namespace The namespace string for the debug instance to be colored
		* <span class="hljs-doctag">@return</span> {<span class="hljs-type">Number|String</span>} An ANSI color code for the given namespace
		* <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
		*/</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">selectColor</span>(<span class="hljs-params">namespace</span>) {
			<span class="hljs-keyword">let</span> hash = <span class="hljs-number">0</span>;

			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; namespace.<span class="hljs-property">length</span>; i++) {
				hash = ((hash &lt;&lt; <span class="hljs-number">5</span>) - hash) + namespace.<span class="hljs-title function_">charCodeAt</span>(i);
				hash |= <span class="hljs-number">0</span>; <span class="hljs-comment">// Convert to 32bit integer</span>
			}

			<span class="hljs-keyword">return</span> createDebug.<span class="hljs-property">colors</span>[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(hash) % createDebug.<span class="hljs-property">colors</span>.<span class="hljs-property">length</span>];
		}
		createDebug.<span class="hljs-property">selectColor</span> = selectColor;

		<span class="hljs-comment">/**
		* Create a debugger with the given `namespace`.
		*
		* <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} <span class="hljs-variable">namespace</span>
		* <span class="hljs-doctag">@return</span> {<span class="hljs-type">Function</span>}
		* <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span>
		*/</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">createDebug</span>(<span class="hljs-params">namespace</span>) {
			<span class="hljs-keyword">let</span> prevTime;
			<span class="hljs-keyword">let</span> enableOverride = <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">let</span> namespacesCache;
			<span class="hljs-keyword">let</span> enabledCache;

			<span class="hljs-keyword">function</span> <span class="hljs-title function_">debug</span>(<span class="hljs-params">...args</span>) {
				<span class="hljs-comment">// Disabled?</span>
				<span class="hljs-keyword">if</span> (!debug.<span class="hljs-property">enabled</span>) {
					<span class="hljs-keyword">return</span>;
				}

				<span class="hljs-keyword">const</span> self = debug;

				<span class="hljs-comment">// Set `diff` timestamp</span>
				<span class="hljs-keyword">const</span> curr = <span class="hljs-title class_">Number</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());
				<span class="hljs-keyword">const</span> ms = curr - (prevTime || curr);
				self.<span class="hljs-property">diff</span> = ms;
				self.<span class="hljs-property">prev</span> = prevTime;
				self.<span class="hljs-property">curr</span> = curr;
				prevTime = curr;

				args[<span class="hljs-number">0</span>] = createDebug.<span class="hljs-title function_">coerce</span>(args[<span class="hljs-number">0</span>]);

				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> args[<span class="hljs-number">0</span>] !== <span class="hljs-string">&#x27;string&#x27;</span>) {
					<span class="hljs-comment">// Anything else let&#x27;s inspect with %O</span>
					args.<span class="hljs-title function_">unshift</span>(<span class="hljs-string">&#x27;%O&#x27;</span>);
				}

				<span class="hljs-comment">// Apply any `formatters` transformations</span>
				<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
				args[<span class="hljs-number">0</span>] = args[<span class="hljs-number">0</span>].<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/%([a-zA-Z%])/g</span>, <span class="hljs-function">(<span class="hljs-params">match, format</span>) =&gt;</span> {
					<span class="hljs-comment">// If we encounter an escaped % then don&#x27;t increase the array index</span>
					<span class="hljs-keyword">if</span> (match === <span class="hljs-string">&#x27;%%&#x27;</span>) {
						<span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;%&#x27;</span>;
					}
					index++;
					<span class="hljs-keyword">const</span> formatter = createDebug.<span class="hljs-property">formatters</span>[format];
					<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> formatter === <span class="hljs-string">&#x27;function&#x27;</span>) {
						<span class="hljs-keyword">const</span> val = args[index];
						match = formatter.<span class="hljs-title function_">call</span>(self, val);

						<span class="hljs-comment">// Now we need to remove `args[index]` since it&#x27;s inlined in the `format`</span>
						args.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
						index--;
					}
					<span class="hljs-keyword">return</span> match;
				});

				<span class="hljs-comment">// Apply env-specific formatting (colors, etc.)</span>
				createDebug.<span class="hljs-property">formatArgs</span>.<span class="hljs-title function_">call</span>(self, args);

				<span class="hljs-keyword">const</span> logFn = self.<span class="hljs-property">log</span> || createDebug.<span class="hljs-property">log</span>;
				logFn.<span class="hljs-title function_">apply</span>(self, args);
			}

			debug.<span class="hljs-property">namespace</span> = namespace;
			debug.<span class="hljs-property">useColors</span> = createDebug.<span class="hljs-title function_">useColors</span>();
			debug.<span class="hljs-property">color</span> = createDebug.<span class="hljs-title function_">selectColor</span>(namespace);
			debug.<span class="hljs-property">extend</span> = extend;
			debug.<span class="hljs-property">destroy</span> = createDebug.<span class="hljs-property">destroy</span>; <span class="hljs-comment">// XXX Temporary. Will be removed in the next major release.</span>

			<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(debug, <span class="hljs-string">&#x27;enabled&#x27;</span>, {
				<span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
				<span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,
				<span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> {
					<span class="hljs-keyword">if</span> (enableOverride !== <span class="hljs-literal">null</span>) {
						<span class="hljs-keyword">return</span> enableOverride;
					}
					<span class="hljs-keyword">if</span> (namespacesCache !== createDebug.<span class="hljs-property">namespaces</span>) {
						namespacesCache = createDebug.<span class="hljs-property">namespaces</span>;
						enabledCache = createDebug.<span class="hljs-title function_">enabled</span>(namespace);
					}

					<span class="hljs-keyword">return</span> enabledCache;
				},
				<span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {
					enableOverride = v;
				}
			});

			<span class="hljs-comment">// Env-specific initialization logic for debug instances</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> createDebug.<span class="hljs-property">init</span> === <span class="hljs-string">&#x27;function&#x27;</span>) {
				createDebug.<span class="hljs-title function_">init</span>(debug);
			}

			<span class="hljs-keyword">return</span> debug;
		}

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">extend</span>(<span class="hljs-params">namespace, delimiter</span>) {
			<span class="hljs-keyword">const</span> newDebug = <span class="hljs-title function_">createDebug</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">namespace</span> + (<span class="hljs-keyword">typeof</span> delimiter === <span class="hljs-string">&#x27;undefined&#x27;</span> ? <span class="hljs-string">&#x27;:&#x27;</span> : delimiter) + namespace);
			newDebug.<span class="hljs-property">log</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">log</span>;
			<span class="hljs-keyword">return</span> newDebug;
		}

		<span class="hljs-comment">/**
		* Enables a debug mode by namespaces. This can include modes
		* separated by a colon and wildcards.
		*
		* <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} <span class="hljs-variable">namespaces</span>
		* <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span>
		*/</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">enable</span>(<span class="hljs-params">namespaces</span>) {
			createDebug.<span class="hljs-title function_">save</span>(namespaces);
			createDebug.<span class="hljs-property">namespaces</span> = namespaces;

			createDebug.<span class="hljs-property">names</span> = [];
			createDebug.<span class="hljs-property">skips</span> = [];

			<span class="hljs-keyword">let</span> i;
			<span class="hljs-keyword">const</span> split = (<span class="hljs-keyword">typeof</span> namespaces === <span class="hljs-string">&#x27;string&#x27;</span> ? namespaces : <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/[\s,]+/</span>);
			<span class="hljs-keyword">const</span> len = split.<span class="hljs-property">length</span>;

			<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; i++) {
				<span class="hljs-keyword">if</span> (!split[i]) {
					<span class="hljs-comment">// ignore empty strings</span>
					<span class="hljs-keyword">continue</span>;
				}

				namespaces = split[i].<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\*/g</span>, <span class="hljs-string">&#x27;.*?&#x27;</span>);

				<span class="hljs-keyword">if</span> (namespaces[<span class="hljs-number">0</span>] === <span class="hljs-string">&#x27;-&#x27;</span>) {
					createDebug.<span class="hljs-property">skips</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;^&#x27;</span> + namespaces.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>) + <span class="hljs-string">&#x27;$&#x27;</span>));
				} <span class="hljs-keyword">else</span> {
					createDebug.<span class="hljs-property">names</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;^&#x27;</span> + namespaces + <span class="hljs-string">&#x27;$&#x27;</span>));
				}
			}
		}

		<span class="hljs-comment">/**
		* Disable debug output.
		*
		* <span class="hljs-doctag">@return</span> {<span class="hljs-type">String</span>} <span class="hljs-variable">namespaces</span>
		* <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span>
		*/</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">disable</span>(<span class="hljs-params"></span>) {
			<span class="hljs-keyword">const</span> namespaces = [
				...createDebug.<span class="hljs-property">names</span>.<span class="hljs-title function_">map</span>(toNamespace),
				...createDebug.<span class="hljs-property">skips</span>.<span class="hljs-title function_">map</span>(toNamespace).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">namespace</span> =&gt;</span> <span class="hljs-string">&#x27;-&#x27;</span> + namespace)
			].<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;,&#x27;</span>);
			createDebug.<span class="hljs-title function_">enable</span>(<span class="hljs-string">&#x27;&#x27;</span>);
			<span class="hljs-keyword">return</span> namespaces;
		}

		<span class="hljs-comment">/**
		* Returns true if the given mode name is enabled, false otherwise.
		*
		* <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} <span class="hljs-variable">name</span>
		* <span class="hljs-doctag">@return</span> {<span class="hljs-type">Boolean</span>}
		* <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span>
		*/</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">enabled</span>(<span class="hljs-params">name</span>) {
			<span class="hljs-keyword">if</span> (name[name.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] === <span class="hljs-string">&#x27;*&#x27;</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}

			<span class="hljs-keyword">let</span> i;
			<span class="hljs-keyword">let</span> len;

			<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, len = createDebug.<span class="hljs-property">skips</span>.<span class="hljs-property">length</span>; i &lt; len; i++) {
				<span class="hljs-keyword">if</span> (createDebug.<span class="hljs-property">skips</span>[i].<span class="hljs-title function_">test</span>(name)) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
			}

			<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, len = createDebug.<span class="hljs-property">names</span>.<span class="hljs-property">length</span>; i &lt; len; i++) {
				<span class="hljs-keyword">if</span> (createDebug.<span class="hljs-property">names</span>[i].<span class="hljs-title function_">test</span>(name)) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
				}
			}

			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}

		<span class="hljs-comment">/**
		* Convert regexp to namespace
		*
		* <span class="hljs-doctag">@param</span> {<span class="hljs-type">RegExp</span>} <span class="hljs-variable">regxep</span>
		* <span class="hljs-doctag">@return</span> {<span class="hljs-type">String</span>} <span class="hljs-variable">namespace</span>
		* <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
		*/</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">toNamespace</span>(<span class="hljs-params">regexp</span>) {
			<span class="hljs-keyword">return</span> regexp.<span class="hljs-title function_">toString</span>()
				.<span class="hljs-title function_">substring</span>(<span class="hljs-number">2</span>, regexp.<span class="hljs-title function_">toString</span>().<span class="hljs-property">length</span> - <span class="hljs-number">2</span>)
				.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\.\*\?$/</span>, <span class="hljs-string">&#x27;*&#x27;</span>);
		}

		<span class="hljs-comment">/**
		* Coerce `val`.
		*
		* <span class="hljs-doctag">@param</span> {<span class="hljs-type">Mixed</span>} <span class="hljs-variable">val</span>
		* <span class="hljs-doctag">@return</span> {<span class="hljs-type">Mixed</span>}
		* <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
		*/</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">coerce</span>(<span class="hljs-params">val</span>) {
			<span class="hljs-keyword">if</span> (val <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>) {
				<span class="hljs-keyword">return</span> val.<span class="hljs-property">stack</span> || val.<span class="hljs-property">message</span>;
			}
			<span class="hljs-keyword">return</span> val;
		}

		<span class="hljs-comment">/**
		* XXX DO NOT USE. This is a temporary stub function.
		* XXX It WILL be removed in the next major release.
		*/</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">destroy</span>(<span class="hljs-params"></span>) {
			<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.&#x27;</span>);
		}

		createDebug.<span class="hljs-title function_">enable</span>(createDebug.<span class="hljs-title function_">load</span>());

		<span class="hljs-keyword">return</span> createDebug;
	}

	common = setup;
	<span class="hljs-keyword">return</span> common;
}

<span class="hljs-keyword">var</span> hasRequiredBrowser;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">requireBrowser</span> () {
	<span class="hljs-keyword">if</span> (hasRequiredBrowser) <span class="hljs-keyword">return</span> browser.<span class="hljs-property">exports</span>;
	hasRequiredBrowser = <span class="hljs-number">1</span>;
	(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">module</span>, <span class="hljs-built_in">exports</span></span>) {
		<span class="hljs-comment">/**
		 * This is the web browser implementation of `debug()`.
		 */</span>

		<span class="hljs-built_in">exports</span>.<span class="hljs-property">formatArgs</span> = formatArgs;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">save</span> = save;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">load</span> = load;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">useColors</span> = useColors;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">storage</span> = <span class="hljs-title function_">localstorage</span>();
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">destroy</span> = (<span class="hljs-function">() =&gt;</span> {
			<span class="hljs-keyword">let</span> warned = <span class="hljs-literal">false</span>;

			<span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
				<span class="hljs-keyword">if</span> (!warned) {
					warned = <span class="hljs-literal">true</span>;
					<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.&#x27;</span>);
				}
			};
		})();

		<span class="hljs-comment">/**
		 * Colors.
		 */</span>

		<span class="hljs-built_in">exports</span>.<span class="hljs-property">colors</span> = [
			<span class="hljs-string">&#x27;#0000CC&#x27;</span>,
			<span class="hljs-string">&#x27;#0000FF&#x27;</span>,
			<span class="hljs-string">&#x27;#0033CC&#x27;</span>,
			<span class="hljs-string">&#x27;#0033FF&#x27;</span>,
			<span class="hljs-string">&#x27;#0066CC&#x27;</span>,
			<span class="hljs-string">&#x27;#0066FF&#x27;</span>,
			<span class="hljs-string">&#x27;#0099CC&#x27;</span>,
			<span class="hljs-string">&#x27;#0099FF&#x27;</span>,
			<span class="hljs-string">&#x27;#00CC00&#x27;</span>,
			<span class="hljs-string">&#x27;#00CC33&#x27;</span>,
			<span class="hljs-string">&#x27;#00CC66&#x27;</span>,
			<span class="hljs-string">&#x27;#00CC99&#x27;</span>,
			<span class="hljs-string">&#x27;#00CCCC&#x27;</span>,
			<span class="hljs-string">&#x27;#00CCFF&#x27;</span>,
			<span class="hljs-string">&#x27;#3300CC&#x27;</span>,
			<span class="hljs-string">&#x27;#3300FF&#x27;</span>,
			<span class="hljs-string">&#x27;#3333CC&#x27;</span>,
			<span class="hljs-string">&#x27;#3333FF&#x27;</span>,
			<span class="hljs-string">&#x27;#3366CC&#x27;</span>,
			<span class="hljs-string">&#x27;#3366FF&#x27;</span>,
			<span class="hljs-string">&#x27;#3399CC&#x27;</span>,
			<span class="hljs-string">&#x27;#3399FF&#x27;</span>,
			<span class="hljs-string">&#x27;#33CC00&#x27;</span>,
			<span class="hljs-string">&#x27;#33CC33&#x27;</span>,
			<span class="hljs-string">&#x27;#33CC66&#x27;</span>,
			<span class="hljs-string">&#x27;#33CC99&#x27;</span>,
			<span class="hljs-string">&#x27;#33CCCC&#x27;</span>,
			<span class="hljs-string">&#x27;#33CCFF&#x27;</span>,
			<span class="hljs-string">&#x27;#6600CC&#x27;</span>,
			<span class="hljs-string">&#x27;#6600FF&#x27;</span>,
			<span class="hljs-string">&#x27;#6633CC&#x27;</span>,
			<span class="hljs-string">&#x27;#6633FF&#x27;</span>,
			<span class="hljs-string">&#x27;#66CC00&#x27;</span>,
			<span class="hljs-string">&#x27;#66CC33&#x27;</span>,
			<span class="hljs-string">&#x27;#9900CC&#x27;</span>,
			<span class="hljs-string">&#x27;#9900FF&#x27;</span>,
			<span class="hljs-string">&#x27;#9933CC&#x27;</span>,
			<span class="hljs-string">&#x27;#9933FF&#x27;</span>,
			<span class="hljs-string">&#x27;#99CC00&#x27;</span>,
			<span class="hljs-string">&#x27;#99CC33&#x27;</span>,
			<span class="hljs-string">&#x27;#CC0000&#x27;</span>,
			<span class="hljs-string">&#x27;#CC0033&#x27;</span>,
			<span class="hljs-string">&#x27;#CC0066&#x27;</span>,
			<span class="hljs-string">&#x27;#CC0099&#x27;</span>,
			<span class="hljs-string">&#x27;#CC00CC&#x27;</span>,
			<span class="hljs-string">&#x27;#CC00FF&#x27;</span>,
			<span class="hljs-string">&#x27;#CC3300&#x27;</span>,
			<span class="hljs-string">&#x27;#CC3333&#x27;</span>,
			<span class="hljs-string">&#x27;#CC3366&#x27;</span>,
			<span class="hljs-string">&#x27;#CC3399&#x27;</span>,
			<span class="hljs-string">&#x27;#CC33CC&#x27;</span>,
			<span class="hljs-string">&#x27;#CC33FF&#x27;</span>,
			<span class="hljs-string">&#x27;#CC6600&#x27;</span>,
			<span class="hljs-string">&#x27;#CC6633&#x27;</span>,
			<span class="hljs-string">&#x27;#CC9900&#x27;</span>,
			<span class="hljs-string">&#x27;#CC9933&#x27;</span>,
			<span class="hljs-string">&#x27;#CCCC00&#x27;</span>,
			<span class="hljs-string">&#x27;#CCCC33&#x27;</span>,
			<span class="hljs-string">&#x27;#FF0000&#x27;</span>,
			<span class="hljs-string">&#x27;#FF0033&#x27;</span>,
			<span class="hljs-string">&#x27;#FF0066&#x27;</span>,
			<span class="hljs-string">&#x27;#FF0099&#x27;</span>,
			<span class="hljs-string">&#x27;#FF00CC&#x27;</span>,
			<span class="hljs-string">&#x27;#FF00FF&#x27;</span>,
			<span class="hljs-string">&#x27;#FF3300&#x27;</span>,
			<span class="hljs-string">&#x27;#FF3333&#x27;</span>,
			<span class="hljs-string">&#x27;#FF3366&#x27;</span>,
			<span class="hljs-string">&#x27;#FF3399&#x27;</span>,
			<span class="hljs-string">&#x27;#FF33CC&#x27;</span>,
			<span class="hljs-string">&#x27;#FF33FF&#x27;</span>,
			<span class="hljs-string">&#x27;#FF6600&#x27;</span>,
			<span class="hljs-string">&#x27;#FF6633&#x27;</span>,
			<span class="hljs-string">&#x27;#FF9900&#x27;</span>,
			<span class="hljs-string">&#x27;#FF9933&#x27;</span>,
			<span class="hljs-string">&#x27;#FFCC00&#x27;</span>,
			<span class="hljs-string">&#x27;#FFCC33&#x27;</span>
		];

		<span class="hljs-comment">/**
		 * Currently only WebKit-based Web Inspectors, Firefox &gt;= v31,
		 * and the Firebug extension (any Firefox version) are known
		 * to support &quot;%c&quot; CSS customizations.
		 *
		 * <span class="hljs-doctag">TODO:</span> add a `localStorage` variable to explicitly enable/disable colors
		 */</span>

		<span class="hljs-comment">// eslint-disable-next-line complexity</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">useColors</span>(<span class="hljs-params"></span>) {
			<span class="hljs-comment">// NB: In an Electron preload script, document will be defined but not fully</span>
			<span class="hljs-comment">// initialized. Since we know we&#x27;re in Chrome, we&#x27;ll just detect this case</span>
			<span class="hljs-comment">// explicitly</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">process</span> &amp;&amp; (<span class="hljs-variable language_">window</span>.<span class="hljs-property">process</span>.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;renderer&#x27;</span> || <span class="hljs-variable language_">window</span>.<span class="hljs-property">process</span>.<span class="hljs-property">__nwjs</span>)) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}

			<span class="hljs-comment">// Internet Explorer and Edge do not support colors.</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> navigator !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; navigator.<span class="hljs-property">userAgent</span> &amp;&amp; navigator.<span class="hljs-property">userAgent</span>.<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(edge|trident)\/(\d+)/</span>)) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}

			<span class="hljs-comment">// Is webkit? http://stackoverflow.com/a/16459606/376773</span>
			<span class="hljs-comment">// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632</span>
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">document</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span> &amp;&amp; <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">style</span> &amp;&amp; <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">WebkitAppearance</span>) ||
				<span class="hljs-comment">// Is firebug? http://stackoverflow.com/a/398120/376773</span>
				(<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span> &amp;&amp; (<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>.<span class="hljs-property">firebug</span> || (<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>.<span class="hljs-property">exception</span> &amp;&amp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>.<span class="hljs-property">table</span>))) ||
				<span class="hljs-comment">// Is firefox &gt;= v31?</span>
				<span class="hljs-comment">// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages</span>
				(<span class="hljs-keyword">typeof</span> navigator !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; navigator.<span class="hljs-property">userAgent</span> &amp;&amp; navigator.<span class="hljs-property">userAgent</span>.<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/firefox\/(\d+)/</span>) &amp;&amp; <span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">RegExp</span>.<span class="hljs-property">$1</span>, <span class="hljs-number">10</span>) &gt;= <span class="hljs-number">31</span>) ||
				<span class="hljs-comment">// Double check webkit in userAgent just in case we are in a worker</span>
				(<span class="hljs-keyword">typeof</span> navigator !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; navigator.<span class="hljs-property">userAgent</span> &amp;&amp; navigator.<span class="hljs-property">userAgent</span>.<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/applewebkit\/(\d+)/</span>));
		}

		<span class="hljs-comment">/**
		 * Colorize log arguments if enabled.
		 *
		 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span>
		 */</span>

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatArgs</span>(<span class="hljs-params">args</span>) {
			args[<span class="hljs-number">0</span>] = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">useColors</span> ? <span class="hljs-string">&#x27;%c&#x27;</span> : <span class="hljs-string">&#x27;&#x27;</span>) +
				<span class="hljs-variable language_">this</span>.<span class="hljs-property">namespace</span> +
				(<span class="hljs-variable language_">this</span>.<span class="hljs-property">useColors</span> ? <span class="hljs-string">&#x27; %c&#x27;</span> : <span class="hljs-string">&#x27; &#x27;</span>) +
				args[<span class="hljs-number">0</span>] +
				(<span class="hljs-variable language_">this</span>.<span class="hljs-property">useColors</span> ? <span class="hljs-string">&#x27;%c &#x27;</span> : <span class="hljs-string">&#x27; &#x27;</span>) +
				<span class="hljs-string">&#x27;+&#x27;</span> + <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>.<span class="hljs-title function_">humanize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">diff</span>);

			<span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">useColors</span>) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">const</span> c = <span class="hljs-string">&#x27;color: &#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span>;
			args.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, c, <span class="hljs-string">&#x27;color: inherit&#x27;</span>);

			<span class="hljs-comment">// The final &quot;%c&quot; is somewhat tricky, because there could be other</span>
			<span class="hljs-comment">// arguments passed either before or after the %c, so we need to</span>
			<span class="hljs-comment">// figure out the correct index to insert the CSS into</span>
			<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
			<span class="hljs-keyword">let</span> lastC = <span class="hljs-number">0</span>;
			args[<span class="hljs-number">0</span>].<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/%[a-zA-Z%]/g</span>, <span class="hljs-function"><span class="hljs-params">match</span> =&gt;</span> {
				<span class="hljs-keyword">if</span> (match === <span class="hljs-string">&#x27;%%&#x27;</span>) {
					<span class="hljs-keyword">return</span>;
				}
				index++;
				<span class="hljs-keyword">if</span> (match === <span class="hljs-string">&#x27;%c&#x27;</span>) {
					<span class="hljs-comment">// We only are interested in the *last* %c</span>
					<span class="hljs-comment">// (the user may have provided their own)</span>
					lastC = index;
				}
			});

			args.<span class="hljs-title function_">splice</span>(lastC, <span class="hljs-number">0</span>, c);
		}

		<span class="hljs-comment">/**
		 * Invokes `console.debug()` when available.
		 * No-op when `console.debug` is not a &quot;function&quot;.
		 * If `console.debug` is not available, falls back
		 * to `console.log`.
		 *
		 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span>
		 */</span>
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">log</span> = <span class="hljs-variable language_">console</span>.<span class="hljs-property">debug</span> || <span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span> || (<span class="hljs-function">() =&gt;</span> {});

		<span class="hljs-comment">/**
		 * Save `namespaces`.
		 *
		 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} <span class="hljs-variable">namespaces</span>
		 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
		 */</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">save</span>(<span class="hljs-params">namespaces</span>) {
			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">if</span> (namespaces) {
					<span class="hljs-built_in">exports</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&#x27;debug&#x27;</span>, namespaces);
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-built_in">exports</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">&#x27;debug&#x27;</span>);
				}
			} <span class="hljs-keyword">catch</span> (error) {
				<span class="hljs-comment">// Swallow</span>
				<span class="hljs-comment">// XXX (@Qix-) should we be logging these?</span>
			}
		}

		<span class="hljs-comment">/**
		 * Load `namespaces`.
		 *
		 * <span class="hljs-doctag">@return</span> {<span class="hljs-type">String</span>} returns the previously persisted debug modes
		 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
		 */</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">load</span>(<span class="hljs-params"></span>) {
			<span class="hljs-keyword">let</span> r;
			<span class="hljs-keyword">try</span> {
				r = <span class="hljs-built_in">exports</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;debug&#x27;</span>);
			} <span class="hljs-keyword">catch</span> (error) {
				<span class="hljs-comment">// Swallow</span>
				<span class="hljs-comment">// XXX (@Qix-) should we be logging these?</span>
			}

			<span class="hljs-comment">// If debug isn&#x27;t set in LS, and we&#x27;re in Electron, try to load $DEBUG</span>
			<span class="hljs-keyword">if</span> (!r &amp;&amp; <span class="hljs-keyword">typeof</span> browser$1$1 !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-string">&#x27;env&#x27;</span> <span class="hljs-keyword">in</span> browser$1$1) {
				r = browser$1$1.<span class="hljs-property">env</span>.<span class="hljs-property">DEBUG</span>;
			}

			<span class="hljs-keyword">return</span> r;
		}

		<span class="hljs-comment">/**
		 * Localstorage attempts to return the localstorage.
		 *
		 * This is necessary because safari throws
		 * when a user disables cookies/localstorage
		 * and you attempt to access it.
		 *
		 * <span class="hljs-doctag">@return</span> {<span class="hljs-type">LocalStorage</span>}
		 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
		 */</span>

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">localstorage</span>(<span class="hljs-params"></span>) {
			<span class="hljs-keyword">try</span> {
				<span class="hljs-comment">// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context</span>
				<span class="hljs-comment">// The Browser also has localStorage in the global context.</span>
				<span class="hljs-keyword">return</span> <span class="hljs-variable language_">localStorage</span>;
			} <span class="hljs-keyword">catch</span> (error) {
				<span class="hljs-comment">// Swallow</span>
				<span class="hljs-comment">// XXX (@Qix-) should we be logging these?</span>
			}
		}

		<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = requireCommon()(<span class="hljs-built_in">exports</span>);

		<span class="hljs-keyword">const</span> {formatters} = <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>;

		<span class="hljs-comment">/**
		 * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.
		 */</span>

		formatters.<span class="hljs-property">j</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">v</span>) {
			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(v);
			} <span class="hljs-keyword">catch</span> (error) {
				<span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;[UnexpectedJSONParseError]: &#x27;</span> + error.<span class="hljs-property">message</span>;
			}
		}; 
	} (browser, browser.<span class="hljs-property">exports</span>));
	<span class="hljs-keyword">return</span> browser.<span class="hljs-property">exports</span>;
}

<span class="hljs-keyword">var</span> node = {<span class="hljs-attr">exports</span>: {}};

<span class="hljs-comment">// MIT lisence</span>
<span class="hljs-comment">// from https://github.com/substack/tty-browserify/blob/1ba769a6429d242f36226538835b4034bf6b7886/index.js</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isatty</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">ReadStream</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;tty.ReadStream is not implemented&#x27;</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">WriteStream</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;tty.ReadStream is not implemented&#x27;</span>);
}

<span class="hljs-keyword">var</span> _polyfillNode_tty = {
  <span class="hljs-attr">isatty</span>: isatty,
  <span class="hljs-title class_">ReadStream</span>: <span class="hljs-title class_">ReadStream</span>,
  <span class="hljs-title class_">WriteStream</span>: <span class="hljs-title class_">WriteStream</span>
};

<span class="hljs-keyword">var</span> _polyfillNode_tty$1 = <span class="hljs-comment">/*#__PURE__*/</span><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">freeze</span>({
  <span class="hljs-attr">__proto__</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-title class_">ReadStream</span>: <span class="hljs-title class_">ReadStream</span>,
  <span class="hljs-title class_">WriteStream</span>: <span class="hljs-title class_">WriteStream</span>,
  <span class="hljs-attr">default</span>: _polyfillNode_tty,
  <span class="hljs-attr">isatty</span>: isatty
});

<span class="hljs-keyword">var</span> <span class="hljs-built_in">require</span>$$0 = <span class="hljs-comment">/*@__PURE__*/</span><span class="hljs-title function_">getAugmentedNamespace</span>(_polyfillNode_tty$1);

<span class="hljs-keyword">var</span> lookup = [];
<span class="hljs-keyword">var</span> revLookup = [];
<span class="hljs-keyword">var</span> <span class="hljs-title class_">Arr</span> = <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Uint8Array</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> ? <span class="hljs-title class_">Uint8Array</span> : <span class="hljs-title class_">Array</span>;
<span class="hljs-keyword">var</span> inited = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span> () {
  inited = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">var</span> code = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = code.<span class="hljs-property">length</span>; i &lt; len; ++i) {
    lookup[i] = code[i];
    revLookup[code.<span class="hljs-title function_">charCodeAt</span>(i)] = i;
  }

  revLookup[<span class="hljs-string">&#x27;-&#x27;</span>.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>)] = <span class="hljs-number">62</span>;
  revLookup[<span class="hljs-string">&#x27;_&#x27;</span>.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>)] = <span class="hljs-number">63</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">toByteArray</span> (b64) {
  <span class="hljs-keyword">if</span> (!inited) {
    <span class="hljs-title function_">init</span>();
  }
  <span class="hljs-keyword">var</span> i, j, l, tmp, placeHolders, arr;
  <span class="hljs-keyword">var</span> len = b64.<span class="hljs-property">length</span>;

  <span class="hljs-keyword">if</span> (len % <span class="hljs-number">4</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Invalid string. Length must be a multiple of 4&#x27;</span>)
  }

  <span class="hljs-comment">// the number of equal signs (place holders)</span>
  <span class="hljs-comment">// if there are two placeholders, than the two characters before it</span>
  <span class="hljs-comment">// represent one byte</span>
  <span class="hljs-comment">// if there is only one, then the three characters before it represent 2 bytes</span>
  <span class="hljs-comment">// this is just a cheap hack to not do indexOf twice</span>
  placeHolders = b64[len - <span class="hljs-number">2</span>] === <span class="hljs-string">&#x27;=&#x27;</span> ? <span class="hljs-number">2</span> : b64[len - <span class="hljs-number">1</span>] === <span class="hljs-string">&#x27;=&#x27;</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;

  <span class="hljs-comment">// base64 is 4/3 + up to two characters of the original data</span>
  arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Arr</span>(len * <span class="hljs-number">3</span> / <span class="hljs-number">4</span> - placeHolders);

  <span class="hljs-comment">// if there are placeholders, only get up to the last complete 4 chars</span>
  l = placeHolders &gt; <span class="hljs-number">0</span> ? len - <span class="hljs-number">4</span> : len;

  <span class="hljs-keyword">var</span> L = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; i &lt; l; i += <span class="hljs-number">4</span>, j += <span class="hljs-number">3</span>) {
    tmp = (revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i)] &lt;&lt; <span class="hljs-number">18</span>) | (revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i + <span class="hljs-number">1</span>)] &lt;&lt; <span class="hljs-number">12</span>) | (revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i + <span class="hljs-number">2</span>)] &lt;&lt; <span class="hljs-number">6</span>) | revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i + <span class="hljs-number">3</span>)];
    arr[L++] = (tmp &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;
    arr[L++] = (tmp &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;
    arr[L++] = tmp &amp; <span class="hljs-number">0xFF</span>;
  }

  <span class="hljs-keyword">if</span> (placeHolders === <span class="hljs-number">2</span>) {
    tmp = (revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i)] &lt;&lt; <span class="hljs-number">2</span>) | (revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i + <span class="hljs-number">1</span>)] &gt;&gt; <span class="hljs-number">4</span>);
    arr[L++] = tmp &amp; <span class="hljs-number">0xFF</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (placeHolders === <span class="hljs-number">1</span>) {
    tmp = (revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i)] &lt;&lt; <span class="hljs-number">10</span>) | (revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i + <span class="hljs-number">1</span>)] &lt;&lt; <span class="hljs-number">4</span>) | (revLookup[b64.<span class="hljs-title function_">charCodeAt</span>(i + <span class="hljs-number">2</span>)] &gt;&gt; <span class="hljs-number">2</span>);
    arr[L++] = (tmp &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;
    arr[L++] = tmp &amp; <span class="hljs-number">0xFF</span>;
  }

  <span class="hljs-keyword">return</span> arr
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">tripletToBase64</span> (num) {
  <span class="hljs-keyword">return</span> lookup[num &gt;&gt; <span class="hljs-number">18</span> &amp; <span class="hljs-number">0x3F</span>] + lookup[num &gt;&gt; <span class="hljs-number">12</span> &amp; <span class="hljs-number">0x3F</span>] + lookup[num &gt;&gt; <span class="hljs-number">6</span> &amp; <span class="hljs-number">0x3F</span>] + lookup[num &amp; <span class="hljs-number">0x3F</span>]
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">encodeChunk</span> (uint8, start, end) {
  <span class="hljs-keyword">var</span> tmp;
  <span class="hljs-keyword">var</span> output = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = start; i &lt; end; i += <span class="hljs-number">3</span>) {
    tmp = (uint8[i] &lt;&lt; <span class="hljs-number">16</span>) + (uint8[i + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) + (uint8[i + <span class="hljs-number">2</span>]);
    output.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">tripletToBase64</span>(tmp));
  }
  <span class="hljs-keyword">return</span> output.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">fromByteArray</span> (uint8) {
  <span class="hljs-keyword">if</span> (!inited) {
    <span class="hljs-title function_">init</span>();
  }
  <span class="hljs-keyword">var</span> tmp;
  <span class="hljs-keyword">var</span> len = uint8.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">var</span> extraBytes = len % <span class="hljs-number">3</span>; <span class="hljs-comment">// if we have 1 byte left, pad 2 bytes</span>
  <span class="hljs-keyword">var</span> output = <span class="hljs-string">&#x27;&#x27;</span>;
  <span class="hljs-keyword">var</span> parts = [];
  <span class="hljs-keyword">var</span> maxChunkLength = <span class="hljs-number">16383</span>; <span class="hljs-comment">// must be multiple of 3</span>

  <span class="hljs-comment">// go through the array every three bytes, we&#x27;ll deal with trailing stuff later</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len2 = len - extraBytes; i &lt; len2; i += maxChunkLength) {
    parts.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">encodeChunk</span>(uint8, i, (i + maxChunkLength) &gt; len2 ? len2 : (i + maxChunkLength)));
  }

  <span class="hljs-comment">// pad the end with zeros, but make sure to not forget the extra bytes</span>
  <span class="hljs-keyword">if</span> (extraBytes === <span class="hljs-number">1</span>) {
    tmp = uint8[len - <span class="hljs-number">1</span>];
    output += lookup[tmp &gt;&gt; <span class="hljs-number">2</span>];
    output += lookup[(tmp &lt;&lt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x3F</span>];
    output += <span class="hljs-string">&#x27;==&#x27;</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (extraBytes === <span class="hljs-number">2</span>) {
    tmp = (uint8[len - <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>) + (uint8[len - <span class="hljs-number">1</span>]);
    output += lookup[tmp &gt;&gt; <span class="hljs-number">10</span>];
    output += lookup[(tmp &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x3F</span>];
    output += lookup[(tmp &lt;&lt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x3F</span>];
    output += <span class="hljs-string">&#x27;=&#x27;</span>;
  }

  parts.<span class="hljs-title function_">push</span>(output);

  <span class="hljs-keyword">return</span> parts.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">read</span> (buffer, offset, isLE, mLen, nBytes) {
  <span class="hljs-keyword">var</span> e, m;
  <span class="hljs-keyword">var</span> eLen = nBytes * <span class="hljs-number">8</span> - mLen - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> eMax = (<span class="hljs-number">1</span> &lt;&lt; eLen) - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> eBias = eMax &gt;&gt; <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> nBits = -<span class="hljs-number">7</span>;
  <span class="hljs-keyword">var</span> i = isLE ? (nBytes - <span class="hljs-number">1</span>) : <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> d = isLE ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> s = buffer[offset + i];

  i += d;

  e = s &amp; ((<span class="hljs-number">1</span> &lt;&lt; (-nBits)) - <span class="hljs-number">1</span>);
  s &gt;&gt;= (-nBits);
  nBits += eLen;
  <span class="hljs-keyword">for</span> (; nBits &gt; <span class="hljs-number">0</span>; e = e * <span class="hljs-number">256</span> + buffer[offset + i], i += d, nBits -= <span class="hljs-number">8</span>) {}

  m = e &amp; ((<span class="hljs-number">1</span> &lt;&lt; (-nBits)) - <span class="hljs-number">1</span>);
  e &gt;&gt;= (-nBits);
  nBits += mLen;
  <span class="hljs-keyword">for</span> (; nBits &gt; <span class="hljs-number">0</span>; m = m * <span class="hljs-number">256</span> + buffer[offset + i], i += d, nBits -= <span class="hljs-number">8</span>) {}

  <span class="hljs-keyword">if</span> (e === <span class="hljs-number">0</span>) {
    e = <span class="hljs-number">1</span> - eBias;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e === eMax) {
    <span class="hljs-keyword">return</span> m ? <span class="hljs-title class_">NaN</span> : ((s ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span>) * <span class="hljs-title class_">Infinity</span>)
  } <span class="hljs-keyword">else</span> {
    m = m + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, mLen);
    e = e - eBias;
  }
  <span class="hljs-keyword">return</span> (s ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span>) * m * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, e - mLen)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">write</span> (buffer, value, offset, isLE, mLen, nBytes) {
  <span class="hljs-keyword">var</span> e, m, c;
  <span class="hljs-keyword">var</span> eLen = nBytes * <span class="hljs-number">8</span> - mLen - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> eMax = (<span class="hljs-number">1</span> &lt;&lt; eLen) - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> eBias = eMax &gt;&gt; <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> rt = (mLen === <span class="hljs-number">23</span> ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, -<span class="hljs-number">24</span>) - <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, -<span class="hljs-number">77</span>) : <span class="hljs-number">0</span>);
  <span class="hljs-keyword">var</span> i = isLE ? <span class="hljs-number">0</span> : (nBytes - <span class="hljs-number">1</span>);
  <span class="hljs-keyword">var</span> d = isLE ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> s = value &lt; <span class="hljs-number">0</span> || (value === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-number">1</span> / value &lt; <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;

  value = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(value);

  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(value) || value === <span class="hljs-title class_">Infinity</span>) {
    m = <span class="hljs-built_in">isNaN</span>(value) ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;
    e = eMax;
  } <span class="hljs-keyword">else</span> {
    e = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(value) / <span class="hljs-title class_">Math</span>.<span class="hljs-property">LN2</span>);
    <span class="hljs-keyword">if</span> (value * (c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, -e)) &lt; <span class="hljs-number">1</span>) {
      e--;
      c *= <span class="hljs-number">2</span>;
    }
    <span class="hljs-keyword">if</span> (e + eBias &gt;= <span class="hljs-number">1</span>) {
      value += rt / c;
    } <span class="hljs-keyword">else</span> {
      value += rt * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span> - eBias);
    }
    <span class="hljs-keyword">if</span> (value * c &gt;= <span class="hljs-number">2</span>) {
      e++;
      c /= <span class="hljs-number">2</span>;
    }

    <span class="hljs-keyword">if</span> (e + eBias &gt;= eMax) {
      m = <span class="hljs-number">0</span>;
      e = eMax;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e + eBias &gt;= <span class="hljs-number">1</span>) {
      m = (value * c - <span class="hljs-number">1</span>) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, mLen);
      e = e + eBias;
    } <span class="hljs-keyword">else</span> {
      m = value * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, eBias - <span class="hljs-number">1</span>) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, mLen);
      e = <span class="hljs-number">0</span>;
    }
  }

  <span class="hljs-keyword">for</span> (; mLen &gt;= <span class="hljs-number">8</span>; buffer[offset + i] = m &amp; <span class="hljs-number">0xff</span>, i += d, m /= <span class="hljs-number">256</span>, mLen -= <span class="hljs-number">8</span>) {}

  e = (e &lt;&lt; mLen) | m;
  eLen += mLen;
  <span class="hljs-keyword">for</span> (; eLen &gt; <span class="hljs-number">0</span>; buffer[offset + i] = e &amp; <span class="hljs-number">0xff</span>, i += d, e /= <span class="hljs-number">256</span>, eLen -= <span class="hljs-number">8</span>) {}

  buffer[offset + i - d] |= s * <span class="hljs-number">128</span>;
}

<span class="hljs-keyword">var</span> toString = {}.<span class="hljs-property">toString</span>;

<span class="hljs-keyword">var</span> isArray$1 = <span class="hljs-title class_">Array</span>.<span class="hljs-property">isArray</span> || <span class="hljs-keyword">function</span> (<span class="hljs-params">arr</span>) {
  <span class="hljs-keyword">return</span> toString.<span class="hljs-title function_">call</span>(arr) == <span class="hljs-string">&#x27;[object Array]&#x27;</span>;
};

<span class="hljs-comment">/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh &lt;feross@feross.org&gt; &lt;http://feross.org&gt;
 * @license  MIT
 */</span>
<span class="hljs-comment">/* eslint-disable no-proto */</span>


<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">INSPECT_MAX_BYTES</span> = <span class="hljs-number">50</span>;

<span class="hljs-comment">/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span> = <span class="hljs-variable language_">global</span>$1.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span> !== <span class="hljs-literal">undefined</span>
  ? <span class="hljs-variable language_">global</span>$1.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>
  : <span class="hljs-literal">true</span>;

<span class="hljs-comment">/*
 * Export kMaxLength after typed array support is determined.
 */</span>
<span class="hljs-title function_">kMaxLength</span>();

<span class="hljs-keyword">function</span> <span class="hljs-title function_">kMaxLength</span> () {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>
    ? <span class="hljs-number">0x7fffffff</span>
    : <span class="hljs-number">0x3fffffff</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createBuffer</span> (that, length) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">kMaxLength</span>() &lt; length) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Invalid typed array length&#x27;</span>)
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-comment">// Return an augmented `Uint8Array` instance, for best performance</span>
    that = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(length);
    that.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Fallback: Return an object instance of the Buffer class</span>
    <span class="hljs-keyword">if</span> (that === <span class="hljs-literal">null</span>) {
      that = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Buffer</span>(length);
    }
    that.<span class="hljs-property">length</span> = length;
  }

  <span class="hljs-keyword">return</span> that
}

<span class="hljs-comment">/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Buffer</span> (arg, encodingOrOffset, length) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span> &amp;&amp; !(<span class="hljs-variable language_">this</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Buffer</span>)) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Buffer</span>(arg, encodingOrOffset, length)
  }

  <span class="hljs-comment">// Common case.</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;number&#x27;</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> encodingOrOffset === <span class="hljs-string">&#x27;string&#x27;</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(
        <span class="hljs-string">&#x27;If encoding is specified then the first argument must be a string&#x27;</span>
      )
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">allocUnsafe</span>(<span class="hljs-variable language_">this</span>, arg)
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>, arg, encodingOrOffset, length)
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">poolSize</span> = <span class="hljs-number">8192</span>; <span class="hljs-comment">// not used by this implementation</span>

<span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Legacy, not needed anymore. Remove in next major version.</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">_augment</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">arr</span>) {
  arr.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
  <span class="hljs-keyword">return</span> arr
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">from</span> (that, value, encodingOrOffset, length) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&#x27;number&#x27;</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;&quot;value&quot; argument must not be a number&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">ArrayBuffer</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">ArrayBuffer</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fromArrayBuffer</span>(that, value, encodingOrOffset, length)
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&#x27;string&#x27;</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fromString</span>(that, value, encodingOrOffset)
  }

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fromObject</span>(that, value)
}

<span class="hljs-comment">/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">from</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">value, encodingOrOffset, length</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">from</span>(<span class="hljs-literal">null</span>, value, encodingOrOffset, length)
};

<span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
  <span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Uint8Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
  <span class="hljs-title class_">Buffer</span>.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Uint8Array</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Symbol</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-title class_">Symbol</span>.<span class="hljs-property">species</span> &amp;&amp;
      <span class="hljs-title class_">Buffer</span>[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">species</span>] === <span class="hljs-title class_">Buffer</span>) ;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">assertSize</span> (size) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> size !== <span class="hljs-string">&#x27;number&#x27;</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;&quot;size&quot; argument must be a number&#x27;</span>)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (size &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;&quot;size&quot; argument must not be negative&#x27;</span>)
  }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">alloc</span> (that, size, fill, encoding) {
  <span class="hljs-title function_">assertSize</span>(size);
  <span class="hljs-keyword">if</span> (size &lt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">createBuffer</span>(that, size)
  }
  <span class="hljs-keyword">if</span> (fill !== <span class="hljs-literal">undefined</span>) {
    <span class="hljs-comment">// Only pay attention to encoding if it&#x27;s a string. This</span>
    <span class="hljs-comment">// prevents accidentally sending in a number that would</span>
    <span class="hljs-comment">// be interpretted as a start offset.</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> encoding === <span class="hljs-string">&#x27;string&#x27;</span>
      ? <span class="hljs-title function_">createBuffer</span>(that, size).<span class="hljs-title function_">fill</span>(fill, encoding)
      : <span class="hljs-title function_">createBuffer</span>(that, size).<span class="hljs-title function_">fill</span>(fill)
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">createBuffer</span>(that, size)
}

<span class="hljs-comment">/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">alloc</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">size, fill, encoding</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">alloc</span>(<span class="hljs-literal">null</span>, size, fill, encoding)
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">allocUnsafe</span> (that, size) {
  <span class="hljs-title function_">assertSize</span>(size);
  that = <span class="hljs-title function_">createBuffer</span>(that, size &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : <span class="hljs-title function_">checked</span>(size) | <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; size; ++i) {
      that[i] = <span class="hljs-number">0</span>;
    }
  }
  <span class="hljs-keyword">return</span> that
}

<span class="hljs-comment">/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">allocUnsafe</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">size</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">allocUnsafe</span>(<span class="hljs-literal">null</span>, size)
};
<span class="hljs-comment">/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">allocUnsafeSlow</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">size</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">allocUnsafe</span>(<span class="hljs-literal">null</span>, size)
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">fromString</span> (that, string, encoding) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> encoding !== <span class="hljs-string">&#x27;string&#x27;</span> || encoding === <span class="hljs-string">&#x27;&#x27;</span>) {
    encoding = <span class="hljs-string">&#x27;utf8&#x27;</span>;
  }

  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">isEncoding</span>(encoding)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;&quot;encoding&quot; must be a valid string encoding&#x27;</span>)
  }

  <span class="hljs-keyword">var</span> length = <span class="hljs-title function_">byteLength</span>(string, encoding) | <span class="hljs-number">0</span>;
  that = <span class="hljs-title function_">createBuffer</span>(that, length);

  <span class="hljs-keyword">var</span> actual = that.<span class="hljs-title function_">write</span>(string, encoding);

  <span class="hljs-keyword">if</span> (actual !== length) {
    <span class="hljs-comment">// Writing a hex string, for example, that contains invalid characters will</span>
    <span class="hljs-comment">// cause everything after the first invalid character to be ignored. (e.g.</span>
    <span class="hljs-comment">// &#x27;abxxcd&#x27; will be treated as &#x27;ab&#x27;)</span>
    that = that.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, actual);
  }

  <span class="hljs-keyword">return</span> that
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">fromArrayLike</span> (that, array) {
  <span class="hljs-keyword">var</span> length = array.<span class="hljs-property">length</span> &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : <span class="hljs-title function_">checked</span>(array.<span class="hljs-property">length</span>) | <span class="hljs-number">0</span>;
  that = <span class="hljs-title function_">createBuffer</span>(that, length);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; i += <span class="hljs-number">1</span>) {
    that[i] = array[i] &amp; <span class="hljs-number">255</span>;
  }
  <span class="hljs-keyword">return</span> that
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">fromArrayBuffer</span> (that, array, byteOffset, length) {
  array.<span class="hljs-property">byteLength</span>; <span class="hljs-comment">// this throws if `array` is not a valid ArrayBuffer</span>

  <span class="hljs-keyword">if</span> (byteOffset &lt; <span class="hljs-number">0</span> || array.<span class="hljs-property">byteLength</span> &lt; byteOffset) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;\&#x27;offset\&#x27; is out of bounds&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (array.<span class="hljs-property">byteLength</span> &lt; byteOffset + (length || <span class="hljs-number">0</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;\&#x27;length\&#x27; is out of bounds&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (byteOffset === <span class="hljs-literal">undefined</span> &amp;&amp; length === <span class="hljs-literal">undefined</span>) {
    array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(array);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span>) {
    array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(array, byteOffset);
  } <span class="hljs-keyword">else</span> {
    array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(array, byteOffset, length);
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-comment">// Return an augmented `Uint8Array` instance, for best performance</span>
    that = array;
    that.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Fallback: Return an object instance of the Buffer class</span>
    that = <span class="hljs-title function_">fromArrayLike</span>(that, array);
  }
  <span class="hljs-keyword">return</span> that
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">fromObject</span> (that, obj) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">internalIsBuffer</span>(obj)) {
    <span class="hljs-keyword">var</span> len = <span class="hljs-title function_">checked</span>(obj.<span class="hljs-property">length</span>) | <span class="hljs-number">0</span>;
    that = <span class="hljs-title function_">createBuffer</span>(that, len);

    <span class="hljs-keyword">if</span> (that.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> that
    }

    obj.<span class="hljs-title function_">copy</span>(that, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, len);
    <span class="hljs-keyword">return</span> that
  }

  <span class="hljs-keyword">if</span> (obj) {
    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">ArrayBuffer</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp;
        obj.<span class="hljs-property">buffer</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">ArrayBuffer</span>) || <span class="hljs-string">&#x27;length&#x27;</span> <span class="hljs-keyword">in</span> obj) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj.<span class="hljs-property">length</span> !== <span class="hljs-string">&#x27;number&#x27;</span> || <span class="hljs-title function_">isnan</span>(obj.<span class="hljs-property">length</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">createBuffer</span>(that, <span class="hljs-number">0</span>)
      }
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">fromArrayLike</span>(that, obj)
    }

    <span class="hljs-keyword">if</span> (obj.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;Buffer&#x27;</span> &amp;&amp; <span class="hljs-title function_">isArray$1</span>(obj.<span class="hljs-property">data</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">fromArrayLike</span>(that, obj.<span class="hljs-property">data</span>)
    }
  }

  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.&#x27;</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">checked</span> (length) {
  <span class="hljs-comment">// Note: cannot use `length &lt; kMaxLength()` here because that fails when</span>
  <span class="hljs-comment">// length is NaN (which is otherwise coerced to zero.)</span>
  <span class="hljs-keyword">if</span> (length &gt;= <span class="hljs-title function_">kMaxLength</span>()) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Attempt to allocate Buffer larger than maximum &#x27;</span> +
                         <span class="hljs-string">&#x27;size: 0x&#x27;</span> + <span class="hljs-title function_">kMaxLength</span>().<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>) + <span class="hljs-string">&#x27; bytes&#x27;</span>)
  }
  <span class="hljs-keyword">return</span> length | <span class="hljs-number">0</span>
}
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">isBuffer</span> = isBuffer$1;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">internalIsBuffer</span> (b) {
  <span class="hljs-keyword">return</span> !!(b != <span class="hljs-literal">null</span> &amp;&amp; b.<span class="hljs-property">_isBuffer</span>)
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">compare</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">compare</span> (a, b) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">internalIsBuffer</span>(a) || !<span class="hljs-title function_">internalIsBuffer</span>(b)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Arguments must be Buffers&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (a === b) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

  <span class="hljs-keyword">var</span> x = a.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">var</span> y = b.<span class="hljs-property">length</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(x, y); i &lt; len; ++i) {
    <span class="hljs-keyword">if</span> (a[i] !== b[i]) {
      x = a[i];
      y = b[i];
      <span class="hljs-keyword">break</span>
    }
  }

  <span class="hljs-keyword">if</span> (x &lt; y) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
  <span class="hljs-keyword">if</span> (y &lt; x) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">isEncoding</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">isEncoding</span> (encoding) {
  <span class="hljs-keyword">switch</span> (<span class="hljs-title class_">String</span>(encoding).<span class="hljs-title function_">toLowerCase</span>()) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hex&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf8&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf-8&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ascii&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;latin1&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;binary&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;base64&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ucs2&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ucs-2&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf16le&#x27;</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf-16le&#x27;</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">concat</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">concat</span> (list, length) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isArray$1</span>(list)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;&quot;list&quot; argument must be an Array of Buffers&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (list.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">0</span>)
  }

  <span class="hljs-keyword">var</span> i;
  <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span>) {
    length = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; list.<span class="hljs-property">length</span>; ++i) {
      length += list[i].<span class="hljs-property">length</span>;
    }
  }

  <span class="hljs-keyword">var</span> buffer = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">allocUnsafe</span>(length);
  <span class="hljs-keyword">var</span> pos = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; list.<span class="hljs-property">length</span>; ++i) {
    <span class="hljs-keyword">var</span> buf = list[i];
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">internalIsBuffer</span>(buf)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;&quot;list&quot; argument must be an Array of Buffers&#x27;</span>)
    }
    buf.<span class="hljs-title function_">copy</span>(buffer, pos);
    pos += buf.<span class="hljs-property">length</span>;
  }
  <span class="hljs-keyword">return</span> buffer
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">byteLength</span> (string, encoding) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">internalIsBuffer</span>(string)) {
    <span class="hljs-keyword">return</span> string.<span class="hljs-property">length</span>
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">ArrayBuffer</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">ArrayBuffer</span>.<span class="hljs-property">isView</span> === <span class="hljs-string">&#x27;function&#x27;</span> &amp;&amp;
      (<span class="hljs-title class_">ArrayBuffer</span>.<span class="hljs-title function_">isView</span>(string) || string <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">ArrayBuffer</span>)) {
    <span class="hljs-keyword">return</span> string.<span class="hljs-property">byteLength</span>
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> string !== <span class="hljs-string">&#x27;string&#x27;</span>) {
    string = <span class="hljs-string">&#x27;&#x27;</span> + string;
  }

  <span class="hljs-keyword">var</span> len = string.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (len === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

  <span class="hljs-comment">// Use a for loop to avoid recursion</span>
  <span class="hljs-keyword">var</span> loweredCase = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">for</span> (;;) {
    <span class="hljs-keyword">switch</span> (encoding) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ascii&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;latin1&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;binary&#x27;</span>:
        <span class="hljs-keyword">return</span> len
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf8&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf-8&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-attr">undefined</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">utf8ToBytes</span>(string).<span class="hljs-property">length</span>
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ucs2&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ucs-2&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf16le&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf-16le&#x27;</span>:
        <span class="hljs-keyword">return</span> len * <span class="hljs-number">2</span>
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hex&#x27;</span>:
        <span class="hljs-keyword">return</span> len &gt;&gt;&gt; <span class="hljs-number">1</span>
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;base64&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">base64ToBytes</span>(string).<span class="hljs-property">length</span>
      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">if</span> (loweredCase) <span class="hljs-keyword">return</span> <span class="hljs-title function_">utf8ToBytes</span>(string).<span class="hljs-property">length</span> <span class="hljs-comment">// assume utf8</span>
        encoding = (<span class="hljs-string">&#x27;&#x27;</span> + encoding).<span class="hljs-title function_">toLowerCase</span>();
        loweredCase = <span class="hljs-literal">true</span>;
    }
  }
}
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">byteLength</span> = byteLength;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">slowToString</span> (encoding, start, end) {
  <span class="hljs-keyword">var</span> loweredCase = <span class="hljs-literal">false</span>;

  <span class="hljs-comment">// No need to verify that &quot;this.length &lt;= MAX_UINT32&quot; since it&#x27;s a read-only</span>
  <span class="hljs-comment">// property of a typed array.</span>

  <span class="hljs-comment">// This behaves neither like String nor Uint8Array in that we set start/end</span>
  <span class="hljs-comment">// to their upper/lower bounds if the value passed is out of range.</span>
  <span class="hljs-comment">// undefined is handled specially as per ECMA-262 6th Edition,</span>
  <span class="hljs-comment">// Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.</span>
  <span class="hljs-keyword">if</span> (start === <span class="hljs-literal">undefined</span> || start &lt; <span class="hljs-number">0</span>) {
    start = <span class="hljs-number">0</span>;
  }
  <span class="hljs-comment">// Return early if start &gt; this.length. Done here to prevent potential uint32</span>
  <span class="hljs-comment">// coercion fail below.</span>
  <span class="hljs-keyword">if</span> (start &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>
  }

  <span class="hljs-keyword">if</span> (end === <span class="hljs-literal">undefined</span> || end &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>) {
    end = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
  }

  <span class="hljs-keyword">if</span> (end &lt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>
  }

  <span class="hljs-comment">// Force coersion to uint32. This will also coerce falsey/NaN values to 0.</span>
  end &gt;&gt;&gt;= <span class="hljs-number">0</span>;
  start &gt;&gt;&gt;= <span class="hljs-number">0</span>;

  <span class="hljs-keyword">if</span> (end &lt;= start) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>
  }

  <span class="hljs-keyword">if</span> (!encoding) encoding = <span class="hljs-string">&#x27;utf8&#x27;</span>;

  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">switch</span> (encoding) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hex&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">hexSlice</span>(<span class="hljs-variable language_">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf8&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf-8&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">utf8Slice</span>(<span class="hljs-variable language_">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ascii&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">asciiSlice</span>(<span class="hljs-variable language_">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;latin1&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;binary&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">latin1Slice</span>(<span class="hljs-variable language_">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;base64&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">base64Slice</span>(<span class="hljs-variable language_">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ucs2&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ucs-2&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf16le&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf-16le&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">utf16leSlice</span>(<span class="hljs-variable language_">this</span>, start, end)

      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">if</span> (loweredCase) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Unknown encoding: &#x27;</span> + encoding)
        encoding = (encoding + <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-title function_">toLowerCase</span>();
        loweredCase = <span class="hljs-literal">true</span>;
    }
  }
}

<span class="hljs-comment">// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect</span>
<span class="hljs-comment">// Buffer instances.</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">_isBuffer</span> = <span class="hljs-literal">true</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">swap</span> (b, n, m) {
  <span class="hljs-keyword">var</span> i = b[n];
  b[n] = b[m];
  b[m] = i;
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">swap16</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">swap16</span> () {
  <span class="hljs-keyword">var</span> len = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (len % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Buffer size must be a multiple of 16-bits&#x27;</span>)
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i += <span class="hljs-number">2</span>) {
    <span class="hljs-title function_">swap</span>(<span class="hljs-variable language_">this</span>, i, i + <span class="hljs-number">1</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">swap32</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">swap32</span> () {
  <span class="hljs-keyword">var</span> len = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (len % <span class="hljs-number">4</span> !== <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Buffer size must be a multiple of 32-bits&#x27;</span>)
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i += <span class="hljs-number">4</span>) {
    <span class="hljs-title function_">swap</span>(<span class="hljs-variable language_">this</span>, i, i + <span class="hljs-number">3</span>);
    <span class="hljs-title function_">swap</span>(<span class="hljs-variable language_">this</span>, i + <span class="hljs-number">1</span>, i + <span class="hljs-number">2</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">swap64</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">swap64</span> () {
  <span class="hljs-keyword">var</span> len = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (len % <span class="hljs-number">8</span> !== <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Buffer size must be a multiple of 64-bits&#x27;</span>)
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i += <span class="hljs-number">8</span>) {
    <span class="hljs-title function_">swap</span>(<span class="hljs-variable language_">this</span>, i, i + <span class="hljs-number">7</span>);
    <span class="hljs-title function_">swap</span>(<span class="hljs-variable language_">this</span>, i + <span class="hljs-number">1</span>, i + <span class="hljs-number">6</span>);
    <span class="hljs-title function_">swap</span>(<span class="hljs-variable language_">this</span>, i + <span class="hljs-number">2</span>, i + <span class="hljs-number">5</span>);
    <span class="hljs-title function_">swap</span>(<span class="hljs-variable language_">this</span>, i + <span class="hljs-number">3</span>, i + <span class="hljs-number">4</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">toString</span> () {
  <span class="hljs-keyword">var</span> length = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-title function_">utf8Slice</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-number">0</span>, length)
  <span class="hljs-keyword">return</span> slowToString.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">equals</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">equals</span> (b) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">internalIsBuffer</span>(b)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Argument must be a Buffer&#x27;</span>)
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span> === b) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">compare</span>(<span class="hljs-variable language_">this</span>, b) === <span class="hljs-number">0</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">inspect</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">inspect</span> () {
  <span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;&#x27;</span>;
  <span class="hljs-keyword">var</span> max = <span class="hljs-variable constant_">INSPECT_MAX_BYTES</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    str = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>, <span class="hljs-number">0</span>, max).<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/.{2}/g</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27; &#x27;</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> &gt; max) str += <span class="hljs-string">&#x27; ... &#x27;</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;Buffer &#x27;</span> + str + <span class="hljs-string">&#x27;&gt;&#x27;</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">compare</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">compare</span> (target, start, end, thisStart, thisEnd) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">internalIsBuffer</span>(target)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Argument must be a Buffer&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (start === <span class="hljs-literal">undefined</span>) {
    start = <span class="hljs-number">0</span>;
  }
  <span class="hljs-keyword">if</span> (end === <span class="hljs-literal">undefined</span>) {
    end = target ? target.<span class="hljs-property">length</span> : <span class="hljs-number">0</span>;
  }
  <span class="hljs-keyword">if</span> (thisStart === <span class="hljs-literal">undefined</span>) {
    thisStart = <span class="hljs-number">0</span>;
  }
  <span class="hljs-keyword">if</span> (thisEnd === <span class="hljs-literal">undefined</span>) {
    thisEnd = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
  }

  <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span> || end &gt; target.<span class="hljs-property">length</span> || thisStart &lt; <span class="hljs-number">0</span> || thisEnd &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;out of range index&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (thisStart &gt;= thisEnd &amp;&amp; start &gt;= end) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
  }
  <span class="hljs-keyword">if</span> (thisStart &gt;= thisEnd) {
    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
  }
  <span class="hljs-keyword">if</span> (start &gt;= end) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
  }

  start &gt;&gt;&gt;= <span class="hljs-number">0</span>;
  end &gt;&gt;&gt;= <span class="hljs-number">0</span>;
  thisStart &gt;&gt;&gt;= <span class="hljs-number">0</span>;
  thisEnd &gt;&gt;&gt;= <span class="hljs-number">0</span>;

  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span> === target) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

  <span class="hljs-keyword">var</span> x = thisEnd - thisStart;
  <span class="hljs-keyword">var</span> y = end - start;
  <span class="hljs-keyword">var</span> len = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(x, y);

  <span class="hljs-keyword">var</span> thisCopy = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">slice</span>(thisStart, thisEnd);
  <span class="hljs-keyword">var</span> targetCopy = target.<span class="hljs-title function_">slice</span>(start, end);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; ++i) {
    <span class="hljs-keyword">if</span> (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i];
      y = targetCopy[i];
      <span class="hljs-keyword">break</span>
    }
  }

  <span class="hljs-keyword">if</span> (x &lt; y) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
  <span class="hljs-keyword">if</span> (y &lt; x) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
};

<span class="hljs-comment">// Finds either the first index of `val` in `buffer` at offset &gt;= `byteOffset`,</span>
<span class="hljs-comment">// OR the last index of `val` in `buffer` at offset &lt;= `byteOffset`.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// Arguments:</span>
<span class="hljs-comment">// - buffer - a Buffer to search</span>
<span class="hljs-comment">// - val - a string, Buffer, or number</span>
<span class="hljs-comment">// - byteOffset - an index into `buffer`; will be clamped to an int32</span>
<span class="hljs-comment">// - encoding - an optional encoding, relevant is val is a string</span>
<span class="hljs-comment">// - dir - true for indexOf, false for lastIndexOf</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">bidirectionalIndexOf</span> (buffer, val, byteOffset, encoding, dir) {
  <span class="hljs-comment">// Empty buffer means no match</span>
  <span class="hljs-keyword">if</span> (buffer.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>

  <span class="hljs-comment">// Normalize byteOffset</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> byteOffset === <span class="hljs-string">&#x27;string&#x27;</span>) {
    encoding = byteOffset;
    byteOffset = <span class="hljs-number">0</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (byteOffset &gt; <span class="hljs-number">0x7fffffff</span>) {
    byteOffset = <span class="hljs-number">0x7fffffff</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (byteOffset &lt; -<span class="hljs-number">0x80000000</span>) {
    byteOffset = -<span class="hljs-number">0x80000000</span>;
  }
  byteOffset = +byteOffset;  <span class="hljs-comment">// Coerce to Number.</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(byteOffset)) {
    <span class="hljs-comment">// byteOffset: it it&#x27;s undefined, null, NaN, &quot;foo&quot;, etc, search whole buffer</span>
    byteOffset = dir ? <span class="hljs-number">0</span> : (buffer.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>);
  }

  <span class="hljs-comment">// Normalize byteOffset: negative offsets start from the end of the buffer</span>
  <span class="hljs-keyword">if</span> (byteOffset &lt; <span class="hljs-number">0</span>) byteOffset = buffer.<span class="hljs-property">length</span> + byteOffset;
  <span class="hljs-keyword">if</span> (byteOffset &gt;= buffer.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">if</span> (dir) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
    <span class="hljs-keyword">else</span> byteOffset = buffer.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (byteOffset &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (dir) byteOffset = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
  }

  <span class="hljs-comment">// Normalize val</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;string&#x27;</span>) {
    val = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(val, encoding);
  }

  <span class="hljs-comment">// Finally, search either indexOf (if dir is true) or lastIndexOf</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">internalIsBuffer</span>(val)) {
    <span class="hljs-comment">// Special case: looking for empty string/buffer always fails</span>
    <span class="hljs-keyword">if</span> (val.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">arrayIndexOf</span>(buffer, val, byteOffset, encoding, dir)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;number&#x27;</span>) {
    val = val &amp; <span class="hljs-number">0xFF</span>; <span class="hljs-comment">// Search for a byte value [0-255]</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span> &amp;&amp;
        <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Uint8Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">indexOf</span> === <span class="hljs-string">&#x27;function&#x27;</span>) {
      <span class="hljs-keyword">if</span> (dir) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Uint8Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">indexOf</span>.<span class="hljs-title function_">call</span>(buffer, val, byteOffset)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Uint8Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">lastIndexOf</span>.<span class="hljs-title function_">call</span>(buffer, val, byteOffset)
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">arrayIndexOf</span>(buffer, [ val ], byteOffset, encoding, dir)
  }

  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;val must be string, number or Buffer&#x27;</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">arrayIndexOf</span> (arr, val, byteOffset, encoding, dir) {
  <span class="hljs-keyword">var</span> indexSize = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> arrLength = arr.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">var</span> valLength = val.<span class="hljs-property">length</span>;

  <span class="hljs-keyword">if</span> (encoding !== <span class="hljs-literal">undefined</span>) {
    encoding = <span class="hljs-title class_">String</span>(encoding).<span class="hljs-title function_">toLowerCase</span>();
    <span class="hljs-keyword">if</span> (encoding === <span class="hljs-string">&#x27;ucs2&#x27;</span> || encoding === <span class="hljs-string">&#x27;ucs-2&#x27;</span> ||
        encoding === <span class="hljs-string">&#x27;utf16le&#x27;</span> || encoding === <span class="hljs-string">&#x27;utf-16le&#x27;</span>) {
      <span class="hljs-keyword">if</span> (arr.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span> || val.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) {
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
      }
      indexSize = <span class="hljs-number">2</span>;
      arrLength /= <span class="hljs-number">2</span>;
      valLength /= <span class="hljs-number">2</span>;
      byteOffset /= <span class="hljs-number">2</span>;
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">read</span> (buf, i) {
    <span class="hljs-keyword">if</span> (indexSize === <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> buf[i]
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> buf.<span class="hljs-title function_">readUInt16BE</span>(i * indexSize)
    }
  }

  <span class="hljs-keyword">var</span> i;
  <span class="hljs-keyword">if</span> (dir) {
    <span class="hljs-keyword">var</span> foundIndex = -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (i = byteOffset; i &lt; arrLength; i++) {
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">read</span>(arr, i) === <span class="hljs-title function_">read</span>(val, foundIndex === -<span class="hljs-number">1</span> ? <span class="hljs-number">0</span> : i - foundIndex)) {
        <span class="hljs-keyword">if</span> (foundIndex === -<span class="hljs-number">1</span>) foundIndex = i;
        <span class="hljs-keyword">if</span> (i - foundIndex + <span class="hljs-number">1</span> === valLength) <span class="hljs-keyword">return</span> foundIndex * indexSize
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (foundIndex !== -<span class="hljs-number">1</span>) i -= i - foundIndex;
        foundIndex = -<span class="hljs-number">1</span>;
      }
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (byteOffset + valLength &gt; arrLength) byteOffset = arrLength - valLength;
    <span class="hljs-keyword">for</span> (i = byteOffset; i &gt;= <span class="hljs-number">0</span>; i--) {
      <span class="hljs-keyword">var</span> found = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; valLength; j++) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">read</span>(arr, i + j) !== <span class="hljs-title function_">read</span>(val, j)) {
          found = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">break</span>
        }
      }
      <span class="hljs-keyword">if</span> (found) <span class="hljs-keyword">return</span> i
    }
  }

  <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">includes</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">includes</span> (val, byteOffset, encoding) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">indexOf</span>(val, byteOffset, encoding) !== -<span class="hljs-number">1</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">indexOf</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">indexOf</span> (val, byteOffset, encoding) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">bidirectionalIndexOf</span>(<span class="hljs-variable language_">this</span>, val, byteOffset, encoding, <span class="hljs-literal">true</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">lastIndexOf</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">lastIndexOf</span> (val, byteOffset, encoding) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">bidirectionalIndexOf</span>(<span class="hljs-variable language_">this</span>, val, byteOffset, encoding, <span class="hljs-literal">false</span>)
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">hexWrite</span> (buf, string, offset, length) {
  offset = <span class="hljs-title class_">Number</span>(offset) || <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> remaining = buf.<span class="hljs-property">length</span> - offset;
  <span class="hljs-keyword">if</span> (!length) {
    length = remaining;
  } <span class="hljs-keyword">else</span> {
    length = <span class="hljs-title class_">Number</span>(length);
    <span class="hljs-keyword">if</span> (length &gt; remaining) {
      length = remaining;
    }
  }

  <span class="hljs-comment">// must be an even number of digits</span>
  <span class="hljs-keyword">var</span> strLen = string.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (strLen % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Invalid hex string&#x27;</span>)

  <span class="hljs-keyword">if</span> (length &gt; strLen / <span class="hljs-number">2</span>) {
    length = strLen / <span class="hljs-number">2</span>;
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) {
    <span class="hljs-keyword">var</span> parsed = <span class="hljs-built_in">parseInt</span>(string.<span class="hljs-title function_">substr</span>(i * <span class="hljs-number">2</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(parsed)) <span class="hljs-keyword">return</span> i
    buf[offset + i] = parsed;
  }
  <span class="hljs-keyword">return</span> i
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">utf8Write</span> (buf, string, offset, length) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">blitBuffer</span>(<span class="hljs-title function_">utf8ToBytes</span>(string, buf.<span class="hljs-property">length</span> - offset), buf, offset, length)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">asciiWrite</span> (buf, string, offset, length) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">blitBuffer</span>(<span class="hljs-title function_">asciiToBytes</span>(string), buf, offset, length)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">latin1Write</span> (buf, string, offset, length) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">asciiWrite</span>(buf, string, offset, length)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">base64Write</span> (buf, string, offset, length) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">blitBuffer</span>(<span class="hljs-title function_">base64ToBytes</span>(string), buf, offset, length)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">ucs2Write</span> (buf, string, offset, length) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">blitBuffer</span>(<span class="hljs-title function_">utf16leToBytes</span>(string, buf.<span class="hljs-property">length</span> - offset), buf, offset, length)
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">write</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">write</span> (string, offset, length, encoding) {
  <span class="hljs-comment">// Buffer#write(string)</span>
  <span class="hljs-keyword">if</span> (offset === <span class="hljs-literal">undefined</span>) {
    encoding = <span class="hljs-string">&#x27;utf8&#x27;</span>;
    length = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
    offset = <span class="hljs-number">0</span>;
  <span class="hljs-comment">// Buffer#write(string, encoding)</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> offset === <span class="hljs-string">&#x27;string&#x27;</span>) {
    encoding = offset;
    length = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
    offset = <span class="hljs-number">0</span>;
  <span class="hljs-comment">// Buffer#write(string, offset[, length][, encoding])</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isFinite</span>(offset)) {
    offset = offset | <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isFinite</span>(length)) {
      length = length | <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (encoding === <span class="hljs-literal">undefined</span>) encoding = <span class="hljs-string">&#x27;utf8&#x27;</span>;
    } <span class="hljs-keyword">else</span> {
      encoding = length;
      length = <span class="hljs-literal">undefined</span>;
    }
  <span class="hljs-comment">// legacy write(string, encoding, offset, length) - remove in v0.13</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(
      <span class="hljs-string">&#x27;Buffer.write(string, encoding, offset[, length]) is no longer supported&#x27;</span>
    )
  }

  <span class="hljs-keyword">var</span> remaining = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> - offset;
  <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span> || length &gt; remaining) length = remaining;

  <span class="hljs-keyword">if</span> ((string.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; (length &lt; <span class="hljs-number">0</span> || offset &lt; <span class="hljs-number">0</span>)) || offset &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Attempt to write outside buffer bounds&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (!encoding) encoding = <span class="hljs-string">&#x27;utf8&#x27;</span>;

  <span class="hljs-keyword">var</span> loweredCase = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">for</span> (;;) {
    <span class="hljs-keyword">switch</span> (encoding) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hex&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">hexWrite</span>(<span class="hljs-variable language_">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf8&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf-8&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">utf8Write</span>(<span class="hljs-variable language_">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ascii&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">asciiWrite</span>(<span class="hljs-variable language_">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;latin1&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;binary&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">latin1Write</span>(<span class="hljs-variable language_">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;base64&#x27;</span>:
        <span class="hljs-comment">// Warning: maxLength not taken into account in base64Write</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">base64Write</span>(<span class="hljs-variable language_">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ucs2&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ucs-2&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf16le&#x27;</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;utf-16le&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">ucs2Write</span>(<span class="hljs-variable language_">this</span>, string, offset, length)

      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">if</span> (loweredCase) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Unknown encoding: &#x27;</span> + encoding)
        encoding = (<span class="hljs-string">&#x27;&#x27;</span> + encoding).<span class="hljs-title function_">toLowerCase</span>();
        loweredCase = <span class="hljs-literal">true</span>;
    }
  }
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toJSON</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">toJSON</span> () {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;Buffer&#x27;</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_arr</span> || <span class="hljs-variable language_">this</span>, <span class="hljs-number">0</span>)
  }
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">base64Slice</span> (buf, start, end) {
  <span class="hljs-keyword">if</span> (start === <span class="hljs-number">0</span> &amp;&amp; end === buf.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fromByteArray</span>(buf)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fromByteArray</span>(buf.<span class="hljs-title function_">slice</span>(start, end))
  }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">utf8Slice</span> (buf, start, end) {
  end = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(buf.<span class="hljs-property">length</span>, end);
  <span class="hljs-keyword">var</span> res = [];

  <span class="hljs-keyword">var</span> i = start;
  <span class="hljs-keyword">while</span> (i &lt; end) {
    <span class="hljs-keyword">var</span> firstByte = buf[i];
    <span class="hljs-keyword">var</span> codePoint = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> bytesPerSequence = (firstByte &gt; <span class="hljs-number">0xEF</span>) ? <span class="hljs-number">4</span>
      : (firstByte &gt; <span class="hljs-number">0xDF</span>) ? <span class="hljs-number">3</span>
      : (firstByte &gt; <span class="hljs-number">0xBF</span>) ? <span class="hljs-number">2</span>
      : <span class="hljs-number">1</span>;

    <span class="hljs-keyword">if</span> (i + bytesPerSequence &lt;= end) {
      <span class="hljs-keyword">var</span> secondByte, thirdByte, fourthByte, tempCodePoint;

      <span class="hljs-keyword">switch</span> (bytesPerSequence) {
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
          <span class="hljs-keyword">if</span> (firstByte &lt; <span class="hljs-number">0x80</span>) {
            codePoint = firstByte;
          }
          <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
          secondByte = buf[i + <span class="hljs-number">1</span>];
          <span class="hljs-keyword">if</span> ((secondByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span>) {
            tempCodePoint = (firstByte &amp; <span class="hljs-number">0x1F</span>) &lt;&lt; <span class="hljs-number">0x6</span> | (secondByte &amp; <span class="hljs-number">0x3F</span>);
            <span class="hljs-keyword">if</span> (tempCodePoint &gt; <span class="hljs-number">0x7F</span>) {
              codePoint = tempCodePoint;
            }
          }
          <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
          secondByte = buf[i + <span class="hljs-number">1</span>];
          thirdByte = buf[i + <span class="hljs-number">2</span>];
          <span class="hljs-keyword">if</span> ((secondByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span> &amp;&amp; (thirdByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span>) {
            tempCodePoint = (firstByte &amp; <span class="hljs-number">0xF</span>) &lt;&lt; <span class="hljs-number">0xC</span> | (secondByte &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">0x6</span> | (thirdByte &amp; <span class="hljs-number">0x3F</span>);
            <span class="hljs-keyword">if</span> (tempCodePoint &gt; <span class="hljs-number">0x7FF</span> &amp;&amp; (tempCodePoint &lt; <span class="hljs-number">0xD800</span> || tempCodePoint &gt; <span class="hljs-number">0xDFFF</span>)) {
              codePoint = tempCodePoint;
            }
          }
          <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
          secondByte = buf[i + <span class="hljs-number">1</span>];
          thirdByte = buf[i + <span class="hljs-number">2</span>];
          fourthByte = buf[i + <span class="hljs-number">3</span>];
          <span class="hljs-keyword">if</span> ((secondByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span> &amp;&amp; (thirdByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span> &amp;&amp; (fourthByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span>) {
            tempCodePoint = (firstByte &amp; <span class="hljs-number">0xF</span>) &lt;&lt; <span class="hljs-number">0x12</span> | (secondByte &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">0xC</span> | (thirdByte &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">0x6</span> | (fourthByte &amp; <span class="hljs-number">0x3F</span>);
            <span class="hljs-keyword">if</span> (tempCodePoint &gt; <span class="hljs-number">0xFFFF</span> &amp;&amp; tempCodePoint &lt; <span class="hljs-number">0x110000</span>) {
              codePoint = tempCodePoint;
            }
          }
      }
    }

    <span class="hljs-keyword">if</span> (codePoint === <span class="hljs-literal">null</span>) {
      <span class="hljs-comment">// we did not generate a valid codePoint so insert a</span>
      <span class="hljs-comment">// replacement char (U+FFFD) and advance only 1 byte</span>
      codePoint = <span class="hljs-number">0xFFFD</span>;
      bytesPerSequence = <span class="hljs-number">1</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codePoint &gt; <span class="hljs-number">0xFFFF</span>) {
      <span class="hljs-comment">// encode to utf16 (surrogate pair dance)</span>
      codePoint -= <span class="hljs-number">0x10000</span>;
      res.<span class="hljs-title function_">push</span>(codePoint &gt;&gt;&gt; <span class="hljs-number">10</span> &amp; <span class="hljs-number">0x3FF</span> | <span class="hljs-number">0xD800</span>);
      codePoint = <span class="hljs-number">0xDC00</span> | codePoint &amp; <span class="hljs-number">0x3FF</span>;
    }

    res.<span class="hljs-title function_">push</span>(codePoint);
    i += bytesPerSequence;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">decodeCodePointsArray</span>(res)
}

<span class="hljs-comment">// Based on http://stackoverflow.com/a/22747272/680742, the browser with</span>
<span class="hljs-comment">// the lowest limit is Chrome, with 0x10000 args.</span>
<span class="hljs-comment">// We go 1 magnitude less, for safety</span>
<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">MAX_ARGUMENTS_LENGTH</span> = <span class="hljs-number">0x1000</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">decodeCodePointsArray</span> (codePoints) {
  <span class="hljs-keyword">var</span> len = codePoints.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (len &lt;= <span class="hljs-variable constant_">MAX_ARGUMENTS_LENGTH</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>.<span class="hljs-property">fromCharCode</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-title class_">String</span>, codePoints) <span class="hljs-comment">// avoid extra slice()</span>
  }

  <span class="hljs-comment">// Decode in chunks to avoid &quot;call stack size exceeded&quot;.</span>
  <span class="hljs-keyword">var</span> res = <span class="hljs-string">&#x27;&#x27;</span>;
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (i &lt; len) {
    res += <span class="hljs-title class_">String</span>.<span class="hljs-property">fromCharCode</span>.<span class="hljs-title function_">apply</span>(
      <span class="hljs-title class_">String</span>,
      codePoints.<span class="hljs-title function_">slice</span>(i, i += <span class="hljs-variable constant_">MAX_ARGUMENTS_LENGTH</span>)
    );
  }
  <span class="hljs-keyword">return</span> res
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">asciiSlice</span> (buf, start, end) {
  <span class="hljs-keyword">var</span> ret = <span class="hljs-string">&#x27;&#x27;</span>;
  end = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(buf.<span class="hljs-property">length</span>, end);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = start; i &lt; end; ++i) {
    ret += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(buf[i] &amp; <span class="hljs-number">0x7F</span>);
  }
  <span class="hljs-keyword">return</span> ret
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">latin1Slice</span> (buf, start, end) {
  <span class="hljs-keyword">var</span> ret = <span class="hljs-string">&#x27;&#x27;</span>;
  end = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(buf.<span class="hljs-property">length</span>, end);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = start; i &lt; end; ++i) {
    ret += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(buf[i]);
  }
  <span class="hljs-keyword">return</span> ret
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">hexSlice</span> (buf, start, end) {
  <span class="hljs-keyword">var</span> len = buf.<span class="hljs-property">length</span>;

  <span class="hljs-keyword">if</span> (!start || start &lt; <span class="hljs-number">0</span>) start = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!end || end &lt; <span class="hljs-number">0</span> || end &gt; len) end = len;

  <span class="hljs-keyword">var</span> out = <span class="hljs-string">&#x27;&#x27;</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = start; i &lt; end; ++i) {
    out += <span class="hljs-title function_">toHex</span>(buf[i]);
  }
  <span class="hljs-keyword">return</span> out
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">utf16leSlice</span> (buf, start, end) {
  <span class="hljs-keyword">var</span> bytes = buf.<span class="hljs-title function_">slice</span>(start, end);
  <span class="hljs-keyword">var</span> res = <span class="hljs-string">&#x27;&#x27;</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; bytes.<span class="hljs-property">length</span>; i += <span class="hljs-number">2</span>) {
    res += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(bytes[i] + bytes[i + <span class="hljs-number">1</span>] * <span class="hljs-number">256</span>);
  }
  <span class="hljs-keyword">return</span> res
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">slice</span> (start, end) {
  <span class="hljs-keyword">var</span> len = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
  start = ~~start;
  end = end === <span class="hljs-literal">undefined</span> ? len : ~~end;

  <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span>) {
    start += len;
    <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span>) start = <span class="hljs-number">0</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (start &gt; len) {
    start = len;
  }

  <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) {
    end += len;
    <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) end = <span class="hljs-number">0</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (end &gt; len) {
    end = len;
  }

  <span class="hljs-keyword">if</span> (end &lt; start) end = start;

  <span class="hljs-keyword">var</span> newBuf;
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    newBuf = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">subarray</span>(start, end);
    newBuf.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> sliceLen = end - start;
    newBuf = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Buffer</span>(sliceLen, <span class="hljs-literal">undefined</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; sliceLen; ++i) {
      newBuf[i] = <span class="hljs-variable language_">this</span>[i + start];
    }
  }

  <span class="hljs-keyword">return</span> newBuf
};

<span class="hljs-comment">/*
 * Need to make sure that buffer isn&#x27;t trying to write out of bounds.
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">checkOffset</span> (offset, ext, length) {
  <span class="hljs-keyword">if</span> ((offset % <span class="hljs-number">1</span>) !== <span class="hljs-number">0</span> || offset &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;offset is not uint&#x27;</span>)
  <span class="hljs-keyword">if</span> (offset + ext &gt; length) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Trying to access beyond buffer length&#x27;</span>)
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readUIntLE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readUIntLE</span> (offset, byteLength, noAssert) {
  offset = offset | <span class="hljs-number">0</span>;
  byteLength = byteLength | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, byteLength, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);

  <span class="hljs-keyword">var</span> val = <span class="hljs-variable language_">this</span>[offset];
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (++i &lt; byteLength &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    val += <span class="hljs-variable language_">this</span>[offset + i] * mul;
  }

  <span class="hljs-keyword">return</span> val
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readUIntBE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readUIntBE</span> (offset, byteLength, noAssert) {
  offset = offset | <span class="hljs-number">0</span>;
  byteLength = byteLength | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-title function_">checkOffset</span>(offset, byteLength, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  }

  <span class="hljs-keyword">var</span> val = <span class="hljs-variable language_">this</span>[offset + --byteLength];
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">while</span> (byteLength &gt; <span class="hljs-number">0</span> &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    val += <span class="hljs-variable language_">this</span>[offset + --byteLength] * mul;
  }

  <span class="hljs-keyword">return</span> val
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readUInt8</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readUInt8</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[offset]
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readUInt16LE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readUInt16LE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[offset] | (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readUInt16BE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readUInt16BE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">this</span>[offset] &lt;&lt; <span class="hljs-number">8</span>) | <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>]
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readUInt32LE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readUInt32LE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">4</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);

  <span class="hljs-keyword">return</span> ((<span class="hljs-variable language_">this</span>[offset]) |
      (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |
      (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>)) +
      (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">3</span>] * <span class="hljs-number">0x1000000</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readUInt32BE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readUInt32BE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">4</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);

  <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">this</span>[offset] * <span class="hljs-number">0x1000000</span>) +
    ((<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">16</span>) |
    (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>) |
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">3</span>])
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readIntLE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readIntLE</span> (offset, byteLength, noAssert) {
  offset = offset | <span class="hljs-number">0</span>;
  byteLength = byteLength | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, byteLength, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);

  <span class="hljs-keyword">var</span> val = <span class="hljs-variable language_">this</span>[offset];
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (++i &lt; byteLength &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    val += <span class="hljs-variable language_">this</span>[offset + i] * mul;
  }
  mul *= <span class="hljs-number">0x80</span>;

  <span class="hljs-keyword">if</span> (val &gt;= mul) val -= <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength);

  <span class="hljs-keyword">return</span> val
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readIntBE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readIntBE</span> (offset, byteLength, noAssert) {
  offset = offset | <span class="hljs-number">0</span>;
  byteLength = byteLength | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, byteLength, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);

  <span class="hljs-keyword">var</span> i = byteLength;
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> val = <span class="hljs-variable language_">this</span>[offset + --i];
  <span class="hljs-keyword">while</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    val += <span class="hljs-variable language_">this</span>[offset + --i] * mul;
  }
  mul *= <span class="hljs-number">0x80</span>;

  <span class="hljs-keyword">if</span> (val &gt;= mul) val -= <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength);

  <span class="hljs-keyword">return</span> val
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readInt8</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readInt8</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">if</span> (!(<span class="hljs-variable language_">this</span>[offset] &amp; <span class="hljs-number">0x80</span>)) <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">this</span>[offset])
  <span class="hljs-keyword">return</span> ((<span class="hljs-number">0xff</span> - <span class="hljs-variable language_">this</span>[offset] + <span class="hljs-number">1</span>) * -<span class="hljs-number">1</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readInt16LE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readInt16LE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">var</span> val = <span class="hljs-variable language_">this</span>[offset] | (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>);
  <span class="hljs-keyword">return</span> (val &amp; <span class="hljs-number">0x8000</span>) ? val | <span class="hljs-number">0xFFFF0000</span> : val
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readInt16BE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readInt16BE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">var</span> val = <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] | (<span class="hljs-variable language_">this</span>[offset] &lt;&lt; <span class="hljs-number">8</span>);
  <span class="hljs-keyword">return</span> (val &amp; <span class="hljs-number">0x8000</span>) ? val | <span class="hljs-number">0xFFFF0000</span> : val
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readInt32LE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readInt32LE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">4</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);

  <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">this</span>[offset]) |
    (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |
    (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |
    (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readInt32BE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readInt32BE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">4</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);

  <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">this</span>[offset] &lt;&lt; <span class="hljs-number">24</span>) |
    (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">16</span>) |
    (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>) |
    (<span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">3</span>])
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readFloatLE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readFloatLE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">4</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">read</span>(<span class="hljs-variable language_">this</span>, offset, <span class="hljs-literal">true</span>, <span class="hljs-number">23</span>, <span class="hljs-number">4</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readFloatBE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readFloatBE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">4</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">read</span>(<span class="hljs-variable language_">this</span>, offset, <span class="hljs-literal">false</span>, <span class="hljs-number">23</span>, <span class="hljs-number">4</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readDoubleLE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readDoubleLE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">8</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">read</span>(<span class="hljs-variable language_">this</span>, offset, <span class="hljs-literal">true</span>, <span class="hljs-number">52</span>, <span class="hljs-number">8</span>)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">readDoubleBE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">readDoubleBE</span> (offset, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkOffset</span>(offset, <span class="hljs-number">8</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">read</span>(<span class="hljs-variable language_">this</span>, offset, <span class="hljs-literal">false</span>, <span class="hljs-number">52</span>, <span class="hljs-number">8</span>)
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">checkInt</span> (buf, value, offset, ext, max, min) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">internalIsBuffer</span>(buf)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;&quot;buffer&quot; argument must be a Buffer instance&#x27;</span>)
  <span class="hljs-keyword">if</span> (value &gt; max || value &lt; min) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;&quot;value&quot; argument is out of bounds&#x27;</span>)
  <span class="hljs-keyword">if</span> (offset + ext &gt; buf.<span class="hljs-property">length</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Index out of range&#x27;</span>)
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeUIntLE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeUIntLE</span> (value, offset, byteLength, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  byteLength = byteLength | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-keyword">var</span> maxBytes = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength) - <span class="hljs-number">1</span>;
    <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, byteLength, maxBytes, <span class="hljs-number">0</span>);
  }

  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
  <span class="hljs-variable language_">this</span>[offset] = value &amp; <span class="hljs-number">0xFF</span>;
  <span class="hljs-keyword">while</span> (++i &lt; byteLength &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    <span class="hljs-variable language_">this</span>[offset + i] = (value / mul) &amp; <span class="hljs-number">0xFF</span>;
  }

  <span class="hljs-keyword">return</span> offset + byteLength
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeUIntBE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeUIntBE</span> (value, offset, byteLength, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  byteLength = byteLength | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-keyword">var</span> maxBytes = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength) - <span class="hljs-number">1</span>;
    <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, byteLength, maxBytes, <span class="hljs-number">0</span>);
  }

  <span class="hljs-keyword">var</span> i = byteLength - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>;
  <span class="hljs-variable language_">this</span>[offset + i] = value &amp; <span class="hljs-number">0xFF</span>;
  <span class="hljs-keyword">while</span> (--i &gt;= <span class="hljs-number">0</span> &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    <span class="hljs-variable language_">this</span>[offset + i] = (value / mul) &amp; <span class="hljs-number">0xFF</span>;
  }

  <span class="hljs-keyword">return</span> offset + byteLength
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeUInt8</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeUInt8</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">1</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) value = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(value);
  <span class="hljs-variable language_">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>);
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">1</span>
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">objectWriteUInt16</span> (buf, value, offset, littleEndian) {
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) value = <span class="hljs-number">0xffff</span> + value + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(buf.<span class="hljs-property">length</span> - offset, <span class="hljs-number">2</span>); i &lt; j; ++i) {
    buf[offset + i] = (value &amp; (<span class="hljs-number">0xff</span> &lt;&lt; (<span class="hljs-number">8</span> * (littleEndian ? i : <span class="hljs-number">1</span> - i)))) &gt;&gt;&gt;
      (littleEndian ? i : <span class="hljs-number">1</span> - i) * <span class="hljs-number">8</span>;
  }
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeUInt16LE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeUInt16LE</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">2</span>, <span class="hljs-number">0xffff</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-variable language_">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">objectWriteUInt16</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">true</span>);
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">2</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeUInt16BE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeUInt16BE</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">2</span>, <span class="hljs-number">0xffff</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-variable language_">this</span>[offset] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] = (value &amp; <span class="hljs-number">0xff</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">objectWriteUInt16</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">false</span>);
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">2</span>
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">objectWriteUInt32</span> (buf, value, offset, littleEndian) {
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) value = <span class="hljs-number">0xffffffff</span> + value + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(buf.<span class="hljs-property">length</span> - offset, <span class="hljs-number">4</span>); i &lt; j; ++i) {
    buf[offset + i] = (value &gt;&gt;&gt; (littleEndian ? i : <span class="hljs-number">3</span> - i) * <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>;
  }
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeUInt32LE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeUInt32LE</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">0xffffffff</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">3</span>] = (value &gt;&gt;&gt; <span class="hljs-number">24</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">2</span>] = (value &gt;&gt;&gt; <span class="hljs-number">16</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>);
    <span class="hljs-variable language_">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">objectWriteUInt32</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">true</span>);
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeUInt32BE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeUInt32BE</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">0xffffffff</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-variable language_">this</span>[offset] = (value &gt;&gt;&gt; <span class="hljs-number">24</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">16</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">2</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">3</span>] = (value &amp; <span class="hljs-number">0xff</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">objectWriteUInt32</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">false</span>);
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeIntLE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeIntLE</span> (value, offset, byteLength, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-keyword">var</span> limit = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength - <span class="hljs-number">1</span>);

    <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, byteLength, limit - <span class="hljs-number">1</span>, -limit);
  }

  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> sub = <span class="hljs-number">0</span>;
  <span class="hljs-variable language_">this</span>[offset] = value &amp; <span class="hljs-number">0xFF</span>;
  <span class="hljs-keyword">while</span> (++i &lt; byteLength &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span> &amp;&amp; sub === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>[offset + i - <span class="hljs-number">1</span>] !== <span class="hljs-number">0</span>) {
      sub = <span class="hljs-number">1</span>;
    }
    <span class="hljs-variable language_">this</span>[offset + i] = ((value / mul) &gt;&gt; <span class="hljs-number">0</span>) - sub &amp; <span class="hljs-number">0xFF</span>;
  }

  <span class="hljs-keyword">return</span> offset + byteLength
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeIntBE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeIntBE</span> (value, offset, byteLength, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-keyword">var</span> limit = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength - <span class="hljs-number">1</span>);

    <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, byteLength, limit - <span class="hljs-number">1</span>, -limit);
  }

  <span class="hljs-keyword">var</span> i = byteLength - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> sub = <span class="hljs-number">0</span>;
  <span class="hljs-variable language_">this</span>[offset + i] = value &amp; <span class="hljs-number">0xFF</span>;
  <span class="hljs-keyword">while</span> (--i &gt;= <span class="hljs-number">0</span> &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span> &amp;&amp; sub === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>[offset + i + <span class="hljs-number">1</span>] !== <span class="hljs-number">0</span>) {
      sub = <span class="hljs-number">1</span>;
    }
    <span class="hljs-variable language_">this</span>[offset + i] = ((value / mul) &gt;&gt; <span class="hljs-number">0</span>) - sub &amp; <span class="hljs-number">0xFF</span>;
  }

  <span class="hljs-keyword">return</span> offset + byteLength
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeInt8</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeInt8</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">1</span>, <span class="hljs-number">0x7f</span>, -<span class="hljs-number">0x80</span>);
  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) value = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(value);
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) value = <span class="hljs-number">0xff</span> + value + <span class="hljs-number">1</span>;
  <span class="hljs-variable language_">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>);
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">1</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeInt16LE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeInt16LE</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">2</span>, <span class="hljs-number">0x7fff</span>, -<span class="hljs-number">0x8000</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-variable language_">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">objectWriteUInt16</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">true</span>);
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">2</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeInt16BE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeInt16BE</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">2</span>, <span class="hljs-number">0x7fff</span>, -<span class="hljs-number">0x8000</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-variable language_">this</span>[offset] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] = (value &amp; <span class="hljs-number">0xff</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">objectWriteUInt16</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">false</span>);
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">2</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeInt32LE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeInt32LE</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">0x7fffffff</span>, -<span class="hljs-number">0x80000000</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-variable language_">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">2</span>] = (value &gt;&gt;&gt; <span class="hljs-number">16</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">3</span>] = (value &gt;&gt;&gt; <span class="hljs-number">24</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">objectWriteUInt32</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">true</span>);
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeInt32BE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeInt32BE</span> (value, offset, noAssert) {
  value = +value;
  offset = offset | <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!noAssert) <span class="hljs-title function_">checkInt</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">0x7fffffff</span>, -<span class="hljs-number">0x80000000</span>);
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) value = <span class="hljs-number">0xffffffff</span> + value + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-variable language_">this</span>[offset] = (value &gt;&gt;&gt; <span class="hljs-number">24</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">16</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">2</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>);
    <span class="hljs-variable language_">this</span>[offset + <span class="hljs-number">3</span>] = (value &amp; <span class="hljs-number">0xff</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">objectWriteUInt32</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">false</span>);
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">checkIEEE754</span> (buf, value, offset, ext, max, min) {
  <span class="hljs-keyword">if</span> (offset + ext &gt; buf.<span class="hljs-property">length</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Index out of range&#x27;</span>)
  <span class="hljs-keyword">if</span> (offset &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Index out of range&#x27;</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">writeFloat</span> (buf, value, offset, littleEndian, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-title function_">checkIEEE754</span>(buf, value, offset, <span class="hljs-number">4</span>);
  }
  <span class="hljs-title function_">write</span>(buf, value, offset, littleEndian, <span class="hljs-number">23</span>, <span class="hljs-number">4</span>);
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeFloatLE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeFloatLE</span> (value, offset, noAssert) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">writeFloat</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">true</span>, noAssert)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeFloatBE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeFloatBE</span> (value, offset, noAssert) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">writeFloat</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">false</span>, noAssert)
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">writeDouble</span> (buf, value, offset, littleEndian, noAssert) {
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-title function_">checkIEEE754</span>(buf, value, offset, <span class="hljs-number">8</span>);
  }
  <span class="hljs-title function_">write</span>(buf, value, offset, littleEndian, <span class="hljs-number">52</span>, <span class="hljs-number">8</span>);
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">8</span>
}

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeDoubleLE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeDoubleLE</span> (value, offset, noAssert) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">writeDouble</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">true</span>, noAssert)
};

<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">writeDoubleBE</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">writeDoubleBE</span> (value, offset, noAssert) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">writeDouble</span>(<span class="hljs-variable language_">this</span>, value, offset, <span class="hljs-literal">false</span>, noAssert)
};

<span class="hljs-comment">// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">copy</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">copy</span> (target, targetStart, start, end) {
  <span class="hljs-keyword">if</span> (!start) start = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!end &amp;&amp; end !== <span class="hljs-number">0</span>) end = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (targetStart &gt;= target.<span class="hljs-property">length</span>) targetStart = target.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (!targetStart) targetStart = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (end &gt; <span class="hljs-number">0</span> &amp;&amp; end &lt; start) end = start;

  <span class="hljs-comment">// Copy 0 bytes; we&#x27;re done</span>
  <span class="hljs-keyword">if</span> (end === start) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (target.<span class="hljs-property">length</span> === <span class="hljs-number">0</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

  <span class="hljs-comment">// Fatal error conditions</span>
  <span class="hljs-keyword">if</span> (targetStart &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;targetStart out of bounds&#x27;</span>)
  }
  <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span> || start &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;sourceStart out of bounds&#x27;</span>)
  <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;sourceEnd out of bounds&#x27;</span>)

  <span class="hljs-comment">// Are we oob?</span>
  <span class="hljs-keyword">if</span> (end &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>) end = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">if</span> (target.<span class="hljs-property">length</span> - targetStart &lt; end - start) {
    end = target.<span class="hljs-property">length</span> - targetStart + start;
  }

  <span class="hljs-keyword">var</span> len = end - start;
  <span class="hljs-keyword">var</span> i;

  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span> === target &amp;&amp; start &lt; targetStart &amp;&amp; targetStart &lt; end) {
    <span class="hljs-comment">// descending copy from end</span>
    <span class="hljs-keyword">for</span> (i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; --i) {
      target[i + targetStart] = <span class="hljs-variable language_">this</span>[i + start];
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">1000</span> || !<span class="hljs-title class_">Buffer</span>.<span class="hljs-property">TYPED_ARRAY_SUPPORT</span>) {
    <span class="hljs-comment">// ascending copy from start</span>
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; ++i) {
      target[i + targetStart] = <span class="hljs-variable language_">this</span>[i + start];
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title class_">Uint8Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">set</span>.<span class="hljs-title function_">call</span>(
      target,
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">subarray</span>(start, start + len),
      targetStart
    );
  }

  <span class="hljs-keyword">return</span> len
};

<span class="hljs-comment">// Usage:</span>
<span class="hljs-comment">//    buffer.fill(number[, offset[, end]])</span>
<span class="hljs-comment">//    buffer.fill(buffer[, offset[, end]])</span>
<span class="hljs-comment">//    buffer.fill(string[, offset[, end]][, encoding])</span>
<span class="hljs-title class_">Buffer</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">fill</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">fill</span> (val, start, end, encoding) {
  <span class="hljs-comment">// Handle string cases:</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;string&#x27;</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> start === <span class="hljs-string">&#x27;string&#x27;</span>) {
      encoding = start;
      start = <span class="hljs-number">0</span>;
      end = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> end === <span class="hljs-string">&#x27;string&#x27;</span>) {
      encoding = end;
      end = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;
    }
    <span class="hljs-keyword">if</span> (val.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">var</span> code = val.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>);
      <span class="hljs-keyword">if</span> (code &lt; <span class="hljs-number">256</span>) {
        val = code;
      }
    }
    <span class="hljs-keyword">if</span> (encoding !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> encoding !== <span class="hljs-string">&#x27;string&#x27;</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;encoding must be a string&#x27;</span>)
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> encoding === <span class="hljs-string">&#x27;string&#x27;</span> &amp;&amp; !<span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">isEncoding</span>(encoding)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Unknown encoding: &#x27;</span> + encoding)
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;number&#x27;</span>) {
    val = val &amp; <span class="hljs-number">255</span>;
  }

  <span class="hljs-comment">// Invalid ranges are not set to a default, so can range check early.</span>
  <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> &lt; start || <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> &lt; end) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&#x27;Out of range index&#x27;</span>)
  }

  <span class="hljs-keyword">if</span> (end &lt;= start) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>
  }

  start = start &gt;&gt;&gt; <span class="hljs-number">0</span>;
  end = end === <span class="hljs-literal">undefined</span> ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> : end &gt;&gt;&gt; <span class="hljs-number">0</span>;

  <span class="hljs-keyword">if</span> (!val) val = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">var</span> i;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;number&#x27;</span>) {
    <span class="hljs-keyword">for</span> (i = start; i &lt; end; ++i) {
      <span class="hljs-variable language_">this</span>[i] = val;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> bytes = <span class="hljs-title function_">internalIsBuffer</span>(val)
      ? val
      : <span class="hljs-title function_">utf8ToBytes</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Buffer</span>(val, encoding).<span class="hljs-title function_">toString</span>());
    <span class="hljs-keyword">var</span> len = bytes.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; end - start; ++i) {
      <span class="hljs-variable language_">this</span>[i + start] = bytes[i % len];
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>
};

<span class="hljs-comment">// HELPER FUNCTIONS</span>
<span class="hljs-comment">// ================</span>

<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">INVALID_BASE64_RE</span> = <span class="hljs-regexp">/[^+\/0-9A-Za-z-_]/g</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">base64clean</span> (str) {
  <span class="hljs-comment">// Node strips out invalid characters like \n and \t from the string, base64-js does not</span>
  str = <span class="hljs-title function_">stringtrim</span>(str).<span class="hljs-title function_">replace</span>(<span class="hljs-variable constant_">INVALID_BASE64_RE</span>, <span class="hljs-string">&#x27;&#x27;</span>);
  <span class="hljs-comment">// Node converts strings with length &lt; 2 to &#x27;&#x27;</span>
  <span class="hljs-keyword">if</span> (str.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>
  <span class="hljs-comment">// Node allows for non-padded base64 strings (missing trailing ===), base64-js does not</span>
  <span class="hljs-keyword">while</span> (str.<span class="hljs-property">length</span> % <span class="hljs-number">4</span> !== <span class="hljs-number">0</span>) {
    str = str + <span class="hljs-string">&#x27;=&#x27;</span>;
  }
  <span class="hljs-keyword">return</span> str
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">stringtrim</span> (str) {
  <span class="hljs-keyword">if</span> (str.<span class="hljs-property">trim</span>) <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">trim</span>()
  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^\s+|\s+$/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">toHex</span> (n) {
  <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">16</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0&#x27;</span> + n.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)
  <span class="hljs-keyword">return</span> n.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">utf8ToBytes</span> (string, units) {
  units = units || <span class="hljs-title class_">Infinity</span>;
  <span class="hljs-keyword">var</span> codePoint;
  <span class="hljs-keyword">var</span> length = string.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">var</span> leadSurrogate = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">var</span> bytes = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) {
    codePoint = string.<span class="hljs-title function_">charCodeAt</span>(i);

    <span class="hljs-comment">// is surrogate component</span>
    <span class="hljs-keyword">if</span> (codePoint &gt; <span class="hljs-number">0xD7FF</span> &amp;&amp; codePoint &lt; <span class="hljs-number">0xE000</span>) {
      <span class="hljs-comment">// last char was a lead</span>
      <span class="hljs-keyword">if</span> (!leadSurrogate) {
        <span class="hljs-comment">// no lead yet</span>
        <span class="hljs-keyword">if</span> (codePoint &gt; <span class="hljs-number">0xDBFF</span>) {
          <span class="hljs-comment">// unexpected trail</span>
          <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &gt; -<span class="hljs-number">1</span>) bytes.<span class="hljs-title function_">push</span>(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBD</span>);
          <span class="hljs-keyword">continue</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> === length) {
          <span class="hljs-comment">// unpaired lead</span>
          <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &gt; -<span class="hljs-number">1</span>) bytes.<span class="hljs-title function_">push</span>(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBD</span>);
          <span class="hljs-keyword">continue</span>
        }

        <span class="hljs-comment">// valid lead</span>
        leadSurrogate = codePoint;

        <span class="hljs-keyword">continue</span>
      }

      <span class="hljs-comment">// 2 leads in a row</span>
      <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0xDC00</span>) {
        <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &gt; -<span class="hljs-number">1</span>) bytes.<span class="hljs-title function_">push</span>(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBD</span>);
        leadSurrogate = codePoint;
        <span class="hljs-keyword">continue</span>
      }

      <span class="hljs-comment">// valid surrogate pair</span>
      codePoint = (leadSurrogate - <span class="hljs-number">0xD800</span> &lt;&lt; <span class="hljs-number">10</span> | codePoint - <span class="hljs-number">0xDC00</span>) + <span class="hljs-number">0x10000</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (leadSurrogate) {
      <span class="hljs-comment">// valid bmp char, but last char was a lead</span>
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &gt; -<span class="hljs-number">1</span>) bytes.<span class="hljs-title function_">push</span>(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBD</span>);
    }

    leadSurrogate = <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// encode utf8</span>
    <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0x80</span>) {
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">1</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
      bytes.<span class="hljs-title function_">push</span>(codePoint);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0x800</span>) {
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">2</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
      bytes.<span class="hljs-title function_">push</span>(
        codePoint &gt;&gt; <span class="hljs-number">0x6</span> | <span class="hljs-number">0xC0</span>,
        codePoint &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>
      );
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0x10000</span>) {
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
      bytes.<span class="hljs-title function_">push</span>(
        codePoint &gt;&gt; <span class="hljs-number">0xC</span> | <span class="hljs-number">0xE0</span>,
        codePoint &gt;&gt; <span class="hljs-number">0x6</span> &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>,
        codePoint &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>
      );
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0x110000</span>) {
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">4</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
      bytes.<span class="hljs-title function_">push</span>(
        codePoint &gt;&gt; <span class="hljs-number">0x12</span> | <span class="hljs-number">0xF0</span>,
        codePoint &gt;&gt; <span class="hljs-number">0xC</span> &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>,
        codePoint &gt;&gt; <span class="hljs-number">0x6</span> &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>,
        codePoint &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>
      );
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Invalid code point&#x27;</span>)
    }
  }

  <span class="hljs-keyword">return</span> bytes
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">asciiToBytes</span> (str) {
  <span class="hljs-keyword">var</span> byteArray = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-property">length</span>; ++i) {
    <span class="hljs-comment">// Node&#x27;s code seems to be doing this and not &amp; 0x7F..</span>
    byteArray.<span class="hljs-title function_">push</span>(str.<span class="hljs-title function_">charCodeAt</span>(i) &amp; <span class="hljs-number">0xFF</span>);
  }
  <span class="hljs-keyword">return</span> byteArray
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">utf16leToBytes</span> (str, units) {
  <span class="hljs-keyword">var</span> c, hi, lo;
  <span class="hljs-keyword">var</span> byteArray = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-property">length</span>; ++i) {
    <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">2</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>

    c = str.<span class="hljs-title function_">charCodeAt</span>(i);
    hi = c &gt;&gt; <span class="hljs-number">8</span>;
    lo = c % <span class="hljs-number">256</span>;
    byteArray.<span class="hljs-title function_">push</span>(lo);
    byteArray.<span class="hljs-title function_">push</span>(hi);
  }

  <span class="hljs-keyword">return</span> byteArray
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">base64ToBytes</span> (str) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">toByteArray</span>(<span class="hljs-title function_">base64clean</span>(str))
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">blitBuffer</span> (src, dst, offset, length) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) {
    <span class="hljs-keyword">if</span> ((i + offset &gt;= dst.<span class="hljs-property">length</span>) || (i &gt;= src.<span class="hljs-property">length</span>)) <span class="hljs-keyword">break</span>
    dst[i + offset] = src[i];
  }
  <span class="hljs-keyword">return</span> i
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isnan</span> (val) {
  <span class="hljs-keyword">return</span> val !== val <span class="hljs-comment">// eslint-disable-line no-self-compare</span>
}


<span class="hljs-comment">// the following is from is-buffer, also by Feross Aboukhadijeh and with same lisence</span>
<span class="hljs-comment">// The _isBuffer check is for Safari 5-7 support, because it&#x27;s missing</span>
<span class="hljs-comment">// Object.prototype.constructor. Remove this eventually</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isBuffer$1</span>(<span class="hljs-params">obj</span>) {
  <span class="hljs-keyword">return</span> obj != <span class="hljs-literal">null</span> &amp;&amp; (!!obj.<span class="hljs-property">_isBuffer</span> || <span class="hljs-title function_">isFastBuffer</span>(obj) || <span class="hljs-title function_">isSlowBuffer</span>(obj))
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isFastBuffer</span> (obj) {
  <span class="hljs-keyword">return</span> !!obj.<span class="hljs-property">constructor</span> &amp;&amp; <span class="hljs-keyword">typeof</span> obj.<span class="hljs-property">constructor</span>.<span class="hljs-property">isBuffer</span> === <span class="hljs-string">&#x27;function&#x27;</span> &amp;&amp; obj.<span class="hljs-property">constructor</span>.<span class="hljs-title function_">isBuffer</span>(obj)
}

<span class="hljs-comment">// For Node v0.10 support. Remove this eventually.</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isSlowBuffer</span> (obj) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> obj.<span class="hljs-property">readFloatLE</span> === <span class="hljs-string">&#x27;function&#x27;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> obj.<span class="hljs-property">slice</span> === <span class="hljs-string">&#x27;function&#x27;</span> &amp;&amp; <span class="hljs-title function_">isFastBuffer</span>(obj.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
}

<span class="hljs-keyword">var</span> inherits;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property">create</span> === <span class="hljs-string">&#x27;function&#x27;</span>){
  inherits = <span class="hljs-keyword">function</span> <span class="hljs-title function_">inherits</span>(<span class="hljs-params">ctor, superCtor</span>) {
    <span class="hljs-comment">// implementation from standard node.js &#x27;util&#x27; module</span>
    ctor.<span class="hljs-property">super_</span> = superCtor;
    ctor.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(superCtor.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, {
      <span class="hljs-attr">constructor</span>: {
        <span class="hljs-attr">value</span>: ctor,
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>
      }
    });
  };
} <span class="hljs-keyword">else</span> {
  inherits = <span class="hljs-keyword">function</span> <span class="hljs-title function_">inherits</span>(<span class="hljs-params">ctor, superCtor</span>) {
    ctor.<span class="hljs-property">super_</span> = superCtor;
    <span class="hljs-keyword">var</span> <span class="hljs-title class_">TempCtor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {};
    <span class="hljs-title class_">TempCtor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = superCtor.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    ctor.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TempCtor</span>();
    ctor.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = ctor;
  };
}
<span class="hljs-keyword">var</span> inherits$1 = inherits;

<span class="hljs-keyword">var</span> getOwnPropertyDescriptors = <span class="hljs-title class_">Object</span>.<span class="hljs-property">getOwnPropertyDescriptors</span> ||
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">getOwnPropertyDescriptors</span>(<span class="hljs-params">obj</span>) {
    <span class="hljs-keyword">var</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj);
    <span class="hljs-keyword">var</span> descriptors = {};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      descriptors[keys[i]] = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyDescriptor</span>(obj, keys[i]);
    }
    <span class="hljs-keyword">return</span> descriptors;
  };

<span class="hljs-keyword">var</span> formatRegExp = <span class="hljs-regexp">/%[sdj%]/g</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">format</span>(<span class="hljs-params">f</span>) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isString</span>(f)) {
    <span class="hljs-keyword">var</span> objects = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) {
      objects.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">inspect</span>(<span class="hljs-variable language_">arguments</span>[i]));
    }
    <span class="hljs-keyword">return</span> objects.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27; &#x27;</span>);
  }

  <span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> args = <span class="hljs-variable language_">arguments</span>;
  <span class="hljs-keyword">var</span> len = args.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">var</span> str = <span class="hljs-title class_">String</span>(f).<span class="hljs-title function_">replace</span>(formatRegExp, <span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) {
    <span class="hljs-keyword">if</span> (x === <span class="hljs-string">&#x27;%%&#x27;</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;%&#x27;</span>;
    <span class="hljs-keyword">if</span> (i &gt;= len) <span class="hljs-keyword">return</span> x;
    <span class="hljs-keyword">switch</span> (x) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;%s&#x27;</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>(args[i++]);
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;%d&#x27;</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">Number</span>(args[i++]);
      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;%j&#x27;</span>:
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(args[i++]);
        } <span class="hljs-keyword">catch</span> (_) {
          <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;[Circular]&#x27;</span>;
        }
      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">return</span> x;
    }
  });
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = args[i]; i &lt; len; x = args[++i]) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isNull</span>(x) || !<span class="hljs-title function_">isObject</span>(x)) {
      str += <span class="hljs-string">&#x27; &#x27;</span> + x;
    } <span class="hljs-keyword">else</span> {
      str += <span class="hljs-string">&#x27; &#x27;</span> + <span class="hljs-title function_">inspect</span>(x);
    }
  }
  <span class="hljs-keyword">return</span> str;
}

<span class="hljs-comment">// Mark that a method should not be used.</span>
<span class="hljs-comment">// Returns a modified function which warns once by default.</span>
<span class="hljs-comment">// If --no-deprecation is set, then it is a no-op.</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">deprecate</span>(<span class="hljs-params">fn, msg</span>) {
  <span class="hljs-comment">// Allow for deprecating things in the process of starting up.</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUndefined</span>(<span class="hljs-variable language_">global</span>$1.<span class="hljs-property">process</span>)) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">deprecate</span>(fn, msg).<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>);
    };
  }

  <span class="hljs-keyword">if</span> (browser$1$1.<span class="hljs-property">noDeprecation</span> === <span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">return</span> fn;
  }

  <span class="hljs-keyword">var</span> warned = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">deprecated</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (!warned) {
      <span class="hljs-keyword">if</span> (browser$1$1.<span class="hljs-property">throwDeprecation</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(msg);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (browser$1$1.<span class="hljs-property">traceDeprecation</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">trace</span>(msg);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(msg);
      }
      warned = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>);
  }

  <span class="hljs-keyword">return</span> deprecated;
}

<span class="hljs-keyword">var</span> debugs = {};
<span class="hljs-keyword">var</span> debugEnviron;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">debuglog</span>(<span class="hljs-params">set</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUndefined</span>(debugEnviron))
    debugEnviron = browser$1$1.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_DEBUG</span> || <span class="hljs-string">&#x27;&#x27;</span>;
  set = set.<span class="hljs-title function_">toUpperCase</span>();
  <span class="hljs-keyword">if</span> (!debugs[set]) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;\\b&#x27;</span> + set + <span class="hljs-string">&#x27;\\b&#x27;</span>, <span class="hljs-string">&#x27;i&#x27;</span>).<span class="hljs-title function_">test</span>(debugEnviron)) {
      <span class="hljs-keyword">var</span> pid = <span class="hljs-number">0</span>;
      debugs[set] = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-keyword">var</span> msg = format.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, <span class="hljs-variable language_">arguments</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;%s %d: %s&#x27;</span>, set, pid, msg);
      };
    } <span class="hljs-keyword">else</span> {
      debugs[set] = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {};
    }
  }
  <span class="hljs-keyword">return</span> debugs[set];
}

<span class="hljs-comment">/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} obj The object to print out.
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} opts Optional options object that alters the output.
 */</span>
<span class="hljs-comment">/* legacy: obj, showHidden, depth, colors*/</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">inspect</span>(<span class="hljs-params">obj, opts</span>) {
  <span class="hljs-comment">// default options</span>
  <span class="hljs-keyword">var</span> ctx = {
    <span class="hljs-attr">seen</span>: [],
    <span class="hljs-attr">stylize</span>: stylizeNoColor
  };
  <span class="hljs-comment">// legacy...</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-number">3</span>) ctx.<span class="hljs-property">depth</span> = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">2</span>];
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-number">4</span>) ctx.<span class="hljs-property">colors</span> = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">3</span>];
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isBoolean</span>(opts)) {
    <span class="hljs-comment">// legacy...</span>
    ctx.<span class="hljs-property">showHidden</span> = opts;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (opts) {
    <span class="hljs-comment">// got an &quot;options&quot; object</span>
    <span class="hljs-title function_">_extend</span>(ctx, opts);
  }
  <span class="hljs-comment">// set default options</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUndefined</span>(ctx.<span class="hljs-property">showHidden</span>)) ctx.<span class="hljs-property">showHidden</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUndefined</span>(ctx.<span class="hljs-property">depth</span>)) ctx.<span class="hljs-property">depth</span> = <span class="hljs-number">2</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUndefined</span>(ctx.<span class="hljs-property">colors</span>)) ctx.<span class="hljs-property">colors</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUndefined</span>(ctx.<span class="hljs-property">customInspect</span>)) ctx.<span class="hljs-property">customInspect</span> = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">colors</span>) ctx.<span class="hljs-property">stylize</span> = stylizeWithColor;
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatValue</span>(ctx, obj, ctx.<span class="hljs-property">depth</span>);
}

<span class="hljs-comment">// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics</span>
inspect.<span class="hljs-property">colors</span> = {
  <span class="hljs-string">&#x27;bold&#x27;</span> : [<span class="hljs-number">1</span>, <span class="hljs-number">22</span>],
  <span class="hljs-string">&#x27;italic&#x27;</span> : [<span class="hljs-number">3</span>, <span class="hljs-number">23</span>],
  <span class="hljs-string">&#x27;underline&#x27;</span> : [<span class="hljs-number">4</span>, <span class="hljs-number">24</span>],
  <span class="hljs-string">&#x27;inverse&#x27;</span> : [<span class="hljs-number">7</span>, <span class="hljs-number">27</span>],
  <span class="hljs-string">&#x27;white&#x27;</span> : [<span class="hljs-number">37</span>, <span class="hljs-number">39</span>],
  <span class="hljs-string">&#x27;grey&#x27;</span> : [<span class="hljs-number">90</span>, <span class="hljs-number">39</span>],
  <span class="hljs-string">&#x27;black&#x27;</span> : [<span class="hljs-number">30</span>, <span class="hljs-number">39</span>],
  <span class="hljs-string">&#x27;blue&#x27;</span> : [<span class="hljs-number">34</span>, <span class="hljs-number">39</span>],
  <span class="hljs-string">&#x27;cyan&#x27;</span> : [<span class="hljs-number">36</span>, <span class="hljs-number">39</span>],
  <span class="hljs-string">&#x27;green&#x27;</span> : [<span class="hljs-number">32</span>, <span class="hljs-number">39</span>],
  <span class="hljs-string">&#x27;magenta&#x27;</span> : [<span class="hljs-number">35</span>, <span class="hljs-number">39</span>],
  <span class="hljs-string">&#x27;red&#x27;</span> : [<span class="hljs-number">31</span>, <span class="hljs-number">39</span>],
  <span class="hljs-string">&#x27;yellow&#x27;</span> : [<span class="hljs-number">33</span>, <span class="hljs-number">39</span>]
};

<span class="hljs-comment">// Don&#x27;t use &#x27;blue&#x27; not visible on cmd.exe</span>
inspect.<span class="hljs-property">styles</span> = {
  <span class="hljs-string">&#x27;special&#x27;</span>: <span class="hljs-string">&#x27;cyan&#x27;</span>,
  <span class="hljs-string">&#x27;number&#x27;</span>: <span class="hljs-string">&#x27;yellow&#x27;</span>,
  <span class="hljs-string">&#x27;boolean&#x27;</span>: <span class="hljs-string">&#x27;yellow&#x27;</span>,
  <span class="hljs-string">&#x27;undefined&#x27;</span>: <span class="hljs-string">&#x27;grey&#x27;</span>,
  <span class="hljs-string">&#x27;null&#x27;</span>: <span class="hljs-string">&#x27;bold&#x27;</span>,
  <span class="hljs-string">&#x27;string&#x27;</span>: <span class="hljs-string">&#x27;green&#x27;</span>,
  <span class="hljs-string">&#x27;date&#x27;</span>: <span class="hljs-string">&#x27;magenta&#x27;</span>,
  <span class="hljs-comment">// &quot;name&quot;: intentionally not styling</span>
  <span class="hljs-string">&#x27;regexp&#x27;</span>: <span class="hljs-string">&#x27;red&#x27;</span>
};


<span class="hljs-keyword">function</span> <span class="hljs-title function_">stylizeWithColor</span>(<span class="hljs-params">str, styleType</span>) {
  <span class="hljs-keyword">var</span> style = inspect.<span class="hljs-property">styles</span>[styleType];

  <span class="hljs-keyword">if</span> (style) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;\u001b[&#x27;</span> + inspect.<span class="hljs-property">colors</span>[style][<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;m&#x27;</span> + str +
           <span class="hljs-string">&#x27;\u001b[&#x27;</span> + inspect.<span class="hljs-property">colors</span>[style][<span class="hljs-number">1</span>] + <span class="hljs-string">&#x27;m&#x27;</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> str;
  }
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">stylizeNoColor</span>(<span class="hljs-params">str, styleType</span>) {
  <span class="hljs-keyword">return</span> str;
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">arrayToHash</span>(<span class="hljs-params">array</span>) {
  <span class="hljs-keyword">var</span> hash = {};

  array.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">val, idx</span>) {
    hash[val] = <span class="hljs-literal">true</span>;
  });

  <span class="hljs-keyword">return</span> hash;
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatValue</span>(<span class="hljs-params">ctx, value, recurseTimes</span>) {
  <span class="hljs-comment">// Provide a hook for user-specified inspect functions.</span>
  <span class="hljs-comment">// Check that value is an object with an inspect function on it</span>
  <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">customInspect</span> &amp;&amp;
      value &amp;&amp;
      <span class="hljs-title function_">isFunction</span>(value.<span class="hljs-property">inspect</span>) &amp;&amp;
      <span class="hljs-comment">// Filter out the util module, it&#x27;s inspect function is special</span>
      value.<span class="hljs-property">inspect</span> !== inspect &amp;&amp;
      <span class="hljs-comment">// Also filter out any prototype objects using the circular check.</span>
      !(value.<span class="hljs-property">constructor</span> &amp;&amp; value.<span class="hljs-property">constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> === value)) {
    <span class="hljs-keyword">var</span> ret = value.<span class="hljs-title function_">inspect</span>(recurseTimes, ctx);
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isString</span>(ret)) {
      ret = <span class="hljs-title function_">formatValue</span>(ctx, ret, recurseTimes);
    }
    <span class="hljs-keyword">return</span> ret;
  }

  <span class="hljs-comment">// Primitive types cannot have properties</span>
  <span class="hljs-keyword">var</span> primitive = <span class="hljs-title function_">formatPrimitive</span>(ctx, value);
  <span class="hljs-keyword">if</span> (primitive) {
    <span class="hljs-keyword">return</span> primitive;
  }

  <span class="hljs-comment">// Look up the keys of the object.</span>
  <span class="hljs-keyword">var</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(value);
  <span class="hljs-keyword">var</span> visibleKeys = <span class="hljs-title function_">arrayToHash</span>(keys);

  <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">showHidden</span>) {
    keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(value);
  }

  <span class="hljs-comment">// IE doesn&#x27;t make error fields non-enumerable</span>
  <span class="hljs-comment">// http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isError</span>(value)
      &amp;&amp; (keys.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;message&#x27;</span>) &gt;= <span class="hljs-number">0</span> || keys.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;description&#x27;</span>) &gt;= <span class="hljs-number">0</span>)) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatError</span>(value);
  }

  <span class="hljs-comment">// Some type of object without properties can be shortcutted.</span>
  <span class="hljs-keyword">if</span> (keys.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFunction</span>(value)) {
      <span class="hljs-keyword">var</span> name = value.<span class="hljs-property">name</span> ? <span class="hljs-string">&#x27;: &#x27;</span> + value.<span class="hljs-property">name</span> : <span class="hljs-string">&#x27;&#x27;</span>;
      <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;[Function&#x27;</span> + name + <span class="hljs-string">&#x27;]&#x27;</span>, <span class="hljs-string">&#x27;special&#x27;</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isRegExp</span>(value)) {
      <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-title class_">RegExp</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(value), <span class="hljs-string">&#x27;regexp&#x27;</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isDate</span>(value)) {
      <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(value), <span class="hljs-string">&#x27;date&#x27;</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isError</span>(value)) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatError</span>(value);
    }
  }

  <span class="hljs-keyword">var</span> base = <span class="hljs-string">&#x27;&#x27;</span>, array = <span class="hljs-literal">false</span>, braces = [<span class="hljs-string">&#x27;{&#x27;</span>, <span class="hljs-string">&#x27;}&#x27;</span>];

  <span class="hljs-comment">// Make Array say that they are Array</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isArray</span>(value)) {
    array = <span class="hljs-literal">true</span>;
    braces = [<span class="hljs-string">&#x27;[&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>];
  }

  <span class="hljs-comment">// Make functions say that they are functions</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFunction</span>(value)) {
    <span class="hljs-keyword">var</span> n = value.<span class="hljs-property">name</span> ? <span class="hljs-string">&#x27;: &#x27;</span> + value.<span class="hljs-property">name</span> : <span class="hljs-string">&#x27;&#x27;</span>;
    base = <span class="hljs-string">&#x27; [Function&#x27;</span> + n + <span class="hljs-string">&#x27;]&#x27;</span>;
  }

  <span class="hljs-comment">// Make RegExps say that they are RegExps</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isRegExp</span>(value)) {
    base = <span class="hljs-string">&#x27; &#x27;</span> + <span class="hljs-title class_">RegExp</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(value);
  }

  <span class="hljs-comment">// Make dates with properties first say the date</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isDate</span>(value)) {
    base = <span class="hljs-string">&#x27; &#x27;</span> + <span class="hljs-title class_">Date</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toUTCString</span>.<span class="hljs-title function_">call</span>(value);
  }

  <span class="hljs-comment">// Make error with message first say the error</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isError</span>(value)) {
    base = <span class="hljs-string">&#x27; &#x27;</span> + <span class="hljs-title function_">formatError</span>(value);
  }

  <span class="hljs-keyword">if</span> (keys.<span class="hljs-property">length</span> === <span class="hljs-number">0</span> &amp;&amp; (!array || value.<span class="hljs-property">length</span> == <span class="hljs-number">0</span>)) {
    <span class="hljs-keyword">return</span> braces[<span class="hljs-number">0</span>] + base + braces[<span class="hljs-number">1</span>];
  }

  <span class="hljs-keyword">if</span> (recurseTimes &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isRegExp</span>(value)) {
      <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-title class_">RegExp</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(value), <span class="hljs-string">&#x27;regexp&#x27;</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;[Object]&#x27;</span>, <span class="hljs-string">&#x27;special&#x27;</span>);
    }
  }

  ctx.<span class="hljs-property">seen</span>.<span class="hljs-title function_">push</span>(value);

  <span class="hljs-keyword">var</span> output;
  <span class="hljs-keyword">if</span> (array) {
    output = <span class="hljs-title function_">formatArray</span>(ctx, value, recurseTimes, visibleKeys, keys);
  } <span class="hljs-keyword">else</span> {
    output = keys.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatProperty</span>(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.<span class="hljs-property">seen</span>.<span class="hljs-title function_">pop</span>();

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">reduceToSingleString</span>(output, base, braces);
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatPrimitive</span>(<span class="hljs-params">ctx, value</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUndefined</span>(value))
    <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;undefined&#x27;</span>, <span class="hljs-string">&#x27;undefined&#x27;</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isString</span>(value)) {
    <span class="hljs-keyword">var</span> simple = <span class="hljs-string">&#x27;\&#x27;&#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^&quot;|&quot;$/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)
                                             .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&#x27;/g</span>, <span class="hljs-string">&quot;\\&#x27;&quot;</span>)
                                             .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\\&quot;/g</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>) + <span class="hljs-string">&#x27;\&#x27;&#x27;</span>;
    <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(simple, <span class="hljs-string">&#x27;string&#x27;</span>);
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isNumber</span>(value))
    <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;&#x27;</span> + value, <span class="hljs-string">&#x27;number&#x27;</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isBoolean</span>(value))
    <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;&#x27;</span> + value, <span class="hljs-string">&#x27;boolean&#x27;</span>);
  <span class="hljs-comment">// For some reason typeof null is &quot;object&quot;, so special case here.</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isNull</span>(value))
    <span class="hljs-keyword">return</span> ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;null&#x27;</span>, <span class="hljs-string">&#x27;null&#x27;</span>);
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatError</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;[&#x27;</span> + <span class="hljs-title class_">Error</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(value) + <span class="hljs-string">&#x27;]&#x27;</span>;
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatArray</span>(<span class="hljs-params">ctx, value, recurseTimes, visibleKeys, keys</span>) {
  <span class="hljs-keyword">var</span> output = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = value.<span class="hljs-property">length</span>; i &lt; l; ++i) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasOwnProperty</span>(value, <span class="hljs-title class_">String</span>(i))) {
      output.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">formatProperty</span>(ctx, value, recurseTimes, visibleKeys,
          <span class="hljs-title class_">String</span>(i), <span class="hljs-literal">true</span>));
    } <span class="hljs-keyword">else</span> {
      output.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;&#x27;</span>);
    }
  }
  keys.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">if</span> (!key.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^\d+$/</span>)) {
      output.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">formatProperty</span>(ctx, value, recurseTimes, visibleKeys,
          key, <span class="hljs-literal">true</span>));
    }
  });
  <span class="hljs-keyword">return</span> output;
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatProperty</span>(<span class="hljs-params">ctx, value, recurseTimes, visibleKeys, key, array</span>) {
  <span class="hljs-keyword">var</span> name, str, desc;
  desc = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyDescriptor</span>(value, key) || { <span class="hljs-attr">value</span>: value[key] };
  <span class="hljs-keyword">if</span> (desc.<span class="hljs-property">get</span>) {
    <span class="hljs-keyword">if</span> (desc.<span class="hljs-property">set</span>) {
      str = ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;[Getter/Setter]&#x27;</span>, <span class="hljs-string">&#x27;special&#x27;</span>);
    } <span class="hljs-keyword">else</span> {
      str = ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;[Getter]&#x27;</span>, <span class="hljs-string">&#x27;special&#x27;</span>);
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (desc.<span class="hljs-property">set</span>) {
      str = ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;[Setter]&#x27;</span>, <span class="hljs-string">&#x27;special&#x27;</span>);
    }
  }
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">hasOwnProperty</span>(visibleKeys, key)) {
    name = <span class="hljs-string">&#x27;[&#x27;</span> + key + <span class="hljs-string">&#x27;]&#x27;</span>;
  }
  <span class="hljs-keyword">if</span> (!str) {
    <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">seen</span>.<span class="hljs-title function_">indexOf</span>(desc.<span class="hljs-property">value</span>) &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isNull</span>(recurseTimes)) {
        str = <span class="hljs-title function_">formatValue</span>(ctx, desc.<span class="hljs-property">value</span>, <span class="hljs-literal">null</span>);
      } <span class="hljs-keyword">else</span> {
        str = <span class="hljs-title function_">formatValue</span>(ctx, desc.<span class="hljs-property">value</span>, recurseTimes - <span class="hljs-number">1</span>);
      }
      <span class="hljs-keyword">if</span> (str.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;\n&#x27;</span>) &gt; -<span class="hljs-number">1</span>) {
        <span class="hljs-keyword">if</span> (array) {
          str = str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;\n&#x27;</span>).<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">line</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;  &#x27;</span> + line;
          }).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;\n&#x27;</span>).<span class="hljs-title function_">substr</span>(<span class="hljs-number">2</span>);
        } <span class="hljs-keyword">else</span> {
          str = <span class="hljs-string">&#x27;\n&#x27;</span> + str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;\n&#x27;</span>).<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">line</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;   &#x27;</span> + line;
          }).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;\n&#x27;</span>);
        }
      }
    } <span class="hljs-keyword">else</span> {
      str = ctx.<span class="hljs-title function_">stylize</span>(<span class="hljs-string">&#x27;[Circular]&#x27;</span>, <span class="hljs-string">&#x27;special&#x27;</span>);
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isUndefined</span>(name)) {
    <span class="hljs-keyword">if</span> (array &amp;&amp; key.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^\d+$/</span>)) {
      <span class="hljs-keyword">return</span> str;
    }
    name = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-string">&#x27;&#x27;</span> + key);
    <span class="hljs-keyword">if</span> (name.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^&quot;([a-zA-Z_][a-zA-Z_0-9]*)&quot;$/</span>)) {
      name = name.<span class="hljs-title function_">substr</span>(<span class="hljs-number">1</span>, name.<span class="hljs-property">length</span> - <span class="hljs-number">2</span>);
      name = ctx.<span class="hljs-title function_">stylize</span>(name, <span class="hljs-string">&#x27;name&#x27;</span>);
    } <span class="hljs-keyword">else</span> {
      name = name.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&#x27;/g</span>, <span class="hljs-string">&quot;\\&#x27;&quot;</span>)
                 .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\\&quot;/g</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>)
                 .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/(^&quot;|&quot;$)/g</span>, <span class="hljs-string">&quot;&#x27;&quot;</span>);
      name = ctx.<span class="hljs-title function_">stylize</span>(name, <span class="hljs-string">&#x27;string&#x27;</span>);
    }
  }

  <span class="hljs-keyword">return</span> name + <span class="hljs-string">&#x27;: &#x27;</span> + str;
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">reduceToSingleString</span>(<span class="hljs-params">output, base, braces</span>) {
  <span class="hljs-keyword">var</span> length = output.<span class="hljs-title function_">reduce</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">prev, cur</span>) {
    <span class="hljs-keyword">if</span> (cur.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;\n&#x27;</span>) &gt;= <span class="hljs-number">0</span>) ;
    <span class="hljs-keyword">return</span> prev + cur.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\u001b\[\d\d?m/g</span>, <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-property">length</span> + <span class="hljs-number">1</span>;
  }, <span class="hljs-number">0</span>);

  <span class="hljs-keyword">if</span> (length &gt; <span class="hljs-number">60</span>) {
    <span class="hljs-keyword">return</span> braces[<span class="hljs-number">0</span>] +
           (base === <span class="hljs-string">&#x27;&#x27;</span> ? <span class="hljs-string">&#x27;&#x27;</span> : base + <span class="hljs-string">&#x27;\n &#x27;</span>) +
           <span class="hljs-string">&#x27; &#x27;</span> +
           output.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;,\n  &#x27;</span>) +
           <span class="hljs-string">&#x27; &#x27;</span> +
           braces[<span class="hljs-number">1</span>];
  }

  <span class="hljs-keyword">return</span> braces[<span class="hljs-number">0</span>] + base + <span class="hljs-string">&#x27; &#x27;</span> + output.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;, &#x27;</span>) + <span class="hljs-string">&#x27; &#x27;</span> + braces[<span class="hljs-number">1</span>];
}


<span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> These type checking functions intentionally don&#x27;t use `instanceof`</span>
<span class="hljs-comment">// because it is fragile and can be easily faked with `Object.create()`.</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isArray</span>(<span class="hljs-params">ar</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(ar);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isBoolean</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;boolean&#x27;</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isNull</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> arg === <span class="hljs-literal">null</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isNullOrUndefined</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> arg == <span class="hljs-literal">null</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isNumber</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;number&#x27;</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isString</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;string&#x27;</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isSymbol</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;symbol&#x27;</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isUndefined</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> arg === <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isRegExp</span>(<span class="hljs-params">re</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">isObject</span>(re) &amp;&amp; <span class="hljs-title function_">objectToString</span>(re) === <span class="hljs-string">&#x27;[object RegExp]&#x27;</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isObject</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;object&#x27;</span> &amp;&amp; arg !== <span class="hljs-literal">null</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isDate</span>(<span class="hljs-params">d</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">isObject</span>(d) &amp;&amp; <span class="hljs-title function_">objectToString</span>(d) === <span class="hljs-string">&#x27;[object Date]&#x27;</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isError</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">isObject</span>(e) &amp;&amp;
      (<span class="hljs-title function_">objectToString</span>(e) === <span class="hljs-string">&#x27;[object Error]&#x27;</span> || e <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isFunction</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;function&#x27;</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isPrimitive</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> arg === <span class="hljs-literal">null</span> ||
         <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;boolean&#x27;</span> ||
         <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;number&#x27;</span> ||
         <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;string&#x27;</span> ||
         <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;symbol&#x27;</span> ||  <span class="hljs-comment">// ES6 symbol</span>
         <span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">&#x27;undefined&#x27;</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isBuffer</span>(<span class="hljs-params">maybeBuf</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">isBuffer</span>(maybeBuf);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">objectToString</span>(<span class="hljs-params">o</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(o);
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">n</span>) {
  <span class="hljs-keyword">return</span> n &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + n.<span class="hljs-title function_">toString</span>(<span class="hljs-number">10</span>) : n.<span class="hljs-title function_">toString</span>(<span class="hljs-number">10</span>);
}


<span class="hljs-keyword">var</span> months = [<span class="hljs-string">&#x27;Jan&#x27;</span>, <span class="hljs-string">&#x27;Feb&#x27;</span>, <span class="hljs-string">&#x27;Mar&#x27;</span>, <span class="hljs-string">&#x27;Apr&#x27;</span>, <span class="hljs-string">&#x27;May&#x27;</span>, <span class="hljs-string">&#x27;Jun&#x27;</span>, <span class="hljs-string">&#x27;Jul&#x27;</span>, <span class="hljs-string">&#x27;Aug&#x27;</span>, <span class="hljs-string">&#x27;Sep&#x27;</span>,
              <span class="hljs-string">&#x27;Oct&#x27;</span>, <span class="hljs-string">&#x27;Nov&#x27;</span>, <span class="hljs-string">&#x27;Dec&#x27;</span>];

<span class="hljs-comment">// 26 Feb 16:19:34</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">timestamp</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
  <span class="hljs-keyword">var</span> time = [<span class="hljs-title function_">pad</span>(d.<span class="hljs-title function_">getHours</span>()),
              <span class="hljs-title function_">pad</span>(d.<span class="hljs-title function_">getMinutes</span>()),
              <span class="hljs-title function_">pad</span>(d.<span class="hljs-title function_">getSeconds</span>())].<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;:&#x27;</span>);
  <span class="hljs-keyword">return</span> [d.<span class="hljs-title function_">getDate</span>(), months[d.<span class="hljs-title function_">getMonth</span>()], time].<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27; &#x27;</span>);
}


<span class="hljs-comment">// log is just a thin wrapper to console.log that prepends a timestamp</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params"></span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;%s - %s&#x27;</span>, <span class="hljs-title function_">timestamp</span>(), format.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, <span class="hljs-variable language_">arguments</span>));
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">_extend</span>(<span class="hljs-params">origin, add</span>) {
  <span class="hljs-comment">// Don&#x27;t do anything if add isn&#x27;t an object</span>
  <span class="hljs-keyword">if</span> (!add || !<span class="hljs-title function_">isObject</span>(add)) <span class="hljs-keyword">return</span> origin;

  <span class="hljs-keyword">var</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(add);
  <span class="hljs-keyword">var</span> i = keys.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">while</span> (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  <span class="hljs-keyword">return</span> origin;
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-params">obj, prop</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(obj, prop);
}

<span class="hljs-keyword">var</span> kCustomPromisifiedSymbol = <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Symbol</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> ? <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;util.promisify.custom&#x27;</span>) : <span class="hljs-literal">undefined</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">promisify</span>(<span class="hljs-params">original</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> original !== <span class="hljs-string">&#x27;function&#x27;</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;The &quot;original&quot; argument must be of type Function&#x27;</span>);

  <span class="hljs-keyword">if</span> (kCustomPromisifiedSymbol &amp;&amp; original[kCustomPromisifiedSymbol]) {
    <span class="hljs-keyword">var</span> fn = original[kCustomPromisifiedSymbol];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fn !== <span class="hljs-string">&#x27;function&#x27;</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;The &quot;util.promisify.custom&quot; argument must be of type Function&#x27;</span>);
    }
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(fn, kCustomPromisifiedSymbol, {
      <span class="hljs-attr">value</span>: fn, <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>
    });
    <span class="hljs-keyword">return</span> fn;
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> promiseResolve, promiseReject;
    <span class="hljs-keyword">var</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) {
      promiseResolve = resolve;
      promiseReject = reject;
    });

    <span class="hljs-keyword">var</span> args = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) {
      args.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">arguments</span>[i]);
    }
    args.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">err, value</span>) {
      <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-title function_">promiseReject</span>(err);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">promiseResolve</span>(value);
      }
    });

    <span class="hljs-keyword">try</span> {
      original.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-title function_">promiseReject</span>(err);
    }

    <span class="hljs-keyword">return</span> promise;
  }

  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(fn, <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(original));

  <span class="hljs-keyword">if</span> (kCustomPromisifiedSymbol) <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(fn, kCustomPromisifiedSymbol, {
    <span class="hljs-attr">value</span>: fn, <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>
  });
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperties</span>(
    fn,
    <span class="hljs-title function_">getOwnPropertyDescriptors</span>(original)
  );
}

promisify.<span class="hljs-property">custom</span> = kCustomPromisifiedSymbol;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">callbackifyOnRejected</span>(<span class="hljs-params">reason, cb</span>) {
  <span class="hljs-comment">// `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).</span>
  <span class="hljs-comment">// Because `null` is a special error value in callbacks which means &quot;no error</span>
  <span class="hljs-comment">// occurred&quot;, we error-wrap so the callback consumer can distinguish between</span>
  <span class="hljs-comment">// &quot;the promise rejected with null&quot; or &quot;the promise fulfilled with undefined&quot;.</span>
  <span class="hljs-keyword">if</span> (!reason) {
    <span class="hljs-keyword">var</span> newReason = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Promise was rejected with a falsy value&#x27;</span>);
    newReason.<span class="hljs-property">reason</span> = reason;
    reason = newReason;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">cb</span>(reason);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">callbackify</span>(<span class="hljs-params">original</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> original !== <span class="hljs-string">&#x27;function&#x27;</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;The &quot;original&quot; argument must be of type Function&#x27;</span>);
  }

  <span class="hljs-comment">// We DO NOT return the promise as it gives the user a false sense that</span>
  <span class="hljs-comment">// the promise is actually somehow related to the callback&#x27;s execution</span>
  <span class="hljs-comment">// and that the callback throwing will reject the promise.</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">callbackified</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> args = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) {
      args.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">arguments</span>[i]);
    }

    <span class="hljs-keyword">var</span> maybeCb = args.<span class="hljs-title function_">pop</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> maybeCb !== <span class="hljs-string">&#x27;function&#x27;</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;The last argument must be of type Function&#x27;</span>);
    }
    <span class="hljs-keyword">var</span> self = <span class="hljs-variable language_">this</span>;
    <span class="hljs-keyword">var</span> cb = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
      <span class="hljs-keyword">return</span> maybeCb.<span class="hljs-title function_">apply</span>(self, <span class="hljs-variable language_">arguments</span>);
    };
    <span class="hljs-comment">// In true node style we process the callback on `nextTick` with all the</span>
    <span class="hljs-comment">// implications (stack, `uncaughtException`, `async_hooks`)</span>
    original.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
      .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">ret</span>) { browser$1$1.<span class="hljs-title function_">nextTick</span>(cb.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, ret)); },
        <span class="hljs-keyword">function</span>(<span class="hljs-params">rej</span>) { browser$1$1.<span class="hljs-title function_">nextTick</span>(callbackifyOnRejected.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, rej, cb)); });
  }

  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(callbackified, <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(original));
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperties</span>(callbackified, <span class="hljs-title function_">getOwnPropertyDescriptors</span>(original));
  <span class="hljs-keyword">return</span> callbackified;
}

<span class="hljs-keyword">var</span> _polyfillNode_util = {
  <span class="hljs-attr">inherits</span>: inherits$1,
  <span class="hljs-attr">_extend</span>: _extend,
  <span class="hljs-attr">log</span>: log,
  <span class="hljs-attr">isBuffer</span>: isBuffer,
  <span class="hljs-attr">isPrimitive</span>: isPrimitive,
  <span class="hljs-attr">isFunction</span>: isFunction,
  <span class="hljs-attr">isError</span>: isError,
  <span class="hljs-attr">isDate</span>: isDate,
  <span class="hljs-attr">isObject</span>: isObject,
  <span class="hljs-attr">isRegExp</span>: isRegExp,
  <span class="hljs-attr">isUndefined</span>: isUndefined,
  <span class="hljs-attr">isSymbol</span>: isSymbol,
  <span class="hljs-attr">isString</span>: isString,
  <span class="hljs-attr">isNumber</span>: isNumber,
  <span class="hljs-attr">isNullOrUndefined</span>: isNullOrUndefined,
  <span class="hljs-attr">isNull</span>: isNull,
  <span class="hljs-attr">isBoolean</span>: isBoolean,
  <span class="hljs-attr">isArray</span>: isArray,
  <span class="hljs-attr">inspect</span>: inspect,
  <span class="hljs-attr">deprecate</span>: deprecate,
  <span class="hljs-attr">format</span>: format,
  <span class="hljs-attr">debuglog</span>: debuglog,
  <span class="hljs-attr">promisify</span>: promisify,
  <span class="hljs-attr">callbackify</span>: callbackify,
};

<span class="hljs-keyword">var</span> _polyfillNode_util$1 = <span class="hljs-comment">/*#__PURE__*/</span><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">freeze</span>({
  <span class="hljs-attr">__proto__</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">_extend</span>: _extend,
  <span class="hljs-attr">callbackify</span>: callbackify,
  <span class="hljs-attr">debuglog</span>: debuglog,
  <span class="hljs-attr">default</span>: _polyfillNode_util,
  <span class="hljs-attr">deprecate</span>: deprecate,
  <span class="hljs-attr">format</span>: format,
  <span class="hljs-attr">inherits</span>: inherits$1,
  <span class="hljs-attr">inspect</span>: inspect,
  <span class="hljs-attr">isArray</span>: isArray,
  <span class="hljs-attr">isBoolean</span>: isBoolean,
  <span class="hljs-attr">isBuffer</span>: isBuffer,
  <span class="hljs-attr">isDate</span>: isDate,
  <span class="hljs-attr">isError</span>: isError,
  <span class="hljs-attr">isFunction</span>: isFunction,
  <span class="hljs-attr">isNull</span>: isNull,
  <span class="hljs-attr">isNullOrUndefined</span>: isNullOrUndefined,
  <span class="hljs-attr">isNumber</span>: isNumber,
  <span class="hljs-attr">isObject</span>: isObject,
  <span class="hljs-attr">isPrimitive</span>: isPrimitive,
  <span class="hljs-attr">isRegExp</span>: isRegExp,
  <span class="hljs-attr">isString</span>: isString,
  <span class="hljs-attr">isSymbol</span>: isSymbol,
  <span class="hljs-attr">isUndefined</span>: isUndefined,
  <span class="hljs-attr">log</span>: log,
  <span class="hljs-attr">promisify</span>: promisify
});

<span class="hljs-keyword">var</span> <span class="hljs-built_in">require</span>$$1 = <span class="hljs-comment">/*@__PURE__*/</span><span class="hljs-title function_">getAugmentedNamespace</span>(_polyfillNode_util$1);

<span class="hljs-keyword">var</span> hasRequiredNode;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">requireNode</span> () {
	<span class="hljs-keyword">if</span> (hasRequiredNode) <span class="hljs-keyword">return</span> node.<span class="hljs-property">exports</span>;
	hasRequiredNode = <span class="hljs-number">1</span>;
	(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">module</span>, <span class="hljs-built_in">exports</span></span>) {
		<span class="hljs-keyword">const</span> tty = <span class="hljs-built_in">require</span>$$0;
		<span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>$$1;

		<span class="hljs-comment">/**
		 * This is the Node.js implementation of `debug()`.
		 */</span>

		<span class="hljs-built_in">exports</span>.<span class="hljs-property">init</span> = init;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">log</span> = log;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">formatArgs</span> = formatArgs;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">save</span> = save;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">load</span> = load;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">useColors</span> = useColors;
		<span class="hljs-built_in">exports</span>.<span class="hljs-property">destroy</span> = util.<span class="hljs-title function_">deprecate</span>(
			<span class="hljs-function">() =&gt;</span> {},
			<span class="hljs-string">&#x27;Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.&#x27;</span>
		);

		<span class="hljs-comment">/**
		 * Colors.
		 */</span>

		<span class="hljs-built_in">exports</span>.<span class="hljs-property">colors</span> = [<span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>];

		<span class="hljs-keyword">try</span> {
			<span class="hljs-comment">// Optional dependency (as in, doesn&#x27;t need to be installed, NOT like optionalDependencies in package.json)</span>
			<span class="hljs-comment">// eslint-disable-next-line import/no-extraneous-dependencies</span>
			<span class="hljs-keyword">const</span> supportsColor = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;supports-color&#x27;</span>);

			<span class="hljs-keyword">if</span> (supportsColor &amp;&amp; (supportsColor.<span class="hljs-property">stderr</span> || supportsColor).<span class="hljs-property">level</span> &gt;= <span class="hljs-number">2</span>) {
				<span class="hljs-built_in">exports</span>.<span class="hljs-property">colors</span> = [
					<span class="hljs-number">20</span>,
					<span class="hljs-number">21</span>,
					<span class="hljs-number">26</span>,
					<span class="hljs-number">27</span>,
					<span class="hljs-number">32</span>,
					<span class="hljs-number">33</span>,
					<span class="hljs-number">38</span>,
					<span class="hljs-number">39</span>,
					<span class="hljs-number">40</span>,
					<span class="hljs-number">41</span>,
					<span class="hljs-number">42</span>,
					<span class="hljs-number">43</span>,
					<span class="hljs-number">44</span>,
					<span class="hljs-number">45</span>,
					<span class="hljs-number">56</span>,
					<span class="hljs-number">57</span>,
					<span class="hljs-number">62</span>,
					<span class="hljs-number">63</span>,
					<span class="hljs-number">68</span>,
					<span class="hljs-number">69</span>,
					<span class="hljs-number">74</span>,
					<span class="hljs-number">75</span>,
					<span class="hljs-number">76</span>,
					<span class="hljs-number">77</span>,
					<span class="hljs-number">78</span>,
					<span class="hljs-number">79</span>,
					<span class="hljs-number">80</span>,
					<span class="hljs-number">81</span>,
					<span class="hljs-number">92</span>,
					<span class="hljs-number">93</span>,
					<span class="hljs-number">98</span>,
					<span class="hljs-number">99</span>,
					<span class="hljs-number">112</span>,
					<span class="hljs-number">113</span>,
					<span class="hljs-number">128</span>,
					<span class="hljs-number">129</span>,
					<span class="hljs-number">134</span>,
					<span class="hljs-number">135</span>,
					<span class="hljs-number">148</span>,
					<span class="hljs-number">149</span>,
					<span class="hljs-number">160</span>,
					<span class="hljs-number">161</span>,
					<span class="hljs-number">162</span>,
					<span class="hljs-number">163</span>,
					<span class="hljs-number">164</span>,
					<span class="hljs-number">165</span>,
					<span class="hljs-number">166</span>,
					<span class="hljs-number">167</span>,
					<span class="hljs-number">168</span>,
					<span class="hljs-number">169</span>,
					<span class="hljs-number">170</span>,
					<span class="hljs-number">171</span>,
					<span class="hljs-number">172</span>,
					<span class="hljs-number">173</span>,
					<span class="hljs-number">178</span>,
					<span class="hljs-number">179</span>,
					<span class="hljs-number">184</span>,
					<span class="hljs-number">185</span>,
					<span class="hljs-number">196</span>,
					<span class="hljs-number">197</span>,
					<span class="hljs-number">198</span>,
					<span class="hljs-number">199</span>,
					<span class="hljs-number">200</span>,
					<span class="hljs-number">201</span>,
					<span class="hljs-number">202</span>,
					<span class="hljs-number">203</span>,
					<span class="hljs-number">204</span>,
					<span class="hljs-number">205</span>,
					<span class="hljs-number">206</span>,
					<span class="hljs-number">207</span>,
					<span class="hljs-number">208</span>,
					<span class="hljs-number">209</span>,
					<span class="hljs-number">214</span>,
					<span class="hljs-number">215</span>,
					<span class="hljs-number">220</span>,
					<span class="hljs-number">221</span>
				];
			}
		} <span class="hljs-keyword">catch</span> (error) {
			<span class="hljs-comment">// Swallow - we only care if `supports-color` is available; it doesn&#x27;t have to be.</span>
		}

		<span class="hljs-comment">/**
		 * Build up the default `inspectOpts` object from the environment variables.
		 *
		 *   $ DEBUG_COLORS=no DEBUG_DEPTH=10 DEBUG_SHOW_HIDDEN=enabled node script.js
		 */</span>

		<span class="hljs-built_in">exports</span>.<span class="hljs-property">inspectOpts</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(browser$1$1.<span class="hljs-property">env</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
			<span class="hljs-keyword">return</span> <span class="hljs-regexp">/^debug_/i</span>.<span class="hljs-title function_">test</span>(key);
		}).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">obj, key</span>) =&gt;</span> {
			<span class="hljs-comment">// Camel-case</span>
			<span class="hljs-keyword">const</span> prop = key
				.<span class="hljs-title function_">substring</span>(<span class="hljs-number">6</span>)
				.<span class="hljs-title function_">toLowerCase</span>()
				.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/_([a-z])/g</span>, <span class="hljs-function">(<span class="hljs-params">_, k</span>) =&gt;</span> {
					<span class="hljs-keyword">return</span> k.<span class="hljs-title function_">toUpperCase</span>();
				});

			<span class="hljs-comment">// Coerce string value into JS value</span>
			<span class="hljs-keyword">let</span> val = browser$1$1.<span class="hljs-property">env</span>[key];
			<span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^(yes|on|true|enabled)$/i</span>.<span class="hljs-title function_">test</span>(val)) {
				val = <span class="hljs-literal">true</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^(no|off|false|disabled)$/i</span>.<span class="hljs-title function_">test</span>(val)) {
				val = <span class="hljs-literal">false</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val === <span class="hljs-string">&#x27;null&#x27;</span>) {
				val = <span class="hljs-literal">null</span>;
			} <span class="hljs-keyword">else</span> {
				val = <span class="hljs-title class_">Number</span>(val);
			}

			obj[prop] = val;
			<span class="hljs-keyword">return</span> obj;
		}, {});

		<span class="hljs-comment">/**
		 * Is stdout a TTY? Colored output is enabled when `true`.
		 */</span>

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">useColors</span>(<span class="hljs-params"></span>) {
			<span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;colors&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">exports</span>.<span class="hljs-property">inspectOpts</span> ?
				<span class="hljs-title class_">Boolean</span>(<span class="hljs-built_in">exports</span>.<span class="hljs-property">inspectOpts</span>.<span class="hljs-property">colors</span>) :
				tty.<span class="hljs-title function_">isatty</span>(browser$1$1.<span class="hljs-property">stderr</span>.<span class="hljs-property">fd</span>);
		}

		<span class="hljs-comment">/**
		 * Adds ANSI color escape codes if enabled.
		 *
		 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span>
		 */</span>

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatArgs</span>(<span class="hljs-params">args</span>) {
			<span class="hljs-keyword">const</span> {<span class="hljs-attr">namespace</span>: name, useColors} = <span class="hljs-variable language_">this</span>;

			<span class="hljs-keyword">if</span> (useColors) {
				<span class="hljs-keyword">const</span> c = <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span>;
				<span class="hljs-keyword">const</span> colorCode = <span class="hljs-string">&#x27;\u001B[3&#x27;</span> + (c &lt; <span class="hljs-number">8</span> ? c : <span class="hljs-string">&#x27;8;5;&#x27;</span> + c);
				<span class="hljs-keyword">const</span> prefix = <span class="hljs-string">`  <span class="hljs-subst">${colorCode}</span>;1m<span class="hljs-subst">${name}</span> \u001B[0m`</span>;

				args[<span class="hljs-number">0</span>] = prefix + args[<span class="hljs-number">0</span>].<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;\n&#x27;</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;\n&#x27;</span> + prefix);
				args.<span class="hljs-title function_">push</span>(colorCode + <span class="hljs-string">&#x27;m+&#x27;</span> + <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>.<span class="hljs-title function_">humanize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">diff</span>) + <span class="hljs-string">&#x27;\u001B[0m&#x27;</span>);
			} <span class="hljs-keyword">else</span> {
				args[<span class="hljs-number">0</span>] = <span class="hljs-title function_">getDate</span>() + name + <span class="hljs-string">&#x27; &#x27;</span> + args[<span class="hljs-number">0</span>];
			}
		}

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">getDate</span>(<span class="hljs-params"></span>) {
			<span class="hljs-keyword">if</span> (<span class="hljs-built_in">exports</span>.<span class="hljs-property">inspectOpts</span>.<span class="hljs-property">hideDate</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>() + <span class="hljs-string">&#x27; &#x27;</span>;
		}

		<span class="hljs-comment">/**
		 * Invokes `util.formatWithOptions()` with the specified arguments and writes to stderr.
		 */</span>

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">...args</span>) {
			<span class="hljs-keyword">return</span> browser$1$1.<span class="hljs-property">stderr</span>.<span class="hljs-title function_">write</span>(util.<span class="hljs-title function_">formatWithOptions</span>(<span class="hljs-built_in">exports</span>.<span class="hljs-property">inspectOpts</span>, ...args) + <span class="hljs-string">&#x27;\n&#x27;</span>);
		}

		<span class="hljs-comment">/**
		 * Save `namespaces`.
		 *
		 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} <span class="hljs-variable">namespaces</span>
		 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
		 */</span>
		<span class="hljs-keyword">function</span> <span class="hljs-title function_">save</span>(<span class="hljs-params">namespaces</span>) {
			<span class="hljs-keyword">if</span> (namespaces) {
				browser$1$1.<span class="hljs-property">env</span>.<span class="hljs-property">DEBUG</span> = namespaces;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-comment">// If you set a process.env field to null or undefined, it gets cast to the</span>
				<span class="hljs-comment">// string &#x27;null&#x27; or &#x27;undefined&#x27;. Just delete instead.</span>
				<span class="hljs-keyword">delete</span> browser$1$1.<span class="hljs-property">env</span>.<span class="hljs-property">DEBUG</span>;
			}
		}

		<span class="hljs-comment">/**
		 * Load `namespaces`.
		 *
		 * <span class="hljs-doctag">@return</span> {<span class="hljs-type">String</span>} returns the previously persisted debug modes
		 * <span class="hljs-doctag">@api</span> <span class="hljs-variable">private</span>
		 */</span>

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">load</span>(<span class="hljs-params"></span>) {
			<span class="hljs-keyword">return</span> browser$1$1.<span class="hljs-property">env</span>.<span class="hljs-property">DEBUG</span>;
		}

		<span class="hljs-comment">/**
		 * Init logic for `debug` instances.
		 *
		 * Create a new `inspectOpts` object in case `useColors` is set
		 * differently for a particular `debug` instance.
		 */</span>

		<span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">debug</span>) {
			debug.<span class="hljs-property">inspectOpts</span> = {};

			<span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-built_in">exports</span>.<span class="hljs-property">inspectOpts</span>);
			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
				debug.<span class="hljs-property">inspectOpts</span>[keys[i]] = <span class="hljs-built_in">exports</span>.<span class="hljs-property">inspectOpts</span>[keys[i]];
			}
		}

		<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = requireCommon()(<span class="hljs-built_in">exports</span>);

		<span class="hljs-keyword">const</span> {formatters} = <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>;

		<span class="hljs-comment">/**
		 * Map %o to `util.inspect()`, all on a single line.
		 */</span>

		formatters.<span class="hljs-property">o</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">v</span>) {
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">inspectOpts</span>.<span class="hljs-property">colors</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">useColors</span>;
			<span class="hljs-keyword">return</span> util.<span class="hljs-title function_">inspect</span>(v, <span class="hljs-variable language_">this</span>.<span class="hljs-property">inspectOpts</span>)
				.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;\n&#x27;</span>)
				.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">str</span> =&gt;</span> str.<span class="hljs-title function_">trim</span>())
				.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27; &#x27;</span>);
		};

		<span class="hljs-comment">/**
		 * Map %O to `util.inspect()`, allowing multiple lines if needed.
		 */</span>

		formatters.<span class="hljs-property">O</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">v</span>) {
			<span class="hljs-variable language_">this</span>.<span class="hljs-property">inspectOpts</span>.<span class="hljs-property">colors</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">useColors</span>;
			<span class="hljs-keyword">return</span> util.<span class="hljs-title function_">inspect</span>(v, <span class="hljs-variable language_">this</span>.<span class="hljs-property">inspectOpts</span>);
		}; 
	} (node, node.<span class="hljs-property">exports</span>));
	<span class="hljs-keyword">return</span> node.<span class="hljs-property">exports</span>;
}

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> browser$1$1 === <span class="hljs-string">&#x27;undefined&#x27;</span> || browser$1$1.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;renderer&#x27;</span> || browser$1$1.<span class="hljs-property">browser</span> === <span class="hljs-literal">true</span> || browser$1$1.<span class="hljs-property">__nwjs</span>) {
	src.<span class="hljs-property">exports</span> = requireBrowser();
} <span class="hljs-keyword">else</span> {
	src.<span class="hljs-property">exports</span> = requireNode();
}

<span class="hljs-keyword">var</span> srcExports = src.<span class="hljs-property">exports</span>;

(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-built_in">exports</span></span>) {

	<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&quot;__esModule&quot;</span>, {
	  <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span>
	});
	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;

	<span class="hljs-keyword">var</span> _distance = <span class="hljs-title function_">_interopRequireDefault</span>(distance_1);

	<span class="hljs-keyword">var</span> _squaredDistance = <span class="hljs-title function_">_interopRequireDefault</span>(squaredDistance_1);

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_interopRequireDefault</span>(<span class="hljs-params">obj</span>) { <span class="hljs-keyword">return</span> obj &amp;&amp; obj.<span class="hljs-property">__esModule</span> ? obj : { <span class="hljs-string">&quot;default&quot;</span>: obj }; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-params">instance, Constructor</span>) { <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Constructor</span>)) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;Cannot call a class as a function&quot;</span>); } }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-params">target, props</span>) { <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; props.<span class="hljs-property">length</span>; i++) { <span class="hljs-keyword">var</span> descriptor = props[i]; descriptor.<span class="hljs-property">enumerable</span> = descriptor.<span class="hljs-property">enumerable</span> || <span class="hljs-literal">false</span>; descriptor.<span class="hljs-property">configurable</span> = <span class="hljs-literal">true</span>; <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;value&quot;</span> <span class="hljs-keyword">in</span> descriptor) descriptor.<span class="hljs-property">writable</span> = <span class="hljs-literal">true</span>; <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(target, descriptor.<span class="hljs-property">key</span>, descriptor); } }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_createClass</span>(<span class="hljs-params">Constructor, protoProps, staticProps</span>) { <span class="hljs-keyword">if</span> (protoProps) <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, protoProps); <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-title class_">Constructor</span>, <span class="hljs-string">&quot;prototype&quot;</span>, { <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span> }); <span class="hljs-keyword">return</span> <span class="hljs-title class_">Constructor</span>; }

	<span class="hljs-keyword">var</span> debug = <span class="hljs-title function_">srcExports</span>(<span class="hljs-string">&#x27;halfedge&#x27;</span>);

	<span class="hljs-keyword">var</span> <span class="hljs-title class_">HalfEdge</span> = <span class="hljs-comment">/*#__PURE__*/</span><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
	  <span class="hljs-keyword">function</span> <span class="hljs-title function_">HalfEdge</span>(<span class="hljs-params">vertex, face</span>) {
	    <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-title class_">HalfEdge</span>);

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertex</span> = vertex;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">face</span> = face;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">next</span> = <span class="hljs-literal">null</span>;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">prev</span> = <span class="hljs-literal">null</span>;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">opposite</span> = <span class="hljs-literal">null</span>;
	  }

	  <span class="hljs-title function_">_createClass</span>(<span class="hljs-title class_">HalfEdge</span>, [{
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;head&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">head</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertex</span>;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;tail&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">tail</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">prev</span> ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">prev</span>.<span class="hljs-property">vertex</span> : <span class="hljs-literal">null</span>;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;length&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">length</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">tail</span>()) {
	        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, _distance[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">tail</span>().<span class="hljs-property">point</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">head</span>().<span class="hljs-property">point</span>);
	      }

	      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;lengthSquared&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">lengthSquared</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">tail</span>()) {
	        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, _squaredDistance[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">tail</span>().<span class="hljs-property">point</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">head</span>().<span class="hljs-property">point</span>);
	      }

	      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;setOpposite&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">setOpposite</span>(<span class="hljs-params">edge</span>) {
	      <span class="hljs-keyword">var</span> me = <span class="hljs-variable language_">this</span>;

	      <span class="hljs-keyword">if</span> (debug.<span class="hljs-property">enabled</span>) {
	        <span class="hljs-title function_">debug</span>(<span class="hljs-string">&quot;opposite &quot;</span>.<span class="hljs-title function_">concat</span>(me.<span class="hljs-title function_">tail</span>().<span class="hljs-property">index</span>, <span class="hljs-string">&quot; &lt;--&gt; &quot;</span>).<span class="hljs-title function_">concat</span>(me.<span class="hljs-title function_">head</span>().<span class="hljs-property">index</span>, <span class="hljs-string">&quot; between &quot;</span>).<span class="hljs-title function_">concat</span>(me.<span class="hljs-property">face</span>.<span class="hljs-title function_">collectIndices</span>(), <span class="hljs-string">&quot;, &quot;</span>).<span class="hljs-title function_">concat</span>(edge.<span class="hljs-property">face</span>.<span class="hljs-title function_">collectIndices</span>()));
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">opposite</span> = edge;
	      edge.<span class="hljs-property">opposite</span> = <span class="hljs-variable language_">this</span>;
	    }
	  }]);

	  <span class="hljs-keyword">return</span> <span class="hljs-title class_">HalfEdge</span>;
	}();

	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-title class_">HalfEdge</span>; 
} (<span class="hljs-title class_">HalfEdge</span>));

(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-built_in">exports</span></span>) {

	<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&quot;__esModule&quot;</span>, {
	  <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span>
	});
	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-built_in">exports</span>.<span class="hljs-property">VISIBLE</span> = <span class="hljs-built_in">exports</span>.<span class="hljs-property">NON_CONVEX</span> = <span class="hljs-built_in">exports</span>.<span class="hljs-property">DELETED</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;

	<span class="hljs-keyword">var</span> _dot = <span class="hljs-title function_">_interopRequireDefault</span>(dot_1);

	<span class="hljs-keyword">var</span> _add = <span class="hljs-title function_">_interopRequireDefault</span>(add_1);

	<span class="hljs-keyword">var</span> _subtract = <span class="hljs-title function_">_interopRequireDefault</span>(subtract_1);

	<span class="hljs-keyword">var</span> _cross = <span class="hljs-title function_">_interopRequireDefault</span>(cross_1);

	<span class="hljs-keyword">var</span> _copy = <span class="hljs-title function_">_interopRequireDefault</span>(copy_1);

	<span class="hljs-keyword">var</span> _length = <span class="hljs-title function_">_interopRequireDefault</span>(length_1);

	<span class="hljs-keyword">var</span> _scale = <span class="hljs-title function_">_interopRequireDefault</span>(scale_1);

	<span class="hljs-keyword">var</span> _scaleAndAdd = <span class="hljs-title function_">_interopRequireDefault</span>(scaleAndAdd_1);

	<span class="hljs-keyword">var</span> _normalize = <span class="hljs-title function_">_interopRequireDefault</span>(normalize_1);

	<span class="hljs-keyword">var</span> _HalfEdge = <span class="hljs-title function_">_interopRequireDefault</span>(<span class="hljs-title class_">HalfEdge</span>);

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_interopRequireDefault</span>(<span class="hljs-params">obj</span>) { <span class="hljs-keyword">return</span> obj &amp;&amp; obj.<span class="hljs-property">__esModule</span> ? obj : { <span class="hljs-string">&quot;default&quot;</span>: obj }; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-params">instance, Constructor</span>) { <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Constructor</span>)) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;Cannot call a class as a function&quot;</span>); } }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-params">target, props</span>) { <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; props.<span class="hljs-property">length</span>; i++) { <span class="hljs-keyword">var</span> descriptor = props[i]; descriptor.<span class="hljs-property">enumerable</span> = descriptor.<span class="hljs-property">enumerable</span> || <span class="hljs-literal">false</span>; descriptor.<span class="hljs-property">configurable</span> = <span class="hljs-literal">true</span>; <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;value&quot;</span> <span class="hljs-keyword">in</span> descriptor) descriptor.<span class="hljs-property">writable</span> = <span class="hljs-literal">true</span>; <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(target, descriptor.<span class="hljs-property">key</span>, descriptor); } }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_createClass</span>(<span class="hljs-params">Constructor, protoProps, staticProps</span>) { <span class="hljs-keyword">if</span> (protoProps) <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, protoProps); <span class="hljs-keyword">if</span> (staticProps) <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-title class_">Constructor</span>, staticProps); <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-title class_">Constructor</span>, <span class="hljs-string">&quot;prototype&quot;</span>, { <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span> }); <span class="hljs-keyword">return</span> <span class="hljs-title class_">Constructor</span>; }

	<span class="hljs-keyword">var</span> debug = <span class="hljs-title function_">srcExports</span>(<span class="hljs-string">&#x27;face&#x27;</span>);

	<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">VISIBLE</span> = <span class="hljs-number">0</span>;
	<span class="hljs-built_in">exports</span>.<span class="hljs-property">VISIBLE</span> = <span class="hljs-variable constant_">VISIBLE</span>;
	<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">NON_CONVEX</span> = <span class="hljs-number">1</span>;
	<span class="hljs-built_in">exports</span>.<span class="hljs-property">NON_CONVEX</span> = <span class="hljs-variable constant_">NON_CONVEX</span>;
	<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">DELETED</span> = <span class="hljs-number">2</span>;
	<span class="hljs-built_in">exports</span>.<span class="hljs-property">DELETED</span> = <span class="hljs-variable constant_">DELETED</span>;

	<span class="hljs-keyword">var</span> <span class="hljs-title class_">Face</span> = <span class="hljs-comment">/*#__PURE__*/</span><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
	  <span class="hljs-keyword">function</span> <span class="hljs-title function_">Face</span>(<span class="hljs-params"></span>) {
	    <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-title class_">Face</span>);

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span> = [];
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">centroid</span> = []; <span class="hljs-comment">// signed distance from face to the origin</span>

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">offset</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// pointer to the a vertex in a double linked list this face can see</span>

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">outside</span> = <span class="hljs-literal">null</span>;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mark</span> = <span class="hljs-variable constant_">VISIBLE</span>;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span> = <span class="hljs-literal">null</span>;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nVertices</span> = <span class="hljs-number">0</span>;
	  }

	  <span class="hljs-title function_">_createClass</span>(<span class="hljs-title class_">Face</span>, [{
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;getEdge&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">getEdge</span>(<span class="hljs-params">i</span>) {
	      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> i !== <span class="hljs-string">&#x27;number&#x27;</span>) {
	        <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;requires a number&#x27;</span>);
	      }

	      <span class="hljs-keyword">var</span> it = <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>;

	      <span class="hljs-keyword">while</span> (i &gt; <span class="hljs-number">0</span>) {
	        it = it.<span class="hljs-property">next</span>;
	        i -= <span class="hljs-number">1</span>;
	      }

	      <span class="hljs-keyword">while</span> (i &lt; <span class="hljs-number">0</span>) {
	        it = it.<span class="hljs-property">prev</span>;
	        i += <span class="hljs-number">1</span>;
	      }

	      <span class="hljs-keyword">return</span> it;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;computeNormal&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computeNormal</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">var</span> e0 = <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>;
	      <span class="hljs-keyword">var</span> e1 = e0.<span class="hljs-property">next</span>;
	      <span class="hljs-keyword">var</span> e2 = e1.<span class="hljs-property">next</span>;
	      <span class="hljs-keyword">var</span> v2 = (<span class="hljs-number">0</span>, _subtract[<span class="hljs-string">&quot;default&quot;</span>])([], e1.<span class="hljs-title function_">head</span>().<span class="hljs-property">point</span>, e0.<span class="hljs-title function_">head</span>().<span class="hljs-property">point</span>);
	      <span class="hljs-keyword">var</span> t = [];
	      <span class="hljs-keyword">var</span> v1 = [];
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">nVertices</span> = <span class="hljs-number">2</span>;
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span> = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];

	      <span class="hljs-keyword">while</span> (e2 !== e0) {
	        (<span class="hljs-number">0</span>, _copy[<span class="hljs-string">&quot;default&quot;</span>])(v1, v2);
	        (<span class="hljs-number">0</span>, _subtract[<span class="hljs-string">&quot;default&quot;</span>])(v2, e2.<span class="hljs-title function_">head</span>().<span class="hljs-property">point</span>, e0.<span class="hljs-title function_">head</span>().<span class="hljs-property">point</span>);
	        (<span class="hljs-number">0</span>, _add[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, (<span class="hljs-number">0</span>, _cross[<span class="hljs-string">&quot;default&quot;</span>])(t, v1, v2));
	        e2 = e2.<span class="hljs-property">next</span>;
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nVertices</span> += <span class="hljs-number">1</span>;
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">area</span> = (<span class="hljs-number">0</span>, _length[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>); <span class="hljs-comment">// normalize the vector, since we&#x27;ve already calculated the area</span>
	      <span class="hljs-comment">// it&#x27;s cheaper to scale the vector using this quantity instead of</span>
	      <span class="hljs-comment">// doing the same operation again</span>

	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span> = (<span class="hljs-number">0</span>, _scale[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, <span class="hljs-number">1</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">area</span>);
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;computeNormalMinArea&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computeNormalMinArea</span>(<span class="hljs-params">minArea</span>) {
	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeNormal</span>();

	      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">area</span> &lt; minArea) {
	        <span class="hljs-comment">// compute the normal without the longest edge</span>
	        <span class="hljs-keyword">var</span> maxEdge;
	        <span class="hljs-keyword">var</span> maxSquaredLength = <span class="hljs-number">0</span>;
	        <span class="hljs-keyword">var</span> edge = <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>; <span class="hljs-comment">// find the longest edge (in length) in the chain of edges</span>

	        <span class="hljs-keyword">do</span> {
	          <span class="hljs-keyword">var</span> lengthSquared = edge.<span class="hljs-title function_">lengthSquared</span>();

	          <span class="hljs-keyword">if</span> (lengthSquared &gt; maxSquaredLength) {
	            maxEdge = edge;
	            maxSquaredLength = lengthSquared;
	          }

	          edge = edge.<span class="hljs-property">next</span>;
	        } <span class="hljs-keyword">while</span> (edge !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>);

	        <span class="hljs-keyword">var</span> p1 = maxEdge.<span class="hljs-title function_">tail</span>().<span class="hljs-property">point</span>;
	        <span class="hljs-keyword">var</span> p2 = maxEdge.<span class="hljs-title function_">head</span>().<span class="hljs-property">point</span>;
	        <span class="hljs-keyword">var</span> maxVector = (<span class="hljs-number">0</span>, _subtract[<span class="hljs-string">&quot;default&quot;</span>])([], p2, p1);
	        <span class="hljs-keyword">var</span> maxLength = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(maxSquaredLength); <span class="hljs-comment">// maxVector is normalized after this operation</span>

	        (<span class="hljs-number">0</span>, _scale[<span class="hljs-string">&quot;default&quot;</span>])(maxVector, maxVector, <span class="hljs-number">1</span> / maxLength); <span class="hljs-comment">// compute the projection of maxVector over this face normal</span>

	        <span class="hljs-keyword">var</span> maxProjection = (<span class="hljs-number">0</span>, _dot[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, maxVector); <span class="hljs-comment">// subtract the quantity maxEdge adds on the normal</span>

	        (<span class="hljs-number">0</span>, _scaleAndAdd[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, maxVector, -maxProjection); <span class="hljs-comment">// renormalize `this.normal`</span>

	        (<span class="hljs-number">0</span>, _normalize[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>);
	      }
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;computeCentroid&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computeCentroid</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">centroid</span> = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];
	      <span class="hljs-keyword">var</span> edge = <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>;

	      <span class="hljs-keyword">do</span> {
	        (<span class="hljs-number">0</span>, _add[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">centroid</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">centroid</span>, edge.<span class="hljs-title function_">head</span>().<span class="hljs-property">point</span>);
	        edge = edge.<span class="hljs-property">next</span>;
	      } <span class="hljs-keyword">while</span> (edge !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>);

	      (<span class="hljs-number">0</span>, _scale[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">centroid</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">centroid</span>, <span class="hljs-number">1</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">nVertices</span>);
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;computeNormalAndCentroid&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computeNormalAndCentroid</span>(<span class="hljs-params">minArea</span>) {
	      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> minArea !== <span class="hljs-string">&#x27;undefined&#x27;</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeNormalMinArea</span>(minArea);
	      } <span class="hljs-keyword">else</span> {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeNormal</span>();
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeCentroid</span>();
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">offset</span> = (<span class="hljs-number">0</span>, _dot[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">centroid</span>);
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;distanceToPlane&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">distanceToPlane</span>(<span class="hljs-params">point</span>) {
	      <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, _dot[<span class="hljs-string">&quot;default&quot;</span>])(<span class="hljs-variable language_">this</span>.<span class="hljs-property">normal</span>, point) - <span class="hljs-variable language_">this</span>.<span class="hljs-property">offset</span>;
	    }
	    <span class="hljs-comment">/**
	     * <span class="hljs-doctag">@private</span>
	     *
	     * Connects two edges assuming that prev.head().point === next.tail().point
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HalfEdge</span>} <span class="hljs-variable">prev</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HalfEdge</span>} <span class="hljs-variable">next</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;connectHalfEdges&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">connectHalfEdges</span>(<span class="hljs-params">prev, next</span>) {
	      <span class="hljs-keyword">var</span> discardedFace;

	      <span class="hljs-keyword">if</span> (prev.<span class="hljs-property">opposite</span>.<span class="hljs-property">face</span> === next.<span class="hljs-property">opposite</span>.<span class="hljs-property">face</span>) {
	        <span class="hljs-comment">// `prev` is remove a redundant edge</span>
	        <span class="hljs-keyword">var</span> oppositeFace = next.<span class="hljs-property">opposite</span>.<span class="hljs-property">face</span>;
	        <span class="hljs-keyword">var</span> oppositeEdge;

	        <span class="hljs-keyword">if</span> (prev === <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>) {
	          <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span> = next;
	        }

	        <span class="hljs-keyword">if</span> (oppositeFace.<span class="hljs-property">nVertices</span> === <span class="hljs-number">3</span>) {
	          <span class="hljs-comment">// case:</span>
	          <span class="hljs-comment">// remove the face on the right</span>
	          <span class="hljs-comment">//</span>
	          <span class="hljs-comment">//       /|\</span>
	          <span class="hljs-comment">//      / | \ the face on the right</span>
	          <span class="hljs-comment">//     /  |  \ --&gt; opposite edge</span>
	          <span class="hljs-comment">//    / a |   \</span>
	          <span class="hljs-comment">//   *----*----*</span>
	          <span class="hljs-comment">//  /     b  |  \</span>
	          <span class="hljs-comment">//           </span>
	          <span class="hljs-comment">//      redundant edge</span>
	          <span class="hljs-comment">//</span>
	          <span class="hljs-comment">// Note: the opposite edge is actually in the face to the right</span>
	          <span class="hljs-comment">// of the face to be destroyed</span>
	          oppositeEdge = next.<span class="hljs-property">opposite</span>.<span class="hljs-property">prev</span>.<span class="hljs-property">opposite</span>;
	          oppositeFace.<span class="hljs-property">mark</span> = <span class="hljs-variable constant_">DELETED</span>;
	          discardedFace = oppositeFace;
	        } <span class="hljs-keyword">else</span> {
	          <span class="hljs-comment">// case:</span>
	          <span class="hljs-comment">//          t</span>
	          <span class="hljs-comment">//        *----</span>
	          <span class="hljs-comment">//       /| &lt;- right face&#x27;s redundant edge</span>
	          <span class="hljs-comment">//      / | opposite edge</span>
	          <span class="hljs-comment">//     /  |     /</span>
	          <span class="hljs-comment">//    / a |  |  /</span>
	          <span class="hljs-comment">//   *----*----*</span>
	          <span class="hljs-comment">//  /     b  |  \</span>
	          <span class="hljs-comment">//           </span>
	          <span class="hljs-comment">//      redundant edge</span>
	          oppositeEdge = next.<span class="hljs-property">opposite</span>.<span class="hljs-property">next</span>; <span class="hljs-comment">// make sure that the link `oppositeFace.edge` points correctly even</span>
	          <span class="hljs-comment">// after the right face redundant edge is removed</span>

	          <span class="hljs-keyword">if</span> (oppositeFace.<span class="hljs-property">edge</span> === oppositeEdge.<span class="hljs-property">prev</span>) {
	            oppositeFace.<span class="hljs-property">edge</span> = oppositeEdge;
	          } <span class="hljs-comment">//       /|   /</span>
	          <span class="hljs-comment">//      / | t/opposite edge</span>
	          <span class="hljs-comment">//     /  | /   /</span>
	          <span class="hljs-comment">//    / a |/  | /</span>
	          <span class="hljs-comment">//   *----*----*</span>
	          <span class="hljs-comment">//  /     b     \</span>


	          oppositeEdge.<span class="hljs-property">prev</span> = oppositeEdge.<span class="hljs-property">prev</span>.<span class="hljs-property">prev</span>;
	          oppositeEdge.<span class="hljs-property">prev</span>.<span class="hljs-property">next</span> = oppositeEdge;
	        } <span class="hljs-comment">//       /|</span>
	        <span class="hljs-comment">//      / |</span>
	        <span class="hljs-comment">//     /  |</span>
	        <span class="hljs-comment">//    / a |</span>
	        <span class="hljs-comment">//   *----*----*</span>
	        <span class="hljs-comment">//  /     b    \</span>
	        <span class="hljs-comment">//           |</span>
	        <span class="hljs-comment">//     redundant edge</span>


	        next.<span class="hljs-property">prev</span> = prev.<span class="hljs-property">prev</span>;
	        next.<span class="hljs-property">prev</span>.<span class="hljs-property">next</span> = next; <span class="hljs-comment">//       / \  \</span>
	        <span class="hljs-comment">//      /   \-&gt;\</span>
	        <span class="hljs-comment">//     /     \&lt;-\ opposite edge</span>
	        <span class="hljs-comment">//    / a     \  \</span>
	        <span class="hljs-comment">//   *----*----*</span>
	        <span class="hljs-comment">//  /     b  ^  \</span>

	        next.<span class="hljs-title function_">setOpposite</span>(oppositeEdge);
	        oppositeFace.<span class="hljs-title function_">computeNormalAndCentroid</span>();
	      } <span class="hljs-keyword">else</span> {
	        <span class="hljs-comment">// trivial case</span>
	        <span class="hljs-comment">//        *</span>
	        <span class="hljs-comment">//       /|\</span>
	        <span class="hljs-comment">//      / | \</span>
	        <span class="hljs-comment">//     /  |--&gt; next</span>
	        <span class="hljs-comment">//    / a |   \</span>
	        <span class="hljs-comment">//   *----*----*</span>
	        <span class="hljs-comment">//    \ b |   /</span>
	        <span class="hljs-comment">//     \  |--&gt; prev</span>
	        <span class="hljs-comment">//      \ | /</span>
	        <span class="hljs-comment">//       \|/</span>
	        <span class="hljs-comment">//        *</span>
	        prev.<span class="hljs-property">next</span> = next;
	        next.<span class="hljs-property">prev</span> = prev;
	      }

	      <span class="hljs-keyword">return</span> discardedFace;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;mergeAdjacentFaces&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">mergeAdjacentFaces</span>(<span class="hljs-params">adjacentEdge, discardedFaces</span>) {
	      <span class="hljs-keyword">var</span> oppositeEdge = adjacentEdge.<span class="hljs-property">opposite</span>;
	      <span class="hljs-keyword">var</span> oppositeFace = oppositeEdge.<span class="hljs-property">face</span>;
	      discardedFaces.<span class="hljs-title function_">push</span>(oppositeFace);
	      oppositeFace.<span class="hljs-property">mark</span> = <span class="hljs-variable constant_">DELETED</span>; <span class="hljs-comment">// find the chain of edges whose opposite face is `oppositeFace`</span>
	      <span class="hljs-comment">//</span>
	      <span class="hljs-comment">//                ===&gt;</span>
	      <span class="hljs-comment">//      \         face         /</span>
	      <span class="hljs-comment">//       * ---- * ---- * ---- *</span>
	      <span class="hljs-comment">//      /     opposite face    \</span>
	      <span class="hljs-comment">//                &lt;===</span>
	      <span class="hljs-comment">//</span>

	      <span class="hljs-keyword">var</span> adjacentEdgePrev = adjacentEdge.<span class="hljs-property">prev</span>;
	      <span class="hljs-keyword">var</span> adjacentEdgeNext = adjacentEdge.<span class="hljs-property">next</span>;
	      <span class="hljs-keyword">var</span> oppositeEdgePrev = oppositeEdge.<span class="hljs-property">prev</span>;
	      <span class="hljs-keyword">var</span> oppositeEdgeNext = oppositeEdge.<span class="hljs-property">next</span>; <span class="hljs-comment">// left edge</span>

	      <span class="hljs-keyword">while</span> (adjacentEdgePrev.<span class="hljs-property">opposite</span>.<span class="hljs-property">face</span> === oppositeFace) {
	        adjacentEdgePrev = adjacentEdgePrev.<span class="hljs-property">prev</span>;
	        oppositeEdgeNext = oppositeEdgeNext.<span class="hljs-property">next</span>;
	      } <span class="hljs-comment">// right edge</span>


	      <span class="hljs-keyword">while</span> (adjacentEdgeNext.<span class="hljs-property">opposite</span>.<span class="hljs-property">face</span> === oppositeFace) {
	        adjacentEdgeNext = adjacentEdgeNext.<span class="hljs-property">next</span>;
	        oppositeEdgePrev = oppositeEdgePrev.<span class="hljs-property">prev</span>;
	      } <span class="hljs-comment">// adjacentEdgePrev  \         face         / adjacentEdgeNext</span>
	      <span class="hljs-comment">//                    * ---- * ---- * ---- *</span>
	      <span class="hljs-comment">// oppositeEdgeNext  /     opposite face    \ oppositeEdgePrev</span>
	      <span class="hljs-comment">// fix the face reference of all the opposite edges that are not part of</span>
	      <span class="hljs-comment">// the edges whose opposite face is not `face` i.e. all the edges that</span>
	      <span class="hljs-comment">// `face` and `oppositeFace` do not have in common</span>


	      <span class="hljs-keyword">var</span> edge;

	      <span class="hljs-keyword">for</span> (edge = oppositeEdgeNext; edge !== oppositeEdgePrev.<span class="hljs-property">next</span>; edge = edge.<span class="hljs-property">next</span>) {
	        edge.<span class="hljs-property">face</span> = <span class="hljs-variable language_">this</span>;
	      } <span class="hljs-comment">// make sure that `face.edge` is not one of the edges to be destroyed</span>
	      <span class="hljs-comment">// Note: it&#x27;s important for it to be a `next` edge since `prev` edges</span>
	      <span class="hljs-comment">// might be destroyed on `connectHalfEdges`</span>


	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span> = adjacentEdgeNext; <span class="hljs-comment">// connect the extremes</span>
	      <span class="hljs-comment">// Note: it might be possible that after connecting the edges a triangular</span>
	      <span class="hljs-comment">// face might be redundant</span>

	      <span class="hljs-keyword">var</span> discardedFace;
	      discardedFace = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectHalfEdges</span>(oppositeEdgePrev, adjacentEdgeNext);

	      <span class="hljs-keyword">if</span> (discardedFace) {
	        discardedFaces.<span class="hljs-title function_">push</span>(discardedFace);
	      }

	      discardedFace = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectHalfEdges</span>(adjacentEdgePrev, oppositeEdgeNext);

	      <span class="hljs-keyword">if</span> (discardedFace) {
	        discardedFaces.<span class="hljs-title function_">push</span>(discardedFace);
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeNormalAndCentroid</span>(); <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> additional consistency checks</span>

	      <span class="hljs-keyword">return</span> discardedFaces;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;collectIndices&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">collectIndices</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">var</span> indices = [];
	      <span class="hljs-keyword">var</span> edge = <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>;

	      <span class="hljs-keyword">do</span> {
	        indices.<span class="hljs-title function_">push</span>(edge.<span class="hljs-title function_">head</span>().<span class="hljs-property">index</span>);
	        edge = edge.<span class="hljs-property">next</span>;
	      } <span class="hljs-keyword">while</span> (edge !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">edge</span>);

	      <span class="hljs-keyword">return</span> indices;
	    }
	  }], [{
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;createTriangle&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">createTriangle</span>(<span class="hljs-params">v0, v1, v2</span>) {
	      <span class="hljs-keyword">var</span> minArea = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">3</span>] !== <span class="hljs-literal">undefined</span> ? <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">3</span>] : <span class="hljs-number">0</span>;
	      <span class="hljs-keyword">var</span> face = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Face</span>();
	      <span class="hljs-keyword">var</span> e0 = <span class="hljs-keyword">new</span> _HalfEdge[<span class="hljs-string">&quot;default&quot;</span>](v0, face);
	      <span class="hljs-keyword">var</span> e1 = <span class="hljs-keyword">new</span> _HalfEdge[<span class="hljs-string">&quot;default&quot;</span>](v1, face);
	      <span class="hljs-keyword">var</span> e2 = <span class="hljs-keyword">new</span> _HalfEdge[<span class="hljs-string">&quot;default&quot;</span>](v2, face); <span class="hljs-comment">// join edges</span>

	      e0.<span class="hljs-property">next</span> = e2.<span class="hljs-property">prev</span> = e1;
	      e1.<span class="hljs-property">next</span> = e0.<span class="hljs-property">prev</span> = e2;
	      e2.<span class="hljs-property">next</span> = e1.<span class="hljs-property">prev</span> = e0; <span class="hljs-comment">// main half edge reference</span>

	      face.<span class="hljs-property">edge</span> = e0;
	      face.<span class="hljs-title function_">computeNormalAndCentroid</span>(minArea);

	      <span class="hljs-keyword">if</span> (debug.<span class="hljs-property">enabled</span>) {
	        <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;face created %j&#x27;</span>, face.<span class="hljs-title function_">collectIndices</span>());
	      }

	      <span class="hljs-keyword">return</span> face;
	    }
	  }]);

	  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Face</span>;
	}();

	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-title class_">Face</span>; 
} (<span class="hljs-title class_">Face</span>));

(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-built_in">exports</span></span>) {

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_typeof</span>(<span class="hljs-params">obj</span>) { <span class="hljs-string">&quot;@babel/helpers - typeof&quot;</span>; <span class="hljs-keyword">return</span> _typeof = <span class="hljs-string">&quot;function&quot;</span> == <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Symbol</span> &amp;&amp; <span class="hljs-string">&quot;symbol&quot;</span> == <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span> ? <span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> obj; } : <span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) { <span class="hljs-keyword">return</span> obj &amp;&amp; <span class="hljs-string">&quot;function&quot;</span> == <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Symbol</span> &amp;&amp; obj.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Symbol</span> &amp;&amp; obj !== <span class="hljs-title class_">Symbol</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> ? <span class="hljs-string">&quot;symbol&quot;</span> : <span class="hljs-keyword">typeof</span> obj; }, <span class="hljs-title function_">_typeof</span>(obj); }

	<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&quot;__esModule&quot;</span>, {
	  <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span>
	});
	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;

	<span class="hljs-keyword">var</span> _pointLineDistance = <span class="hljs-title function_">_interopRequireDefault</span>(pointLineDistance);

	<span class="hljs-keyword">var</span> _getPlaneNormal = <span class="hljs-title function_">_interopRequireDefault</span>(getPlaneNormal);

	<span class="hljs-keyword">var</span> _dot = <span class="hljs-title function_">_interopRequireDefault</span>(dot_1);

	<span class="hljs-keyword">var</span> _VertexList = <span class="hljs-title function_">_interopRequireDefault</span>(<span class="hljs-title class_">VertexList</span>);

	<span class="hljs-keyword">var</span> _Vertex = <span class="hljs-title function_">_interopRequireDefault</span>(<span class="hljs-title class_">Vertex</span>);

	<span class="hljs-keyword">var</span> _Face = <span class="hljs-title function_">_interopRequireWildcard</span>(<span class="hljs-title class_">Face</span>);

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_getRequireWildcardCache</span>(<span class="hljs-params">nodeInterop</span>) { <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">WeakMap</span> !== <span class="hljs-string">&quot;function&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-keyword">var</span> cacheBabelInterop = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>(); <span class="hljs-keyword">var</span> cacheNodeInterop = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>(); <span class="hljs-keyword">return</span> (_getRequireWildcardCache = <span class="hljs-keyword">function</span> <span class="hljs-title function_">_getRequireWildcardCache</span>(<span class="hljs-params">nodeInterop</span>) { <span class="hljs-keyword">return</span> nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_interopRequireWildcard</span>(<span class="hljs-params">obj, nodeInterop</span>) { <span class="hljs-keyword">if</span> (obj &amp;&amp; obj.<span class="hljs-property">__esModule</span>) { <span class="hljs-keyword">return</span> obj; } <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || <span class="hljs-title function_">_typeof</span>(obj) !== <span class="hljs-string">&quot;object&quot;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">&quot;function&quot;</span>) { <span class="hljs-keyword">return</span> { <span class="hljs-string">&quot;default&quot;</span>: obj }; } <span class="hljs-keyword">var</span> cache = <span class="hljs-title function_">_getRequireWildcardCache</span>(nodeInterop); <span class="hljs-keyword">if</span> (cache &amp;&amp; cache.<span class="hljs-title function_">has</span>(obj)) { <span class="hljs-keyword">return</span> cache.<span class="hljs-title function_">get</span>(obj); } <span class="hljs-keyword">var</span> newObj = {}; <span class="hljs-keyword">var</span> hasPropertyDescriptor = <span class="hljs-title class_">Object</span>.<span class="hljs-property">defineProperty</span> &amp;&amp; <span class="hljs-title class_">Object</span>.<span class="hljs-property">getOwnPropertyDescriptor</span>; <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> obj) { <span class="hljs-keyword">if</span> (key !== <span class="hljs-string">&quot;default&quot;</span> &amp;&amp; <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(obj, key)) { <span class="hljs-keyword">var</span> desc = hasPropertyDescriptor ? <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyDescriptor</span>(obj, key) : <span class="hljs-literal">null</span>; <span class="hljs-keyword">if</span> (desc &amp;&amp; (desc.<span class="hljs-property">get</span> || desc.<span class="hljs-property">set</span>)) { <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(newObj, key, desc); } <span class="hljs-keyword">else</span> { newObj[key] = obj[key]; } } } newObj[<span class="hljs-string">&quot;default&quot;</span>] = obj; <span class="hljs-keyword">if</span> (cache) { cache.<span class="hljs-title function_">set</span>(obj, newObj); } <span class="hljs-keyword">return</span> newObj; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_interopRequireDefault</span>(<span class="hljs-params">obj</span>) { <span class="hljs-keyword">return</span> obj &amp;&amp; obj.<span class="hljs-property">__esModule</span> ? obj : { <span class="hljs-string">&quot;default&quot;</span>: obj }; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_slicedToArray</span>(<span class="hljs-params">arr, i</span>) { <span class="hljs-keyword">return</span> <span class="hljs-title function_">_arrayWithHoles</span>(arr) || <span class="hljs-title function_">_iterableToArrayLimit</span>(arr, i) || <span class="hljs-title function_">_unsupportedIterableToArray</span>(arr, i) || <span class="hljs-title function_">_nonIterableRest</span>(); }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_nonIterableRest</span>(<span class="hljs-params"></span>) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.&quot;</span>); }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_unsupportedIterableToArray</span>(<span class="hljs-params">o, minLen</span>) { <span class="hljs-keyword">if</span> (!o) <span class="hljs-keyword">return</span>; <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> o === <span class="hljs-string">&quot;string&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-title function_">_arrayLikeToArray</span>(o, minLen); <span class="hljs-keyword">var</span> n = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(o).<span class="hljs-title function_">slice</span>(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>); <span class="hljs-keyword">if</span> (n === <span class="hljs-string">&quot;Object&quot;</span> &amp;&amp; o.<span class="hljs-property">constructor</span>) n = o.<span class="hljs-property">constructor</span>.<span class="hljs-property">name</span>; <span class="hljs-keyword">if</span> (n === <span class="hljs-string">&quot;Map&quot;</span> || n === <span class="hljs-string">&quot;Set&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(o); <span class="hljs-keyword">if</span> (n === <span class="hljs-string">&quot;Arguments&quot;</span> || <span class="hljs-regexp">/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/</span>.<span class="hljs-title function_">test</span>(n)) <span class="hljs-keyword">return</span> <span class="hljs-title function_">_arrayLikeToArray</span>(o, minLen); }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_arrayLikeToArray</span>(<span class="hljs-params">arr, len</span>) { <span class="hljs-keyword">if</span> (len == <span class="hljs-literal">null</span> || len &gt; arr.<span class="hljs-property">length</span>) len = arr.<span class="hljs-property">length</span>; <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, arr2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(len); i &lt; len; i++) { arr2[i] = arr[i]; } <span class="hljs-keyword">return</span> arr2; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_iterableToArrayLimit</span>(<span class="hljs-params">arr, i</span>) { <span class="hljs-keyword">var</span> _i = arr == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Symbol</span> !== <span class="hljs-string">&quot;undefined&quot;</span> &amp;&amp; arr[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] || arr[<span class="hljs-string">&quot;@@iterator&quot;</span>]; <span class="hljs-keyword">if</span> (_i == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>; <span class="hljs-keyword">var</span> _arr = []; <span class="hljs-keyword">var</span> _n = <span class="hljs-literal">true</span>; <span class="hljs-keyword">var</span> _d = <span class="hljs-literal">false</span>; <span class="hljs-keyword">var</span> _s, _e; <span class="hljs-keyword">try</span> { <span class="hljs-keyword">for</span> (_i = _i.<span class="hljs-title function_">call</span>(arr); !(_n = (_s = _i.<span class="hljs-title function_">next</span>()).<span class="hljs-property">done</span>); _n = <span class="hljs-literal">true</span>) { _arr.<span class="hljs-title function_">push</span>(_s.<span class="hljs-property">value</span>); <span class="hljs-keyword">if</span> (i &amp;&amp; _arr.<span class="hljs-property">length</span> === i) <span class="hljs-keyword">break</span>; } } <span class="hljs-keyword">catch</span> (err) { _d = <span class="hljs-literal">true</span>; _e = err; } <span class="hljs-keyword">finally</span> { <span class="hljs-keyword">try</span> { <span class="hljs-keyword">if</span> (!_n &amp;&amp; _i[<span class="hljs-string">&quot;return&quot;</span>] != <span class="hljs-literal">null</span>) _i[<span class="hljs-string">&quot;return&quot;</span>](); } <span class="hljs-keyword">finally</span> { <span class="hljs-keyword">if</span> (_d) <span class="hljs-keyword">throw</span> _e; } } <span class="hljs-keyword">return</span> _arr; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_arrayWithHoles</span>(<span class="hljs-params">arr</span>) { <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr)) <span class="hljs-keyword">return</span> arr; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-params">instance, Constructor</span>) { <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Constructor</span>)) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;Cannot call a class as a function&quot;</span>); } }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-params">target, props</span>) { <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; props.<span class="hljs-property">length</span>; i++) { <span class="hljs-keyword">var</span> descriptor = props[i]; descriptor.<span class="hljs-property">enumerable</span> = descriptor.<span class="hljs-property">enumerable</span> || <span class="hljs-literal">false</span>; descriptor.<span class="hljs-property">configurable</span> = <span class="hljs-literal">true</span>; <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;value&quot;</span> <span class="hljs-keyword">in</span> descriptor) descriptor.<span class="hljs-property">writable</span> = <span class="hljs-literal">true</span>; <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(target, descriptor.<span class="hljs-property">key</span>, descriptor); } }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_createClass</span>(<span class="hljs-params">Constructor, protoProps, staticProps</span>) { <span class="hljs-keyword">if</span> (protoProps) <span class="hljs-title function_">_defineProperties</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, protoProps); <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-title class_">Constructor</span>, <span class="hljs-string">&quot;prototype&quot;</span>, { <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span> }); <span class="hljs-keyword">return</span> <span class="hljs-title class_">Constructor</span>; }

	<span class="hljs-keyword">var</span> debug = <span class="hljs-title function_">srcExports</span>(<span class="hljs-string">&#x27;quickhull&#x27;</span>); <span class="hljs-comment">// merge types</span>
	<span class="hljs-comment">// non convex with respect to the large face</span>


	<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">MERGE_NON_CONVEX_WRT_LARGER_FACE</span> = <span class="hljs-number">1</span>;
	<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">MERGE_NON_CONVEX</span> = <span class="hljs-number">2</span>;

	<span class="hljs-keyword">var</span> <span class="hljs-title class_">QuickHull</span> = <span class="hljs-comment">/*#__PURE__*/</span><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
	  <span class="hljs-keyword">function</span> <span class="hljs-title function_">QuickHull</span>(<span class="hljs-params">points</span>) {
	    <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-title class_">QuickHull</span>);

	    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(points)) {
	      <span class="hljs-keyword">throw</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;input is not a valid array&#x27;</span>);
	    }

	    <span class="hljs-keyword">if</span> (points.<span class="hljs-property">length</span> &lt; <span class="hljs-number">4</span>) {
	      <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;cannot build a simplex out of &lt;4 points&#x27;</span>);
	    }

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span> = -<span class="hljs-number">1</span>; <span class="hljs-comment">// buffers</span>

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nFaces</span> = <span class="hljs-number">0</span>;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nPoints</span> = points.<span class="hljs-property">length</span>;
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span> = [];
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">newFaces</span> = []; <span class="hljs-comment">// helpers</span>
	    <span class="hljs-comment">//</span>
	    <span class="hljs-comment">// let `a`, `b` be `Face` instances</span>
	    <span class="hljs-comment">// let `v` be points wrapped as instance of `Vertex`</span>
	    <span class="hljs-comment">//</span>
	    <span class="hljs-comment">//     [v, v, ..., v, v, v, ...]</span>
	    <span class="hljs-comment">//      ^             ^</span>
	    <span class="hljs-comment">//      |             |</span>
	    <span class="hljs-comment">//  a.outside     b.outside</span>
	    <span class="hljs-comment">//</span>

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">claimed</span> = <span class="hljs-keyword">new</span> _VertexList[<span class="hljs-string">&quot;default&quot;</span>]();
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">unclaimed</span> = <span class="hljs-keyword">new</span> _VertexList[<span class="hljs-string">&quot;default&quot;</span>](); <span class="hljs-comment">// vertices of the hull(internal representation of points)</span>

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span> = [];

	    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; points.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> _Vertex[<span class="hljs-string">&quot;default&quot;</span>](points[i], i));
	    }

	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">discardedFaces</span> = [];
	    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertexPointIndices</span> = [];
	  }

	  <span class="hljs-title function_">_createClass</span>(<span class="hljs-title class_">QuickHull</span>, [{
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;addVertexToFace&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">addVertexToFace</span>(<span class="hljs-params">vertex, face</span>) {
	      vertex.<span class="hljs-property">face</span> = face;

	      <span class="hljs-keyword">if</span> (!face.<span class="hljs-property">outside</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">claimed</span>.<span class="hljs-title function_">add</span>(vertex);
	      } <span class="hljs-keyword">else</span> {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">claimed</span>.<span class="hljs-title function_">insertBefore</span>(face.<span class="hljs-property">outside</span>, vertex);
	      }

	      face.<span class="hljs-property">outside</span> = vertex;
	    }
	    <span class="hljs-comment">/**
	     * Removes `vertex` for the `claimed` list of vertices, it also makes sure
	     * that the link from `face` to the first vertex it sees in `claimed` is
	     * linked correctly after the removal
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Vertex</span>} <span class="hljs-variable">vertex</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Face</span>} <span class="hljs-variable">face</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;removeVertexFromFace&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">removeVertexFromFace</span>(<span class="hljs-params">vertex, face</span>) {
	      <span class="hljs-keyword">if</span> (vertex === face.<span class="hljs-property">outside</span>) {
	        <span class="hljs-comment">// fix face.outside link</span>
	        <span class="hljs-keyword">if</span> (vertex.<span class="hljs-property">next</span> &amp;&amp; vertex.<span class="hljs-property">next</span>.<span class="hljs-property">face</span> === face) {
	          <span class="hljs-comment">// face has at least 2 outside vertices, move the `outside` reference</span>
	          face.<span class="hljs-property">outside</span> = vertex.<span class="hljs-property">next</span>;
	        } <span class="hljs-keyword">else</span> {
	          <span class="hljs-comment">// vertex was the only outside vertex that face had</span>
	          face.<span class="hljs-property">outside</span> = <span class="hljs-literal">null</span>;
	        }
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">claimed</span>.<span class="hljs-title function_">remove</span>(vertex);
	    }
	    <span class="hljs-comment">/**
	     * Removes all the visible vertices that `face` is able to see which are
	     * stored in the `claimed` vertext list
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Face</span>} <span class="hljs-variable">face</span>
	     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Vertex|undefined</span>} If face had visible vertices returns
	     * `face.outside`, otherwise undefined
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;removeAllVerticesFromFace&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">removeAllVerticesFromFace</span>(<span class="hljs-params">face</span>) {
	      <span class="hljs-keyword">if</span> (face.<span class="hljs-property">outside</span>) {
	        <span class="hljs-comment">// pointer to the last vertex of this face</span>
	        <span class="hljs-comment">// [..., outside, ..., end, outside, ...]</span>
	        <span class="hljs-comment">//          |           |      |</span>
	        <span class="hljs-comment">//          a           a      b</span>
	        <span class="hljs-keyword">var</span> end = face.<span class="hljs-property">outside</span>;

	        <span class="hljs-keyword">while</span> (end.<span class="hljs-property">next</span> &amp;&amp; end.<span class="hljs-property">next</span>.<span class="hljs-property">face</span> === face) {
	          end = end.<span class="hljs-property">next</span>;
	        }

	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">claimed</span>.<span class="hljs-title function_">removeChain</span>(face.<span class="hljs-property">outside</span>, end); <span class="hljs-comment">//                            b</span>
	        <span class="hljs-comment">//                       [ outside, ...]</span>
	        <span class="hljs-comment">//                            |  removes this link</span>
	        <span class="hljs-comment">//     [ outside, ..., end ] -</span>
	        <span class="hljs-comment">//          |           |</span>
	        <span class="hljs-comment">//          a           a</span>

	        end.<span class="hljs-property">next</span> = <span class="hljs-literal">null</span>;
	        <span class="hljs-keyword">return</span> face.<span class="hljs-property">outside</span>;
	      }
	    }
	    <span class="hljs-comment">/**
	     * Removes all the visible vertices that `face` is able to see, additionally
	     * checking the following:
	     *
	     * If `absorbingFace` doesn&#x27;t exist then all the removed vertices will be
	     * added to the `unclaimed` vertex list
	     *
	     * If `absorbingFace` exists then this method will assign all the vertices of
	     * `face` that can see `absorbingFace`, if a vertex cannot see `absorbingFace`
	     * it&#x27;s added to the `unclaimed` vertex list
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Face</span>} <span class="hljs-variable">face</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Face</span>} [absorbingFace]
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;deleteFaceVertices&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">deleteFaceVertices</span>(<span class="hljs-params">face, absorbingFace</span>) {
	      <span class="hljs-keyword">var</span> faceVertices = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeAllVerticesFromFace</span>(face);

	      <span class="hljs-keyword">if</span> (faceVertices) {
	        <span class="hljs-keyword">if</span> (!absorbingFace) {
	          <span class="hljs-comment">// mark the vertices to be reassigned to some other face</span>
	          <span class="hljs-variable language_">this</span>.<span class="hljs-property">unclaimed</span>.<span class="hljs-title function_">addAll</span>(faceVertices);
	        } <span class="hljs-keyword">else</span> {
	          <span class="hljs-comment">// if there&#x27;s an absorbing face try to assign as many vertices</span>
	          <span class="hljs-comment">// as possible to it</span>
	          <span class="hljs-comment">// the reference `vertex.next` might be destroyed on</span>
	          <span class="hljs-comment">// `this.addVertexToFace` (see VertexList#add), nextVertex is a</span>
	          <span class="hljs-comment">// reference to it</span>
	          <span class="hljs-keyword">var</span> nextVertex;

	          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> vertex = faceVertices; vertex; vertex = nextVertex) {
	            nextVertex = vertex.<span class="hljs-property">next</span>;
	            <span class="hljs-keyword">var</span> distance = absorbingFace.<span class="hljs-title function_">distanceToPlane</span>(vertex.<span class="hljs-property">point</span>); <span class="hljs-comment">// check if `vertex` is able to see `absorbingFace`</span>

	            <span class="hljs-keyword">if</span> (distance &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>) {
	              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addVertexToFace</span>(vertex, absorbingFace);
	            } <span class="hljs-keyword">else</span> {
	              <span class="hljs-variable language_">this</span>.<span class="hljs-property">unclaimed</span>.<span class="hljs-title function_">add</span>(vertex);
	            }
	          }
	        }
	      }
	    }
	    <span class="hljs-comment">/**
	     * Reassigns as many vertices as possible from the unclaimed list to the new
	     * faces
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Faces[]</span>} <span class="hljs-variable">newFaces</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;resolveUnclaimedPoints&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">resolveUnclaimedPoints</span>(<span class="hljs-params">newFaces</span>) {
	      <span class="hljs-comment">// cache next vertex so that if `vertex.next` is destroyed it&#x27;s still</span>
	      <span class="hljs-comment">// recoverable</span>
	      <span class="hljs-keyword">var</span> vertexNext = <span class="hljs-variable language_">this</span>.<span class="hljs-property">unclaimed</span>.<span class="hljs-title function_">first</span>();

	      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> vertex = vertexNext; vertex; vertex = vertexNext) {
	        vertexNext = vertex.<span class="hljs-property">next</span>;
	        <span class="hljs-keyword">var</span> maxDistance = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>;
	        <span class="hljs-keyword">var</span> maxFace = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;

	        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; newFaces.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	          <span class="hljs-keyword">var</span> face = newFaces[i];

	          <span class="hljs-keyword">if</span> (face.<span class="hljs-property">mark</span> === _Face.<span class="hljs-property">VISIBLE</span>) {
	            <span class="hljs-keyword">var</span> dist = face.<span class="hljs-title function_">distanceToPlane</span>(vertex.<span class="hljs-property">point</span>);

	            <span class="hljs-keyword">if</span> (dist &gt; maxDistance) {
	              maxDistance = dist;
	              maxFace = face;
	            }

	            <span class="hljs-keyword">if</span> (maxDistance &gt; <span class="hljs-number">1000</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>) {
	              <span class="hljs-keyword">break</span>;
	            }
	          }
	        }

	        <span class="hljs-keyword">if</span> (maxFace) {
	          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addVertexToFace</span>(vertex, maxFace);
	        }
	      }
	    }
	    <span class="hljs-comment">/**
	     * Computes the extremes of a tetrahedron which will be the initial hull
	     *
	     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">number[]</span>} The min/max vertices in the x,y,z directions
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;computeExtremes&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computeExtremes</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">var</span> me = <span class="hljs-variable language_">this</span>;
	      <span class="hljs-keyword">var</span> min = [];
	      <span class="hljs-keyword">var</span> max = []; <span class="hljs-comment">// min vertex on the x,y,z directions</span>

	      <span class="hljs-keyword">var</span> minVertices = []; <span class="hljs-comment">// max vertex on the x,y,z directions</span>

	      <span class="hljs-keyword">var</span> maxVertices = [];
	      <span class="hljs-keyword">var</span> i, j; <span class="hljs-comment">// initially assume that the first vertex is the min/max</span>

	      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i += <span class="hljs-number">1</span>) {
	        minVertices[i] = maxVertices[i] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>[<span class="hljs-number">0</span>];
	      } <span class="hljs-comment">// copy the coordinates of the first vertex to min/max</span>


	      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i += <span class="hljs-number">1</span>) {
	        min[i] = max[i] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">point</span>[i];
	      } <span class="hljs-comment">// compute the min/max vertex on all 6 directions</span>


	      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> vertex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>[i];
	        <span class="hljs-keyword">var</span> point = vertex.<span class="hljs-property">point</span>; <span class="hljs-comment">// update the min coordinates</span>

	        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j += <span class="hljs-number">1</span>) {
	          <span class="hljs-keyword">if</span> (point[j] &lt; min[j]) {
	            min[j] = point[j];
	            minVertices[j] = vertex;
	          }
	        } <span class="hljs-comment">// update the max coordinates</span>


	        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j += <span class="hljs-number">1</span>) {
	          <span class="hljs-keyword">if</span> (point[j] &gt; max[j]) {
	            max[j] = point[j];
	            maxVertices[j] = vertex;
	          }
	        }
	      } <span class="hljs-comment">// compute epsilon</span>


	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span> = <span class="hljs-number">3</span> * <span class="hljs-title class_">Number</span>.<span class="hljs-property">EPSILON</span> * (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(min[<span class="hljs-number">0</span>]), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(max[<span class="hljs-number">0</span>])) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(min[<span class="hljs-number">1</span>]), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(max[<span class="hljs-number">1</span>])) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(min[<span class="hljs-number">2</span>]), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(max[<span class="hljs-number">2</span>])));

	      <span class="hljs-keyword">if</span> (debug.<span class="hljs-property">enabled</span>) {
	        <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;tolerance %d&#x27;</span>, me.<span class="hljs-property">tolerance</span>);
	      }

	      <span class="hljs-keyword">return</span> [minVertices, maxVertices];
	    }
	    <span class="hljs-comment">/**
	     * Compues the initial tetrahedron assigning to its faces all the points that
	     * are candidates to form part of the hull
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;createInitialSimplex&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">createInitialSimplex</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">var</span> vertices = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>;

	      <span class="hljs-keyword">var</span> _this$computeExtremes = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeExtremes</span>(),
	          _this$computeExtremes2 = <span class="hljs-title function_">_slicedToArray</span>(_this$computeExtremes, <span class="hljs-number">2</span>),
	          min = _this$computeExtremes2[<span class="hljs-number">0</span>],
	          max = _this$computeExtremes2[<span class="hljs-number">1</span>];

	      <span class="hljs-keyword">var</span> i, j; <span class="hljs-comment">// Find the two vertices with the greatest 1d separation</span>
	      <span class="hljs-comment">// (max.x - min.x)</span>
	      <span class="hljs-comment">// (max.y - min.y)</span>
	      <span class="hljs-comment">// (max.z - min.z)</span>

	      <span class="hljs-keyword">var</span> maxDistance = <span class="hljs-number">0</span>;
	      <span class="hljs-keyword">var</span> indexMax = <span class="hljs-number">0</span>;

	      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> distance = max[i].<span class="hljs-property">point</span>[i] - min[i].<span class="hljs-property">point</span>[i];

	        <span class="hljs-keyword">if</span> (distance &gt; maxDistance) {
	          maxDistance = distance;
	          indexMax = i;
	        }
	      }

	      <span class="hljs-keyword">var</span> v0 = min[indexMax];
	      <span class="hljs-keyword">var</span> v1 = max[indexMax];
	      <span class="hljs-keyword">var</span> v2, v3; <span class="hljs-comment">// the next vertex is the one farthest to the line formed by `v0` and `v1`</span>

	      maxDistance = <span class="hljs-number">0</span>;

	      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> vertex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>[i];

	        <span class="hljs-keyword">if</span> (vertex !== v0 &amp;&amp; vertex !== v1) {
	          <span class="hljs-keyword">var</span> _distance = (<span class="hljs-number">0</span>, _pointLineDistance[<span class="hljs-string">&quot;default&quot;</span>])(vertex.<span class="hljs-property">point</span>, v0.<span class="hljs-property">point</span>, v1.<span class="hljs-property">point</span>);

	          <span class="hljs-keyword">if</span> (_distance &gt; maxDistance) {
	            maxDistance = _distance;
	            v2 = vertex;
	          }
	        }
	      } <span class="hljs-comment">// the next vertes is the one farthest to the plane `v0`, `v1`, `v2`</span>
	      <span class="hljs-comment">// normalize((v2 - v1) x (v0 - v1))</span>


	      <span class="hljs-keyword">var</span> normal = (<span class="hljs-number">0</span>, _getPlaneNormal[<span class="hljs-string">&quot;default&quot;</span>])([], v0.<span class="hljs-property">point</span>, v1.<span class="hljs-property">point</span>, v2.<span class="hljs-property">point</span>); <span class="hljs-comment">// distance from the origin to the plane</span>

	      <span class="hljs-keyword">var</span> distPO = (<span class="hljs-number">0</span>, _dot[<span class="hljs-string">&quot;default&quot;</span>])(v0.<span class="hljs-property">point</span>, normal);
	      maxDistance = -<span class="hljs-number">1</span>;

	      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> _vertex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>[i];

	        <span class="hljs-keyword">if</span> (_vertex !== v0 &amp;&amp; _vertex !== v1 &amp;&amp; _vertex !== v2) {
	          <span class="hljs-keyword">var</span> _distance2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>((<span class="hljs-number">0</span>, _dot[<span class="hljs-string">&quot;default&quot;</span>])(normal, _vertex.<span class="hljs-property">point</span>) - distPO);

	          <span class="hljs-keyword">if</span> (_distance2 &gt; maxDistance) {
	            maxDistance = _distance2;
	            v3 = _vertex;
	          }
	        }
	      } <span class="hljs-comment">// initial simplex</span>
	      <span class="hljs-comment">// Taken from http://everything2.com/title/How+to+paint+a+tetrahedron</span>
	      <span class="hljs-comment">//</span>
	      <span class="hljs-comment">//                              v2</span>
	      <span class="hljs-comment">//                             ,|,</span>
	      <span class="hljs-comment">//                           ,7``\&#x27;VA,</span>
	      <span class="hljs-comment">//                         ,7`   |, `&#x27;VA,</span>
	      <span class="hljs-comment">//                       ,7`     `\    `&#x27;VA,</span>
	      <span class="hljs-comment">//                     ,7`        |,      `&#x27;VA,</span>
	      <span class="hljs-comment">//                   ,7`          `\         `&#x27;VA,</span>
	      <span class="hljs-comment">//                 ,7`             |,           `&#x27;VA,</span>
	      <span class="hljs-comment">//               ,7`               `\       ,..ooOOTK` v3</span>
	      <span class="hljs-comment">//             ,7`                  |,.ooOOT&#x27;&#x27;`    AV</span>
	      <span class="hljs-comment">//           ,7`            ,..ooOOT`\`           /7</span>
	      <span class="hljs-comment">//         ,7`      ,..ooOOT&#x27;&#x27;`      |,          AV</span>
	      <span class="hljs-comment">//        ,T,..ooOOT&#x27;&#x27;`              `\         /7</span>
	      <span class="hljs-comment">//     v0 `&#x27;TTs.,                     |,       AV</span>
	      <span class="hljs-comment">//            `&#x27;TTs.,                 `\      /7</span>
	      <span class="hljs-comment">//                 `&#x27;TTs.,             |,    AV</span>
	      <span class="hljs-comment">//                      `&#x27;TTs.,        `\   /7</span>
	      <span class="hljs-comment">//                           `&#x27;TTs.,    |, AV</span>
	      <span class="hljs-comment">//                                `&#x27;TTs.,\/7</span>
	      <span class="hljs-comment">//                                     `&#x27;T`</span>
	      <span class="hljs-comment">//                                       v1</span>
	      <span class="hljs-comment">//</span>


	      <span class="hljs-keyword">var</span> faces = [];

	      <span class="hljs-keyword">if</span> ((<span class="hljs-number">0</span>, _dot[<span class="hljs-string">&quot;default&quot;</span>])(v3.<span class="hljs-property">point</span>, normal) - distPO &lt; <span class="hljs-number">0</span>) {
	        <span class="hljs-comment">// the face is not able to see the point so `planeNormal`</span>
	        <span class="hljs-comment">// is pointing outside the tetrahedron</span>
	        faces.<span class="hljs-title function_">push</span>(_Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(v0, v1, v2), _Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(v3, v1, v0), _Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(v3, v2, v1), _Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(v3, v0, v2)); <span class="hljs-comment">// set the opposite edge</span>

	        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i += <span class="hljs-number">1</span>) {
	          <span class="hljs-keyword">var</span> _j = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">3</span>; <span class="hljs-comment">// join face[i] i &gt; 0, with the first face</span>


	          faces[i + <span class="hljs-number">1</span>].<span class="hljs-title function_">getEdge</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">setOpposite</span>(faces[<span class="hljs-number">0</span>].<span class="hljs-title function_">getEdge</span>(_j)); <span class="hljs-comment">// join face[i] with face[i + 1], 1 &lt;= i &lt;= 3</span>

	          faces[i + <span class="hljs-number">1</span>].<span class="hljs-title function_">getEdge</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">setOpposite</span>(faces[_j + <span class="hljs-number">1</span>].<span class="hljs-title function_">getEdge</span>(<span class="hljs-number">0</span>));
	        }
	      } <span class="hljs-keyword">else</span> {
	        <span class="hljs-comment">// the face is able to see the point so `planeNormal`</span>
	        <span class="hljs-comment">// is pointing inside the tetrahedron</span>
	        faces.<span class="hljs-title function_">push</span>(_Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(v0, v2, v1), _Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(v3, v0, v1), _Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(v3, v1, v2), _Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(v3, v2, v0)); <span class="hljs-comment">// set the opposite edge</span>

	        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i += <span class="hljs-number">1</span>) {
	          <span class="hljs-keyword">var</span> _j2 = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">3</span>; <span class="hljs-comment">// join face[i] i &gt; 0, with the first face</span>


	          faces[i + <span class="hljs-number">1</span>].<span class="hljs-title function_">getEdge</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">setOpposite</span>(faces[<span class="hljs-number">0</span>].<span class="hljs-title function_">getEdge</span>((<span class="hljs-number">3</span> - i) % <span class="hljs-number">3</span>)); <span class="hljs-comment">// join face[i] with face[i + 1]</span>

	          faces[i + <span class="hljs-number">1</span>].<span class="hljs-title function_">getEdge</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">setOpposite</span>(faces[_j2 + <span class="hljs-number">1</span>].<span class="hljs-title function_">getEdge</span>(<span class="hljs-number">1</span>));
	        }
	      } <span class="hljs-comment">// the initial hull is the tetrahedron</span>


	      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span>.<span class="hljs-title function_">push</span>(faces[i]);
	      } <span class="hljs-comment">// initial assignment of vertices to the faces of the tetrahedron</span>


	      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; vertices.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> _vertex2 = vertices[i];

	        <span class="hljs-keyword">if</span> (_vertex2 !== v0 &amp;&amp; _vertex2 !== v1 &amp;&amp; _vertex2 !== v2 &amp;&amp; _vertex2 !== v3) {
	          maxDistance = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>;
	          <span class="hljs-keyword">var</span> maxFace = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;

	          <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j += <span class="hljs-number">1</span>) {
	            <span class="hljs-keyword">var</span> _distance3 = faces[j].<span class="hljs-title function_">distanceToPlane</span>(_vertex2.<span class="hljs-property">point</span>);

	            <span class="hljs-keyword">if</span> (_distance3 &gt; maxDistance) {
	              maxDistance = _distance3;
	              maxFace = faces[j];
	            }
	          }

	          <span class="hljs-keyword">if</span> (maxFace) {
	            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addVertexToFace</span>(_vertex2, maxFace);
	          }
	        }
	      }
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;reindexFaceAndVertices&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reindexFaceAndVertices</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-comment">// remove inactive faces</span>
	      <span class="hljs-keyword">var</span> activeFaces = [];

	      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span>.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> face = <span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span>[i];

	        <span class="hljs-keyword">if</span> (face.<span class="hljs-property">mark</span> === _Face.<span class="hljs-property">VISIBLE</span>) {
	          activeFaces.<span class="hljs-title function_">push</span>(face);
	        }
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span> = activeFaces;
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;collectFaces&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">collectFaces</span>(<span class="hljs-params">skipTriangulation</span>) {
	      <span class="hljs-keyword">var</span> faceIndices = [];

	      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span>.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span>[i].<span class="hljs-property">mark</span> !== _Face.<span class="hljs-property">VISIBLE</span>) {
	          <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;attempt to include a destroyed face in the hull&#x27;</span>);
	        }

	        <span class="hljs-keyword">var</span> indices = <span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span>[i].<span class="hljs-title function_">collectIndices</span>();

	        <span class="hljs-keyword">if</span> (skipTriangulation) {
	          faceIndices.<span class="hljs-title function_">push</span>(indices);
	        } <span class="hljs-keyword">else</span> {
	          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; indices.<span class="hljs-property">length</span> - <span class="hljs-number">2</span>; j += <span class="hljs-number">1</span>) {
	            faceIndices.<span class="hljs-title function_">push</span>([indices[<span class="hljs-number">0</span>], indices[j + <span class="hljs-number">1</span>], indices[j + <span class="hljs-number">2</span>]]);
	          }
	        }
	      }

	      <span class="hljs-keyword">return</span> faceIndices;
	    }
	    <span class="hljs-comment">/**
	     * Finds the next vertex to make faces with the current hull
	     *
	     * - let `face` be the first face existing in the `claimed` vertex list
	     *  - if `face` doesn&#x27;t exist then return since there&#x27;re no vertices left
	     *  - otherwise for each `vertex` that face sees find the one furthest away
	     *  from `face`
	     *
	     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Vertex|undefined</span>} Returns undefined when there&#x27;re no more
	     * visible vertices
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;nextVertexToAdd&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">nextVertexToAdd</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">claimed</span>.<span class="hljs-title function_">isEmpty</span>()) {
	        <span class="hljs-keyword">var</span> eyeVertex, vertex;
	        <span class="hljs-keyword">var</span> maxDistance = <span class="hljs-number">0</span>;
	        <span class="hljs-keyword">var</span> eyeFace = <span class="hljs-variable language_">this</span>.<span class="hljs-property">claimed</span>.<span class="hljs-title function_">first</span>().<span class="hljs-property">face</span>;

	        <span class="hljs-keyword">for</span> (vertex = eyeFace.<span class="hljs-property">outside</span>; vertex &amp;&amp; vertex.<span class="hljs-property">face</span> === eyeFace; vertex = vertex.<span class="hljs-property">next</span>) {
	          <span class="hljs-keyword">var</span> distance = eyeFace.<span class="hljs-title function_">distanceToPlane</span>(vertex.<span class="hljs-property">point</span>);

	          <span class="hljs-keyword">if</span> (distance &gt; maxDistance) {
	            maxDistance = distance;
	            eyeVertex = vertex;
	          }
	        }

	        <span class="hljs-keyword">return</span> eyeVertex;
	      }
	    }
	    <span class="hljs-comment">/**
	     * Computes a chain of half edges in ccw order called the `horizon`, for an
	     * edge to be part of the horizon it must join a face that can see
	     * `eyePoint` and a face that cannot see `eyePoint`
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">eyePoint</span> - The coordinates of a point
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HalfEdge</span>} <span class="hljs-variable">crossEdge</span> - The edge used to jump to the current `face`
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Face</span>} <span class="hljs-variable">face</span> - The current face being tested
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HalfEdge[]</span>} <span class="hljs-variable">horizon</span> - The edges that form part of the horizon in
	     * ccw order
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;computeHorizon&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computeHorizon</span>(<span class="hljs-params">eyePoint, crossEdge, face, horizon</span>) {
	      <span class="hljs-comment">// moves face&#x27;s vertices to the `unclaimed` vertex list</span>
	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">deleteFaceVertices</span>(face);
	      face.<span class="hljs-property">mark</span> = _Face.<span class="hljs-property">DELETED</span>;
	      <span class="hljs-keyword">var</span> edge;

	      <span class="hljs-keyword">if</span> (!crossEdge) {
	        edge = crossEdge = face.<span class="hljs-title function_">getEdge</span>(<span class="hljs-number">0</span>);
	      } <span class="hljs-keyword">else</span> {
	        <span class="hljs-comment">// start from the next edge since `crossEdge` was already analyzed</span>
	        <span class="hljs-comment">// (actually `crossEdge.opposite` was the face who called this method</span>
	        <span class="hljs-comment">// recursively)</span>
	        edge = crossEdge.<span class="hljs-property">next</span>;
	      } <span class="hljs-comment">// All the faces that are able to see `eyeVertex` are defined as follows</span>
	      <span class="hljs-comment">//</span>
	      <span class="hljs-comment">//       v    /</span>
	      <span class="hljs-comment">//           / &lt;== visible face</span>
	      <span class="hljs-comment">//          /</span>
	      <span class="hljs-comment">//         |</span>
	      <span class="hljs-comment">//         | &lt;== not visible face</span>
	      <span class="hljs-comment">//</span>
	      <span class="hljs-comment">//  dot(v, visible face normal) - visible face offset &gt; this.tolerance</span>
	      <span class="hljs-comment">//</span>


	      <span class="hljs-keyword">do</span> {
	        <span class="hljs-keyword">var</span> oppositeEdge = edge.<span class="hljs-property">opposite</span>;
	        <span class="hljs-keyword">var</span> oppositeFace = oppositeEdge.<span class="hljs-property">face</span>;

	        <span class="hljs-keyword">if</span> (oppositeFace.<span class="hljs-property">mark</span> === _Face.<span class="hljs-property">VISIBLE</span>) {
	          <span class="hljs-keyword">if</span> (oppositeFace.<span class="hljs-title function_">distanceToPlane</span>(eyePoint) &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>) {
	            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHorizon</span>(eyePoint, oppositeEdge, oppositeFace, horizon);
	          } <span class="hljs-keyword">else</span> {
	            horizon.<span class="hljs-title function_">push</span>(edge);
	          }
	        }

	        edge = edge.<span class="hljs-property">next</span>;
	      } <span class="hljs-keyword">while</span> (edge !== crossEdge);
	    }
	    <span class="hljs-comment">/**
	     * Creates a face with the points `eyeVertex.point`, `horizonEdge.tail` and
	     * `horizonEdge.tail` in ccw order
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Vertex</span>} <span class="hljs-variable">eyeVertex</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HalfEdge</span>} <span class="hljs-variable">horizonEdge</span>
	     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">HalfEdge</span>} The half edge whose vertex is the eyeVertex
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;addAdjoiningFace&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">addAdjoiningFace</span>(<span class="hljs-params">eyeVertex, horizonEdge</span>) {
	      <span class="hljs-comment">// all the half edges are created in ccw order thus the face is always</span>
	      <span class="hljs-comment">// pointing outside the hull</span>
	      <span class="hljs-comment">// edges:</span>
	      <span class="hljs-comment">//</span>
	      <span class="hljs-comment">//                  eyeVertex.point</span>
	      <span class="hljs-comment">//                       / \</span>
	      <span class="hljs-comment">//                      /   \</span>
	      <span class="hljs-comment">//                  1  /     \  0</span>
	      <span class="hljs-comment">//                    /       \</span>
	      <span class="hljs-comment">//                   /         \</span>
	      <span class="hljs-comment">//                  /           \</span>
	      <span class="hljs-comment">//          horizon.tail --- horizon.head</span>
	      <span class="hljs-comment">//                        2</span>
	      <span class="hljs-comment">//</span>
	      <span class="hljs-keyword">var</span> face = _Face[<span class="hljs-string">&quot;default&quot;</span>].<span class="hljs-title function_">createTriangle</span>(eyeVertex, horizonEdge.<span class="hljs-title function_">tail</span>(), horizonEdge.<span class="hljs-title function_">head</span>());

	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">faces</span>.<span class="hljs-title function_">push</span>(face); <span class="hljs-comment">// join face.getEdge(-1) with the horizon&#x27;s opposite edge</span>
	      <span class="hljs-comment">// face.getEdge(-1) = face.getEdge(2)</span>

	      face.<span class="hljs-title function_">getEdge</span>(-<span class="hljs-number">1</span>).<span class="hljs-title function_">setOpposite</span>(horizonEdge.<span class="hljs-property">opposite</span>);
	      <span class="hljs-keyword">return</span> face.<span class="hljs-title function_">getEdge</span>(<span class="hljs-number">0</span>);
	    }
	    <span class="hljs-comment">/**
	     * Adds horizon.length faces to the hull, each face will be &#x27;linked&#x27; with the
	     * horizon opposite face and the face on the left/right
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Vertex</span>} <span class="hljs-variable">eyeVertex</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HalfEdge[]</span>} <span class="hljs-variable">horizon</span> - A chain of half edges in ccw order
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;addNewFaces&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">addNewFaces</span>(<span class="hljs-params">eyeVertex, horizon</span>) {
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">newFaces</span> = [];
	      <span class="hljs-keyword">var</span> firstSideEdge, previousSideEdge;

	      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; horizon.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> horizonEdge = horizon[i]; <span class="hljs-comment">// returns the right side edge</span>

	        <span class="hljs-keyword">var</span> sideEdge = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addAdjoiningFace</span>(eyeVertex, horizonEdge);

	        <span class="hljs-keyword">if</span> (!firstSideEdge) {
	          firstSideEdge = sideEdge;
	        } <span class="hljs-keyword">else</span> {
	          <span class="hljs-comment">// joins face.getEdge(1) with previousFace.getEdge(0)</span>
	          sideEdge.<span class="hljs-property">next</span>.<span class="hljs-title function_">setOpposite</span>(previousSideEdge);
	        }

	        <span class="hljs-variable language_">this</span>.<span class="hljs-property">newFaces</span>.<span class="hljs-title function_">push</span>(sideEdge.<span class="hljs-property">face</span>);
	        previousSideEdge = sideEdge;
	      }

	      firstSideEdge.<span class="hljs-property">next</span>.<span class="hljs-title function_">setOpposite</span>(previousSideEdge);
	    }
	    <span class="hljs-comment">/**
	     * Computes the distance from `edge` opposite face&#x27;s centroid to
	     * `edge.face`
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HalfEdge</span>} <span class="hljs-variable">edge</span>
	     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">number</span>}
	     * - A positive number when the centroid of the opposite face is above the
	     *   face i.e. when the faces are concave
	     * - A negative number when the centroid of the opposite face is below the
	     *   face i.e. when the faces are convex
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;oppositeFaceDistance&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">oppositeFaceDistance</span>(<span class="hljs-params">edge</span>) {
	      <span class="hljs-keyword">return</span> edge.<span class="hljs-property">face</span>.<span class="hljs-title function_">distanceToPlane</span>(edge.<span class="hljs-property">opposite</span>.<span class="hljs-property">face</span>.<span class="hljs-property">centroid</span>);
	    }
	    <span class="hljs-comment">/**
	     * Merges a face with none/any/all its neighbors according to the strategy
	     * used
	     *
	     * if `mergeType` is MERGE_NON_CONVEX_WRT_LARGER_FACE then the merge will be
	     * decided based on the face with the larger area, the centroid of the face
	     * with the smaller area will be checked against the one with the larger area
	     * to see if it&#x27;s in the merge range [tolerance, -tolerance] i.e.
	     *
	     *    dot(centroid smaller face, larger face normal) - larger face offset &gt; -tolerance
	     *
	     * Note that the first check (with +tolerance) was done on `computeHorizon`
	     *
	     * If the above is not true then the check is done with respect to the smaller
	     * face i.e.
	     *
	     *    dot(centroid larger face, smaller face normal) - smaller face offset &gt; -tolerance
	     *
	     * If true then it means that two faces are non convex (concave), even if the
	     * dot(...) - offset value is &gt; 0 (that&#x27;s the point of doing the merge in the
	     * first place)
	     *
	     * If two faces are concave then the check must also be done on the other face
	     * but this is done in another merge pass, for this to happen the face is
	     * marked in a temporal NON_CONVEX state
	     *
	     * if `mergeType` is MERGE_NON_CONVEX then two faces will be merged only if
	     * they pass the following conditions
	     *
	     *    dot(centroid smaller face, larger face normal) - larger face offset &gt; -tolerance
	     *    dot(centroid larger face, smaller face normal) - smaller face offset &gt; -tolerance
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Face</span>} <span class="hljs-variable">face</span>
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">mergeType</span> - Either MERGE_NON_CONVEX_WRT_LARGER_FACE or
	     * MERGE_NON_CONVEX
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;doAdjacentMerge&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">doAdjacentMerge</span>(<span class="hljs-params">face, mergeType</span>) {
	      <span class="hljs-keyword">var</span> edge = face.<span class="hljs-property">edge</span>;
	      <span class="hljs-keyword">var</span> convex = <span class="hljs-literal">true</span>;
	      <span class="hljs-keyword">var</span> it = <span class="hljs-number">0</span>;

	      <span class="hljs-keyword">do</span> {
	        <span class="hljs-keyword">if</span> (it &gt;= face.<span class="hljs-property">nVertices</span>) {
	          <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;merge recursion limit exceeded&#x27;</span>);
	        }

	        <span class="hljs-keyword">var</span> oppositeFace = edge.<span class="hljs-property">opposite</span>.<span class="hljs-property">face</span>;
	        <span class="hljs-keyword">var</span> merge = <span class="hljs-literal">false</span>; <span class="hljs-comment">// Important notes about the algorithm to merge faces</span>
	        <span class="hljs-comment">//</span>
	        <span class="hljs-comment">// - Given a vertex `eyeVertex` that will be added to the hull</span>
	        <span class="hljs-comment">//   all the faces that cannot see `eyeVertex` are defined as follows</span>
	        <span class="hljs-comment">//</span>
	        <span class="hljs-comment">//      dot(v, not visible face normal) - not visible offset &lt; tolerance</span>
	        <span class="hljs-comment">//</span>
	        <span class="hljs-comment">// - Two faces can be merged when the centroid of one of these faces</span>
	        <span class="hljs-comment">// projected to the normal of the other face minus the other face offset</span>
	        <span class="hljs-comment">// is in the range [tolerance, -tolerance]</span>
	        <span class="hljs-comment">// - Since `face` (given in the input for this method) has passed the</span>
	        <span class="hljs-comment">// check above we only have to check the lower bound e.g.</span>
	        <span class="hljs-comment">//</span>
	        <span class="hljs-comment">//      dot(v, not visible face normal) - not visible offset &gt; -tolerance</span>
	        <span class="hljs-comment">//</span>

	        <span class="hljs-keyword">if</span> (mergeType === <span class="hljs-variable constant_">MERGE_NON_CONVEX</span>) {
	          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">oppositeFaceDistance</span>(edge) &gt; -<span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">oppositeFaceDistance</span>(edge.<span class="hljs-property">opposite</span>) &gt; -<span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>) {
	            merge = <span class="hljs-literal">true</span>;
	          }
	        } <span class="hljs-keyword">else</span> {
	          <span class="hljs-keyword">if</span> (face.<span class="hljs-property">area</span> &gt; oppositeFace.<span class="hljs-property">area</span>) {
	            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">oppositeFaceDistance</span>(edge) &gt; -<span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>) {
	              merge = <span class="hljs-literal">true</span>;
	            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">oppositeFaceDistance</span>(edge.<span class="hljs-property">opposite</span>) &gt; -<span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>) {
	              convex = <span class="hljs-literal">false</span>;
	            }
	          } <span class="hljs-keyword">else</span> {
	            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">oppositeFaceDistance</span>(edge.<span class="hljs-property">opposite</span>) &gt; -<span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>) {
	              merge = <span class="hljs-literal">true</span>;
	            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">oppositeFaceDistance</span>(edge) &gt; -<span class="hljs-variable language_">this</span>.<span class="hljs-property">tolerance</span>) {
	              convex = <span class="hljs-literal">false</span>;
	            }
	          }
	        }

	        <span class="hljs-keyword">if</span> (merge) {
	          <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;face merge&#x27;</span>); <span class="hljs-comment">// when two faces are merged it might be possible that redundant faces</span>
	          <span class="hljs-comment">// are destroyed, in that case move all the visible vertices from the</span>
	          <span class="hljs-comment">// destroyed faces to the `unclaimed` vertex list</span>

	          <span class="hljs-keyword">var</span> discardedFaces = face.<span class="hljs-title function_">mergeAdjacentFaces</span>(edge, []);

	          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; discardedFaces.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">deleteFaceVertices</span>(discardedFaces[i], face);
	          }

	          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
	        }

	        edge = edge.<span class="hljs-property">next</span>;
	        it += <span class="hljs-number">1</span>;
	      } <span class="hljs-keyword">while</span> (edge !== face.<span class="hljs-property">edge</span>);

	      <span class="hljs-keyword">if</span> (!convex) {
	        face.<span class="hljs-property">mark</span> = _Face.<span class="hljs-property">NON_CONVEX</span>;
	      }

	      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	    }
	    <span class="hljs-comment">/**
	     * Adds a vertex to the hull with the following algorithm
	     *
	     * - Compute the `horizon` which is a chain of half edges, for an edge to
	     *   belong to this group it must be the edge connecting a face that can
	     *   see `eyeVertex` and a face which cannot see `eyeVertex`
	     * - All the faces that can see `eyeVertex` have its visible vertices removed
	     *   from the claimed VertexList
	     * - A new set of faces is created with each edge of the `horizon` and
	     *   `eyeVertex`, each face is connected with the opposite horizon face and
	     *   the face on the left/right
	     * - The new faces are merged if possible with the opposite horizon face first
	     *   and then the faces on the right/left
	     * - The vertices removed from all the visible faces are assigned to the new
	     *   faces if possible
	     *
	     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Vertex</span>} <span class="hljs-variable">eyeVertex</span>
	     */</span>

	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;addVertexToHull&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">addVertexToHull</span>(<span class="hljs-params">eyeVertex</span>) {
	      <span class="hljs-keyword">var</span> horizon = [];
	      <span class="hljs-variable language_">this</span>.<span class="hljs-property">unclaimed</span>.<span class="hljs-title function_">clear</span>(); <span class="hljs-comment">// remove `eyeVertex` from `eyeVertex.face` so that it can&#x27;t be added to the</span>
	      <span class="hljs-comment">// `unclaimed` vertex list</span>

	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeVertexFromFace</span>(eyeVertex, eyeVertex.<span class="hljs-property">face</span>);
	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHorizon</span>(eyeVertex.<span class="hljs-property">point</span>, <span class="hljs-literal">null</span>, eyeVertex.<span class="hljs-property">face</span>, horizon);

	      <span class="hljs-keyword">if</span> (debug.<span class="hljs-property">enabled</span>) {
	        <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;horizon %j&#x27;</span>, horizon.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">edge</span>) {
	          <span class="hljs-keyword">return</span> edge.<span class="hljs-title function_">head</span>().<span class="hljs-property">index</span>;
	        }));
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addNewFaces</span>(eyeVertex, horizon);
	      <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;first merge&#x27;</span>); <span class="hljs-comment">// first merge pass</span>
	      <span class="hljs-comment">// Do the merge with respect to the larger face</span>

	      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">newFaces</span>.<span class="hljs-property">length</span>; i += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> face = <span class="hljs-variable language_">this</span>.<span class="hljs-property">newFaces</span>[i];

	        <span class="hljs-keyword">if</span> (face.<span class="hljs-property">mark</span> === _Face.<span class="hljs-property">VISIBLE</span>) {
	          <span class="hljs-comment">// eslint-disable-next-line</span>
	          <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doAdjacentMerge</span>(face, <span class="hljs-variable constant_">MERGE_NON_CONVEX_WRT_LARGER_FACE</span>)) {}
	        }
	      }

	      <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;second merge&#x27;</span>); <span class="hljs-comment">// second merge pass</span>
	      <span class="hljs-comment">// Do the merge on non convex faces (a face is marked as non convex in the</span>
	      <span class="hljs-comment">// first pass)</span>

	      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _i2 = <span class="hljs-number">0</span>; _i2 &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">newFaces</span>.<span class="hljs-property">length</span>; _i2 += <span class="hljs-number">1</span>) {
	        <span class="hljs-keyword">var</span> _face = <span class="hljs-variable language_">this</span>.<span class="hljs-property">newFaces</span>[_i2];

	        <span class="hljs-keyword">if</span> (_face.<span class="hljs-property">mark</span> === _Face.<span class="hljs-property">NON_CONVEX</span>) {
	          _face.<span class="hljs-property">mark</span> = _Face.<span class="hljs-property">VISIBLE</span>; <span class="hljs-comment">// eslint-disable-next-line</span>

	          <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doAdjacentMerge</span>(_face, <span class="hljs-variable constant_">MERGE_NON_CONVEX</span>)) {}
	        }
	      }

	      <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;reassigning points to newFaces&#x27;</span>); <span class="hljs-comment">// reassign `unclaimed` vertices to the new faces</span>

	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resolveUnclaimedPoints</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">newFaces</span>);
	    }
	  }, {
	    <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;build&quot;</span>,
	    <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {
	      <span class="hljs-keyword">var</span> iterations = <span class="hljs-number">0</span>;
	      <span class="hljs-keyword">var</span> eyeVertex;
	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createInitialSimplex</span>();

	      <span class="hljs-keyword">while</span> (eyeVertex = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">nextVertexToAdd</span>()) {
	        iterations += <span class="hljs-number">1</span>;
	        <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;== iteration %j ==&#x27;</span>, iterations);
	        <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;next vertex to add = %d %j&#x27;</span>, eyeVertex.<span class="hljs-property">index</span>, eyeVertex.<span class="hljs-property">point</span>);
	        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addVertexToHull</span>(eyeVertex);
	        <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;end&#x27;</span>);
	      }

	      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reindexFaceAndVertices</span>();
	    }
	  }]);

	  <span class="hljs-keyword">return</span> <span class="hljs-title class_">QuickHull</span>;
	}();

	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = <span class="hljs-title class_">QuickHull</span>; 
} (<span class="hljs-title class_">QuickHull</span>));

(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-built_in">exports</span></span>) {

	<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&quot;__esModule&quot;</span>, {
	  <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span>
	});
	<span class="hljs-built_in">exports</span>[<span class="hljs-string">&quot;default&quot;</span>] = runner;
	<span class="hljs-built_in">exports</span>.<span class="hljs-property">isPointInsideHull</span> = isPointInsideHull;

	<span class="hljs-keyword">var</span> _QuickHull = <span class="hljs-title function_">_interopRequireDefault</span>(<span class="hljs-title class_">QuickHull</span>);

	<span class="hljs-keyword">var</span> _getPlaneNormal = <span class="hljs-title function_">_interopRequireDefault</span>(getPlaneNormal);

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">_interopRequireDefault</span>(<span class="hljs-params">obj</span>) { <span class="hljs-keyword">return</span> obj &amp;&amp; obj.<span class="hljs-property">__esModule</span> ? obj : { <span class="hljs-string">&quot;default&quot;</span>: obj }; }

	<span class="hljs-keyword">function</span> <span class="hljs-title function_">runner</span>(<span class="hljs-params">points</span>) {
	  <span class="hljs-keyword">var</span> options = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>] !== <span class="hljs-literal">undefined</span> ? <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>] : {};
	  <span class="hljs-keyword">var</span> instance = <span class="hljs-keyword">new</span> _QuickHull[<span class="hljs-string">&quot;default&quot;</span>](points);
	  instance.<span class="hljs-title function_">build</span>();
	  <span class="hljs-keyword">return</span> instance.<span class="hljs-title function_">collectFaces</span>(options.<span class="hljs-property">skipTriangulation</span>);
	}
	<span class="hljs-comment">/**
	 * Checks if a point is inside the convex hull.
	 *
	 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array&lt;number&gt;</span>} <span class="hljs-variable">point</span> - The point to check.
	 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array&lt;Array&lt;number&gt;&gt;</span>} <span class="hljs-variable">points</span> - The points used in the space where the
	 * convex hull is defined.
	 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array&lt;Array&lt;number&gt;&gt;</span>} <span class="hljs-variable">faces</span> - The faces of the convex hull.
	 */</span>


	<span class="hljs-keyword">function</span> <span class="hljs-title function_">isPointInsideHull</span>(<span class="hljs-params">point, points, faces</span>) {
	  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; faces.<span class="hljs-property">length</span>; i++) {
	    <span class="hljs-keyword">var</span> face = faces[i];
	    <span class="hljs-keyword">var</span> a = points[face[<span class="hljs-number">0</span>]];
	    <span class="hljs-keyword">var</span> b = points[face[<span class="hljs-number">1</span>]];
	    <span class="hljs-keyword">var</span> c = points[face[<span class="hljs-number">2</span>]]; <span class="hljs-comment">// Algorithm:</span>
	    <span class="hljs-comment">// 1. Get the normal of the face.</span>
	    <span class="hljs-comment">// 2. Get the vector from the point to the first vertex of the face.</span>
	    <span class="hljs-comment">// 3. Calculate the dot product of the normal and the vector.</span>
	    <span class="hljs-comment">// 4. If the dot product is positive, the point is outside the face.</span>

	    <span class="hljs-keyword">var</span> planeNormal = (<span class="hljs-number">0</span>, _getPlaneNormal[<span class="hljs-string">&quot;default&quot;</span>])([], a, b, c); <span class="hljs-comment">// Get the point</span>

	    <span class="hljs-keyword">var</span> pointAbsA = [point[<span class="hljs-number">0</span>] - a[<span class="hljs-number">0</span>], point[<span class="hljs-number">1</span>] - a[<span class="hljs-number">1</span>], point[<span class="hljs-number">2</span>] - a[<span class="hljs-number">2</span>]];
	    <span class="hljs-keyword">var</span> dotProduct = planeNormal[<span class="hljs-number">0</span>] * pointAbsA[<span class="hljs-number">0</span>] + planeNormal[<span class="hljs-number">1</span>] * pointAbsA[<span class="hljs-number">1</span>] + planeNormal[<span class="hljs-number">2</span>] * pointAbsA[<span class="hljs-number">2</span>];

	    <span class="hljs-keyword">if</span> (dotProduct &gt; <span class="hljs-number">0</span>) {
	      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	    }
	  }

	  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
	} 
} (dist));

<span class="hljs-keyword">var</span> qh_def = <span class="hljs-comment">/*@__PURE__*/</span><span class="hljs-title function_">getDefaultExportFromCjs</span>(dist);

<span class="hljs-keyword">const</span> qh = qh_def[<span class="hljs-string">&#x27;default&#x27;</span>];

<span class="hljs-keyword">const</span> <span class="hljs-title function_">polyhedron</span> = (<span class="hljs-params">points</span>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;polyhedron...&#x27;</span>, points);
  points = points.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> [...point]);
  points = points.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">point, index</span>) =&gt;</span> points.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-title function_">join</span>() === point.<span class="hljs-title function_">join</span>()) === index);

  <span class="hljs-keyword">if</span> (points.<span class="hljs-property">length</span> &lt; <span class="hljs-number">4</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;points&#x27;</span>, points);
  <span class="hljs-keyword">const</span> faces = <span class="hljs-title function_">qh</span>(points)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">face</span> =&gt;</span> face.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">index</span> =&gt;</span> points[index]))
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">face</span> =&gt;</span> face.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>(...point)))
    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">face, index</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> [a, b, c] = face;
      <span class="hljs-keyword">const</span> center = <span class="hljs-title function_">centroid</span>(a, b, c);

      <span class="hljs-keyword">const</span> normal = b.<span class="hljs-title function_">clone</span>().<span class="hljs-title function_">sub</span>(a).<span class="hljs-title function_">cross</span>(c.<span class="hljs-title function_">clone</span>().<span class="hljs-title function_">sub</span>(a)).<span class="hljs-title function_">normalize</span>();
      <span class="hljs-keyword">const</span> angle = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">acos</span>(normal.<span class="hljs-property">z</span>);
      <span class="hljs-keyword">const</span> axis = normal.<span class="hljs-title function_">clone</span>().<span class="hljs-title function_">cross</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>)).<span class="hljs-title function_">normalize</span>();

      <span class="hljs-keyword">const</span> points2d = face.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> point.<span class="hljs-title function_">clone</span>().<span class="hljs-title function_">sub</span>(center).<span class="hljs-title function_">applyAxisAngle</span>(axis, -angle));

      <span class="hljs-keyword">const</span> minX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(...points2d.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> point.<span class="hljs-property">x</span>));
      <span class="hljs-keyword">const</span> minY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(...points2d.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> point.<span class="hljs-property">y</span>));
      <span class="hljs-keyword">const</span> maxX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(...points2d.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> point.<span class="hljs-property">x</span>));
      <span class="hljs-keyword">const</span> maxY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(...points2d.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> point.<span class="hljs-property">y</span>));

      <span class="hljs-keyword">const</span> width = maxX - minX;
      <span class="hljs-keyword">const</span> height = maxY - minY;

      <span class="hljs-keyword">const</span> shiftX = minX + width / <span class="hljs-number">2</span>;
      <span class="hljs-keyword">const</span> shiftY = minY + height / <span class="hljs-number">2</span>;

      <span class="hljs-keyword">const</span> local2d = points2d.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>(point.<span class="hljs-property">x</span> - minX, point.<span class="hljs-property">y</span> - minY, <span class="hljs-number">0</span>));

      <span class="hljs-keyword">const</span> clipPath = <span class="hljs-string">`polygon(<span class="hljs-subst">${local2d.map(point =&gt; <span class="hljs-string">`<span class="hljs-subst">${point.x}</span>px <span class="hljs-subst">${point.y}</span>px`</span>).join(<span class="hljs-string">&#x27;, &#x27;</span>)}</span>)`</span>;

      <span class="hljs-keyword">const</span> transform = <span class="hljs-string">`
        translate(-50%, -50%)
        translate3d(<span class="hljs-subst">${center.x}</span>px, <span class="hljs-subst">${center.y}</span>px, <span class="hljs-subst">${center.z}</span>px)
        rotate3d(<span class="hljs-subst">${axis.x}</span>, <span class="hljs-subst">${axis.y}</span>, <span class="hljs-subst">${axis.z}</span>, <span class="hljs-subst">${rad2deg(angle)}</span>deg)
        translate(<span class="hljs-subst">${shiftX}</span>px, <span class="hljs-subst">${shiftY}</span>px)
      `</span>;

      <span class="hljs-keyword">return</span> <span class="hljs-string">`
        &lt;div
          class=&quot;face&quot;
          style=&quot;
            width: <span class="hljs-subst">${width}</span>px;
            height: <span class="hljs-subst">${height}</span>px;
            transform:  <span class="hljs-subst">${transform}</span>;
            clip-path: <span class="hljs-subst">${clipPath}</span>;
          &quot;
        &gt;
        &lt;/div&gt;
      `</span>
    });
    
  <span class="hljs-keyword">return</span> <span class="hljs-string">`
    &lt;style scoped&gt;
      :host {
        --background: rgba(0, 255, 255, 0.5);
        cursor: pointer;
      }

      .face {
        position: absolute;
        left: 0;
        top: 0;
        transform-style: preserve-3d;
        transform-origin: center;
        background: var(--background);
        /*backface-visibility: hidden;*/
        
      }

    &lt;/style&gt;
    <span class="hljs-subst">${faces.join(<span class="hljs-string">&#x27;&#x27;</span>)}</span>
  `</span>;
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Polyhedron</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">C3Group</span> {
  #shape;

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">observedAttributes</span>() {
    <span class="hljs-keyword">return</span> [
      ...C3Object.<span class="hljs-property">observedAttributes</span>,
      <span class="hljs-string">&#x27;background&#x27;</span>
    ];
  }

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;C3Polyhedron constructor...&#x27;</span>);
    <span class="hljs-variable language_">super</span>();

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSlotChange</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSlotChange</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);

    <span class="hljs-variable language_">this</span>.#shape = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
    <span class="hljs-variable language_">this</span>.#shape.<span class="hljs-property">style</span>.<span class="hljs-property">transformStyle</span> = <span class="hljs-string">&#x27;preserve-3d&#x27;</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.#shape);
  }

  <span class="hljs-keyword">get</span> <span class="hljs-title function_">vertices</span>() {
    <span class="hljs-keyword">return</span> [...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;c3-vertex&#x27;</span>)]
  }

  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;render polyhedron...&#x27;</span>);
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">render</span>();

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;this&#x27;</span>, <span class="hljs-variable language_">this</span>);

    <span class="hljs-keyword">const</span> points = [...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;c3-vertex&#x27;</span>)]
      .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">vertex</span> =&gt;</span> [...C3Object.<span class="hljs-title function_">getPosition</span>(vertex)]);

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;points&#x27;</span>, points);


    <span class="hljs-variable language_">this</span>.#shape.<span class="hljs-property">innerHTML</span> = <span class="hljs-title function_">polyhedron</span>(points);
  }
}

<span class="hljs-title class_">CSSStyleMixin</span>(C3Polyhedron, [
  <span class="hljs-string">&#x27;background&#x27;</span>
], <span class="hljs-literal">true</span>);

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;c3-polyhedron&#x27;</span>, C3Polyhedron);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Vertex</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">C3Object</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">observedAttributes</span>() {
    <span class="hljs-keyword">return</span> [
      ...C3Object.<span class="hljs-property">observedAttributes</span>,
    ];
  }
}

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;c3-vertex&#x27;</span>, C3Vertex);

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FACETS</span>$1 = <span class="hljs-number">16</span>;

<span class="hljs-keyword">const</span> cylinder = <span class="hljs-string">`
  &lt;style scoped&gt;
    :host {
      --radius: 100px;
      --topRadius: 100px;
      --bottomRadius: 100px;
      --height: 200px;
      --facets: <span class="hljs-subst">${FACETS$1}</span>;
      --background: rgba(0, 255, 255, 0.1);
    }

    /*
    :host::before,
    :host::after {
      --r: calc(max(var(--topRadius), var(--bottomRadius)));
      content: &#x27;&#x27;;
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: calc(var(--r) * 2);
      height: var(--height);
      transform: translateX(-50%) translateY(-50%) translateZ(calc(var(--r)));
      outline: 2px solid green;
    }

    :host::after {
      transform: translateX(-50%) translateY(-50%) translateZ(calc(-1 * var(--r)));
    }
    */

    .shape {
      --_topRadius: var(--topRadius, var(--radius));
      --_bottomRadius: var(--bottomRadius, var(--radius));
    }

    .shape {
      transform: translate3d(-50%, -50%, calc(var(--radiusTop) / 2));
      transform-style: preserve-3d;
    }

    .top, .bottom, .body {
      transform-style: preserve-3d;
    }

    

    .facet {
      --r: calc((var(--_bottomRadius) + var(--_topRadius)) / 2);
      --angle: calc(var(--facet) * 360deg / var(--facets));
      --x: calc(var(--r) * cos(var(--angle)) - 50%);
      --y: -50%;
      --z: calc(var(--r) * sin(var(--angle)));
      --w2: calc(var(--_topRadius) * 2 * tan(180deg / var(--facets)));
      --w1: calc(var(--_bottomRadius) * 2 * tan(180deg / var(--facets)));

      --w: max(var(--w1), var(--w2));
      --ax: calc(atan2(var(--_bottomRadius) - var(--_topRadius), var(--height)));
      --lx: calc(min(var(--w1), var(--w2)) / 2);
      --h: calc(var(--height) + var(--lx) * sin(ax));
      --s: calc(var(--height) / cos(var(--ax) * -1));
      --a: calc(atan2(var(--s), var(--w2) / 2 - var(--w1) / 2) - 45deg);

      transform-style: preserve-3d;
    }

    .body .facet {
      position: absolute;
      top: 0;
      left: 0;
      width: var(--w);
      height: var(--s);
      transform-origin: 50% 50%;
      transform: translate3d(var(--x), var(--y), var(--z)) rotateY(calc(-1 * var(--angle) + 90deg)) rotateX(calc(var(--ax) * -1));
      
      background: var(--background);
      background-position-x: calc(100% * var(--facet));
      /* background-size: calc(100% * var(--facets)) 100%; */

      --mc: orange;
      --mt: rgba(0, 255, 0, 0.5);
      --mt: transparent; 
     
      mask-image:
        conic-gradient(
          from 135deg at calc( 50% - var(--w1) / 2) 0,
          var(--mt) 45deg,
          var(--mc) 0,
          var(--mc) calc(90deg - var(--a)),
          var(--mt) calc(90deg - var(--a))
        ),

        conic-gradient(
          from 135deg at calc( 50% + var(--w1) / 2) 0,
            var(--mt) calc(var(--a)),
            var(--mc) calc(45deg - var(--a)),
            var(--mc) calc(45deg),
            var(--mt) calc(45deg)
        ),

        conic-gradient(
          from -45deg at calc( 50% - var(--w2) / 2) 100%,
            var(--mt) calc(90deg - var(--a)),
            var(--mc) calc(90deg - var(--a)),
            var(--mc) 45deg,
            var(--mt) 45deg
        ),
        
        conic-gradient(
          from -45deg at calc( 50% + var(--w2) / 2) 100%,
            var(--mt) 45deg,
            var(--mc) 45deg,
            var(--mc) calc(var(--a)),
            var(--mt) calc(var(--a))
        ),
        
        linear-gradient(90deg,
          var(--mt) calc(50% - var(--lx)),
          var(--mc) calc(50% - var(--lx)),
          var(--mc) calc(50% + var(--lx) + 0.5px),
          var(--mt) calc(50% + var(--lx) + 0.5px)
        );
    }

    .top .facet {
      --sx: var(--w2);
      --w: calc(var(--topRadius, var(--radius)) * 2);
      --h: calc(var(--topRadius, var(--radius)) * 2);
    }

    .bottom .facet {
      --sx: var(--w1);
      --w: calc(var(--bottomRadius, var(--radius)) * 2);
      --h: calc(var(--bottomRadius, var(--radius)) * 2);
    }

    .bottom {
      position: absolute;
      top: calc( -1 * var(--height));
    }

    .top .facet,
    .bottom .facet {
      --mc: orange;
      --mt: transparent;
      --r: calc((var(--_bottomRadius) + var(--_topRadius)) / 2);
      --a: calc(atan2(var(--h), var(--sx)));
      --b: calc(atan2(var(--h), var(--sx) * -1));
      --fy: calc(var(--facet) * 0px); 
    }

    .bottom .facet {
      /*transform: translate(-50%, calc(var(--height) / -2 - 50% + var(--fy) )) rotateX(90deg) rotateZ(calc(var(--angle)));*/
    }

    .top .facet::before,
    .bottom .facet::before {
      content: &#x27;&#x27;;
      display: block;
      position: absolute;
      top: 50%;
      left: 50%;
      width: calc(var(--_topRadius) * 2);
      height: calc(var(--_topRadius) * 2);
      background: var(--background);
     
      transform: translate(-50%, -50%) rotateZ(calc(-1 * var(--angle)));
      transform-origin: 50% 50%;
    }

    .bottom .facet::before {
      width: calc(var(--_bottomRadius) * 2);
      height: calc(var(--_bottomRadius) * 2);
      transform: translate(-50%, -50%) rotateZ(calc(-1 * var(--angle))) scaleX(-1);
    }

    .top .facet,
    .bottom .facet {
      background-size: auto 100%;
    }

    .top .facet,
    .bottom .facet {
      position: absolute;
      width: var(--w);
      height: var(--h);
      transform-origin: 50% 50%;
      transform: translate(-50%, calc(var(--height) / 2 - 50% + var(--fy) )) rotateX(90deg) rotateZ(calc(var(--angle)));
      mask-image: conic-gradient(from calc(0deg ) at 50% 50%, var(--mt) var(--a), var(--mc) var(--a), var(--mc) calc(var(--b)), var(--mt) calc(var(--b)));

      outline: 3px solid blue;
    }

    
  &lt;/style&gt;
  &lt;div class=&quot;shape cylinder&quot;&gt;
    &lt;div class=&quot;top&quot;&gt;
      <span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>({length: FACETS$1}, (_, i) =&gt; <span class="hljs-string">`&lt;div class=&quot;facet&quot; style=&quot;--facet: <span class="hljs-subst">${i}</span>&quot;&gt;&lt;/div&gt;`</span>).join(<span class="hljs-string">&#x27;\n&#x27;</span>)}</span>
    &lt;/div&gt;
    &lt;div class=&quot;body&quot;&gt;
      <span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>({length: FACETS$1}, (_, i) =&gt; <span class="hljs-string">`&lt;div class=&quot;facet&quot; style=&quot;--facet: <span class="hljs-subst">${i}</span>&quot;&gt;&lt;/div&gt;`</span>).join(<span class="hljs-string">&#x27;\n&#x27;</span>)}</span>
    &lt;/div&gt;
    &lt;div class=&quot;bottom&quot;&gt;
      <span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>({length: FACETS$1}, (_, i) =&gt; <span class="hljs-string">`&lt;div class=&quot;facet&quot; style=&quot;--facet: <span class="hljs-subst">${i}</span>&quot;&gt;&lt;/div&gt;`</span>).join(<span class="hljs-string">&#x27;\n&#x27;</span>)}</span>
    &lt;/div&gt;
  &lt;/div&gt;
  
`</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Cylinder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">C3Object</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">observedAttributes</span>() {
    <span class="hljs-keyword">return</span> [
      ...C3Object.<span class="hljs-property">observedAttributes</span>,
      <span class="hljs-string">&#x27;background&#x27;</span>,
      <span class="hljs-string">&#x27;radius&#x27;</span>,
      <span class="hljs-string">&#x27;topRadius&#x27;</span>, <span class="hljs-string">&#x27;top-radius&#x27;</span>,
      <span class="hljs-string">&#x27;bottomRadius&#x27;</span>, <span class="hljs-string">&#x27;bottom-radius&#x27;</span>,
      <span class="hljs-string">&#x27;height&#x27;</span>,
      <span class="hljs-string">&#x27;facets&#x27;</span>
    ];
  }

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>();

    <span class="hljs-keyword">const</span> shape = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
    shape.<span class="hljs-property">style</span>.<span class="hljs-property">transformStyle</span> = <span class="hljs-string">&#x27;preserve-3d&#x27;</span>;
    shape.<span class="hljs-property">innerHTML</span> = cylinder;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(shape);
  }
}

<span class="hljs-title class_">CSSStyleMixin</span>(C3Cylinder, [
  <span class="hljs-string">&#x27;background&#x27;</span>,
  <span class="hljs-string">&#x27;radius&#x27;</span>,
  <span class="hljs-string">&#x27;topRadius&#x27;</span>,
  <span class="hljs-string">&#x27;bottomRadius&#x27;</span>,
  <span class="hljs-string">&#x27;height&#x27;</span>,
  <span class="hljs-string">&#x27;facets&#x27;</span>
], <span class="hljs-literal">true</span>);

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;c3-cylinder&#x27;</span>, C3Cylinder);

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SLICES</span> = <span class="hljs-number">32</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FACETS</span> = <span class="hljs-number">16</span>;

<span class="hljs-keyword">const</span> sphere = <span class="hljs-string">`
  &lt;style scoped&gt;
    :host {
      --radius: 100px;
      --background: gray;
      display: grid;
    }

    .scene {
      width: calc(var(--radius) * 2);
      height: calc(var(--radius) * 2);
      /*transform: translateX(-50%) translateY(-50%) translateZ(calc(var(--radius) * -1));*/
      transform: translate(-50%, -50%);
    }

    :host * {
      transform-style: preserve-3d;
      backface-visibility: hidden;
    }

    .scene,
    .scene *,
    .scene *::before,
    .scene *::after {
      position: absolute;
    }

    .sphere, .slice {
      inset: 0;
    }

    .sphere {
      /* display: grid; */
      transform: scaleX(-1);
    }

    .slice {
      --ngon: 32;
      --angle: calc(360deg/var(--ngon));
      transform: rotateY(calc(var(--angle) * var(--sliceStep))) scaleX(calc(cos(var(--angle) / 2)));
      display: grid;
      place-items: center;
    }

    .facet {
      --facet-width: calc(var(--radius) * 2 * sin(var(--angle) / 2));
      width: var(--facet-width);
      aspect-ratio: 1;
      --ptAngle: calc( atan( (sin(var(--angle)*(var(--ptStep) + 1)) - sin(var(--angle)*var(--ptStep)))/2 ) );
      --peak: calc(-100% * sin(var(--angle)*(var(--facetStep) + 1))/(sin(var(--angle)*(var(--facetStep) + 1)) - sin(var(--angle)*var(--facetStep))) + 100%);
      --clr3: hsl(calc(360deg - 10deg/(var(--ngon)/2)*var(--facetStep)) 100% calc(50% + 38%/(var(--ngon)/2)*var(--facetStep)));  
      --clr4: hsl(calc(360deg - 10deg/(var(--ngon)/2)*(var(--facetStep) + 1)) 100% calc(50% + 38%/(var(--ngon)/2)*(var(--facetStep) + 1)));
      /*background-image: linear-gradient(var(--clr3), var(--clr4)), conic-gradient(from calc(90deg*(1 + var(--dir)) - 1*var(--ptAngle)) at 50% var(--peak), var(--clr1),var(--clr2) calc(2*var(--ptAngle)), transparent 0);*/
      background-blend-mode: difference;
      webkit-mask-image: conic-gradient(from calc(90deg*(1 + var(--dir)) - 1*var(--ptAngle)) at 50% var(--peak), black calc(2*var(--ptAngle)), transparent 0);
      mask-image: conic-gradient(from calc(90deg*(1 + var(--dir)) - 1*var(--ptAngle)) at 50% var(--peak), black calc(2*var(--ptAngle)), transparent 0);
      --pushZ: 52em;
      transform: rotate(calc(90deg + var(--angle)*(.5 + var(--facetStep)))) translateX(calc(var(--pushZ) * cos(var(--angle) / 2))) rotateY(calc(90deg));
      --dir: 1;
      padding-inline: 0;
      background: red;
      background: var(--background);
      background-position: calc(var(--sliceStep) / var(--ngon) * -100%) calc(var(--facetStep) / (var(--ngon) / 2) * 100%);
      background-size: 3200% 1600%;
      backface-visibility: hidden;
    }

    .facet:nth-child(n+9) {
      --dir: -1;
    }

    .slice:nth-child(n-17) .facet:nth-child(n+9),
    .slice:nth-child(n+17) .facet:nth-child(n-9) {
      --clr1: hsl(calc(60deg + 120deg/var(--ngon)*(var(--gradStep) + 1)) 100% calc(50% - 23%/var(--ngon)*(var(--gradStep) + 1)));  
      --clr2: hsl(calc(60deg + 120deg/var(--ngon)*var(--gradStep)) 100% calc(50% - 23%/var(--ngon)*var(--gradStep)));
    }

    :where(.facet),
    .slice:nth-child(n+17) .facet:nth-child(n+9) {
      --clr2: hsl(calc(60deg + 120deg/var(--ngon)*(var(--gradStep) + 1)) 100% calc(50% - 23%/var(--ngon)*(var(--gradStep) + 1)));  
      --clr1: hsl(calc(60deg + 120deg/var(--ngon)*var(--gradStep)) 100% calc(50% - 23%/var(--ngon)*var(--gradStep)));
    }


    .scene .facet {
      --pushZ: var(--radius);
    }

    .scene .facet {
      backface-visibility: hidden;
    }

    /* iterations */

    .slice:nth-child(1) {
      --sliceStep: 0;
    }

    .slice:nth-child(2) {
      --sliceStep: 1;
    }

    .slice:nth-child(3) {
      --sliceStep: 2;
    }

    .slice:nth-child(4) {
      --sliceStep: 3;
    }

    .slice:nth-child(5) {
      --sliceStep: 4;
    }

    .slice:nth-child(6) {
      --sliceStep: 5;
    }

    .slice:nth-child(7) {
      --sliceStep: 6;
    }

    .slice:nth-child(8) {
      --sliceStep: 7;
    }

    .slice:nth-child(9) {
      --sliceStep: 8;
    }

    .slice:nth-child(10) {
      --sliceStep: 9;
    }

    .slice:nth-child(11) {
      --sliceStep: 10;
    }

    .slice:nth-child(12) {
      --sliceStep: 11;
    }

    .slice:nth-child(13) {
      --sliceStep: 12;
    }

    .slice:nth-child(14) {
      --sliceStep: 13;
    }

    .slice:nth-child(15) {
      --sliceStep: 14;
    }

    .slice:nth-child(16) {
      --sliceStep: 15;
    }

    .slice:nth-child(17) {
      --sliceStep: 16;
    }

    .slice:nth-child(18) {
      --sliceStep: 17;
    }

    .slice:nth-child(19) {
      --sliceStep: 18;
    }

    .slice:nth-child(20) {
      --sliceStep: 19;
    }

    .slice:nth-child(21) {
      --sliceStep: 20;
    }

    .slice:nth-child(22) {
      --sliceStep: 21;
    }

    .slice:nth-child(23) {
      --sliceStep: 22;
    }

    .slice:nth-child(24) {
      --sliceStep: 23;
    }

    .slice:nth-child(25) {
      --sliceStep: 24;
    }

    .slice:nth-child(26) {
      --sliceStep: 25;
    }

    .slice:nth-child(27) {
      --sliceStep: 26;
    }

    .slice:nth-child(28) {
      --sliceStep: 27;
    }

    .slice:nth-child(29) {
      --sliceStep: 28;
    }

    .slice:nth-child(30) {
      --sliceStep: 29;
    }

    .slice:nth-child(31) {
      --sliceStep: 30;
    }

    .slice:nth-child(32) {
      --sliceStep: 31;
    }


    /* incrementing the facet&#x27;s step variable */

    .facet:nth-child(1) {
      --facetStep: 0;
    }

    .facet:nth-child(2) {
      --facetStep: 1;
    }

    .facet:nth-child(3) {
      --facetStep: 2;
    }

    .facet:nth-child(4) {
      --facetStep: 3;
    }

    .facet:nth-child(5) {
      --facetStep: 4;
    }

    .facet:nth-child(6) {
      --facetStep: 5;
    }

    .facet:nth-child(7) {
      --facetStep: 6;
    }

    .facet:nth-child(8) {
      --facetStep: 7;
    }

    .facet:nth-child(9) {
      --facetStep: 8;
    }

    .facet:nth-child(10) {
      --facetStep: 9;
    }

    .facet:nth-child(11) {
      --facetStep: 10;
    }

    .facet:nth-child(12) {
      --facetStep: 11;
    }

    .facet:nth-child(13) {
      --facetStep: 12;
    }

    .facet:nth-child(14) {
      --facetStep: 13;
    }

    .facet:nth-child(15) {
      --facetStep: 14;
    }

    .facet:nth-child(16) {
      --facetStep: 15;
    }

    /* this switches the incrementation and goes backwards at the midpoint */

    .facet:nth-child(1), .facet:nth-last-child(1) {
      --ptStep: 0;
    }

    .facet:nth-child(2), .facet:nth-last-child(2) {
      --ptStep: 1;
    }

    .facet:nth-child(3), .facet:nth-last-child(3) {
      --ptStep: 2;
    }

    .facet:nth-child(4), .facet:nth-last-child(4) {
      --ptStep: 3;
    }

    .facet:nth-child(5), .facet:nth-last-child(5) {
      --ptStep: 4;
    }

    .facet:nth-child(6), .facet:nth-last-child(6) {
      --ptStep: 5;
    }

    .facet:nth-child(7), .facet:nth-last-child(7) {
      --ptStep: 6;
    }

    .facet:nth-child(8), .facet:nth-last-child(8) {
      --ptStep: 7;
    }
  &lt;/style&gt;
  &lt;div class=&quot;scene&quot;&gt;
    &lt;div class=&quot;sphere&quot;&gt;
      <span class="hljs-subst">${[...<span class="hljs-built_in">Array</span>(SLICES)].map((_, i) =&gt; <span class="hljs-string">`
        &lt;div class=&quot;slice&quot; style=&quot;--sliceStep: <span class="hljs-subst">${i}</span>&quot;&gt;
          <span class="hljs-subst">${[...<span class="hljs-built_in">Array</span>(FACETS)].map((_, j) =&gt; <span class="hljs-string">`
            &lt;div class=&quot;facet&quot; style=&quot;--facetStep: <span class="hljs-subst">${j}</span>&quot;&gt;&lt;/div&gt;
          `</span>).join(<span class="hljs-string">&#x27;&#x27;</span>)}</span>
        &lt;/div&gt;
      `</span>).join(<span class="hljs-string">&#x27;&#x27;</span>)}</span>
    &lt;/div&gt;
  &lt;/div&gt;
  `</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">C3Sphere</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">C3Object</span> {
  #style;
  #radius;
  #background;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>();
    
    <span class="hljs-keyword">const</span> shape = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
    shape.<span class="hljs-property">style</span>.<span class="hljs-property">transformStyle</span> = <span class="hljs-string">&#x27;preserve-3d&#x27;</span>;
    shape.<span class="hljs-property">innerHTML</span> = sphere;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(shape);
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">observedAttributes</span>() {
    <span class="hljs-keyword">return</span> [
      ...C3Object.<span class="hljs-property">observedAttributes</span>,
      <span class="hljs-string">&#x27;background&#x27;</span>,
      <span class="hljs-string">&#x27;radius&#x27;</span>
    ];
  }
}

<span class="hljs-title class_">CSSStyleMixin</span>(C3Sphere, [
  <span class="hljs-string">&#x27;background&#x27;</span>,
  <span class="hljs-string">&#x27;radius&#x27;</span>
], <span class="hljs-literal">true</span>);

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;c3-sphere&#x27;</span>, C3Sphere);

<span class="hljs-keyword">export</span> { C3Box, C3Cylinder, C3Grid, C3Group, C3Polyhedron, C3Scene, C3Sphere, C3Vertex };
</code></pre>
    </div>
  </div>
</main>

    <div class="footer">
      <div class="center">
        Powered by <a target="_blank" href="https://benignware.com">Benignware</a>
      </div>
    </div>
  </body>
</html>