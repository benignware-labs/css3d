/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/quickhull3d@2.1.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import e from"/npm/point-line-distance@1.0.0/+esm";import t from"/npm/get-plane-normal@1.0.0/+esm";import n from"/npm/gl-vec3@1.1.3/dot/+esm";import r from"/npm/gl-vec3@1.1.3/add/+esm";import i from"/npm/gl-vec3@1.1.3/subtract/+esm";import a from"/npm/gl-vec3@1.1.3/cross/+esm";import o from"/npm/gl-vec3@1.1.3/copy/+esm";import s from"/npm/gl-vec3@1.1.3/length/+esm";import l from"/npm/gl-vec3@1.1.3/scale/+esm";import c from"/npm/gl-vec3@1.1.3/scaleAndAdd/+esm";import u from"/npm/gl-vec3@1.1.3/normalize/+esm";import f from"/npm/gl-vec3@1.1.3/distance/+esm";import d from"/npm/gl-vec3@1.1.3/squaredDistance/+esm";import h from"/npm/debug@4.3.5/+esm";var p={},v={},m={};!function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null}var n,r,i;return n=e,(r=[{key:"clear",value:function(){this.head=this.tail=null}},{key:"insertBefore",value:function(e,t){t.prev=e.prev,t.next=e,t.prev?t.prev.next=t:this.head=t,e.prev=t}},{key:"insertAfter",value:function(e,t){t.prev=e,t.next=e.next,t.next?t.next.prev=t:this.tail=t,e.next=t}},{key:"add",value:function(e){this.head?this.tail.next=e:this.head=e,e.prev=this.tail,e.next=null,this.tail=e}},{key:"addAll",value:function(e){for(this.head?this.tail.next=e:this.head=e,e.prev=this.tail;e.next;)e=e.next;this.tail=e}},{key:"remove",value:function(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev}},{key:"removeChain",value:function(e,t){e.prev?e.prev.next=t.next:this.head=t.next,t.next?t.next.prev=e.prev:this.tail=e.prev}},{key:"first",value:function(){return this.head}},{key:"isEmpty",value:function(){return!this.head}}])&&t(n.prototype,r),i&&t(n,i),Object.defineProperty(n,"prototype",{writable:!1}),e}();e.default=n}(m);var g={};!function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n((function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.point=t,this.index=n,this.next=null,this.prev=null,this.face=null}));e.default=r}(g);var y={},x={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(f),n=r(d);function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=h("halfedge"),o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vertex=t,this.face=n,this.next=null,this.prev=null,this.opposite=null}var r,o,s;return r=e,(o=[{key:"head",value:function(){return this.vertex}},{key:"tail",value:function(){return this.prev?this.prev.vertex:null}},{key:"length",value:function(){return this.tail()?(0,t.default)(this.tail().point,this.head().point):-1}},{key:"lengthSquared",value:function(){return this.tail()?(0,n.default)(this.tail().point,this.head().point):-1}},{key:"setOpposite",value:function(e){var t=this;a.enabled&&a("opposite ".concat(t.tail().index," <--\x3e ").concat(t.head().index," between ").concat(t.face.collectIndices(),", ").concat(e.face.collectIndices())),this.opposite=e,e.opposite=this}}])&&i(r.prototype,o),s&&i(r,s),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.default=o}(x),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VISIBLE=e.NON_CONVEX=e.DELETED=void 0;var t=w(n),f=w(r),d=w(i),p=w(a),v=w(o),m=w(s),g=w(l),y=w(c),b=w(u),k=w(x);function w(e){return e&&e.__esModule?e:{default:e}}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=h("face");e.VISIBLE=0;e.NON_CONVEX=1;e.DELETED=2;var F=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.normal=[],this.centroid=[],this.offset=0,this.outside=null,this.mark=0,this.edge=null,this.nVertices=0}var n,r,i;return n=e,i=[{key:"createTriangle",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=new e,o=new k.default(t,a),s=new k.default(n,a),l=new k.default(r,a);return o.next=l.prev=s,s.next=o.prev=l,l.next=s.prev=o,a.edge=o,a.computeNormalAndCentroid(i),O.enabled&&O("face created %j",a.collectIndices()),a}}],(r=[{key:"getEdge",value:function(e){if("number"!=typeof e)throw Error("requires a number");for(var t=this.edge;e>0;)t=t.next,e-=1;for(;e<0;)t=t.prev,e+=1;return t}},{key:"computeNormal",value:function(){var e=this.edge,t=e.next,n=t.next,r=(0,d.default)([],t.head().point,e.head().point),i=[],a=[];for(this.nVertices=2,this.normal=[0,0,0];n!==e;)(0,v.default)(a,r),(0,d.default)(r,n.head().point,e.head().point),(0,f.default)(this.normal,this.normal,(0,p.default)(i,a,r)),n=n.next,this.nVertices+=1;this.area=(0,m.default)(this.normal),this.normal=(0,g.default)(this.normal,this.normal,1/this.area)}},{key:"computeNormalMinArea",value:function(e){if(this.computeNormal(),this.area<e){var n,r=0,i=this.edge;do{var a=i.lengthSquared();a>r&&(n=i,r=a),i=i.next}while(i!==this.edge);var o=n.tail().point,s=n.head().point,l=(0,d.default)([],s,o),c=Math.sqrt(r);(0,g.default)(l,l,1/c);var u=(0,t.default)(this.normal,l);(0,y.default)(this.normal,this.normal,l,-u),(0,b.default)(this.normal,this.normal)}}},{key:"computeCentroid",value:function(){this.centroid=[0,0,0];var e=this.edge;do{(0,f.default)(this.centroid,this.centroid,e.head().point),e=e.next}while(e!==this.edge);(0,g.default)(this.centroid,this.centroid,1/this.nVertices)}},{key:"computeNormalAndCentroid",value:function(e){void 0!==e?this.computeNormalMinArea(e):this.computeNormal(),this.computeCentroid(),this.offset=(0,t.default)(this.normal,this.centroid)}},{key:"distanceToPlane",value:function(e){return(0,t.default)(this.normal,e)-this.offset}},{key:"connectHalfEdges",value:function(e,t){var n;if(e.opposite.face===t.opposite.face){var r,i=t.opposite.face;e===this.edge&&(this.edge=t),3===i.nVertices?(r=t.opposite.prev.opposite,i.mark=2,n=i):(r=t.opposite.next,i.edge===r.prev&&(i.edge=r),r.prev=r.prev.prev,r.prev.next=r),t.prev=e.prev,t.prev.next=t,t.setOpposite(r),i.computeNormalAndCentroid()}else e.next=t,t.prev=e;return n}},{key:"mergeAdjacentFaces",value:function(e,t){var n=e.opposite,r=n.face;t.push(r),r.mark=2;for(var i,a,o=e.prev,s=e.next,l=n.prev,c=n.next;o.opposite.face===r;)o=o.prev,c=c.next;for(;s.opposite.face===r;)s=s.next,l=l.prev;for(i=c;i!==l.next;i=i.next)i.face=this;return this.edge=s,(a=this.connectHalfEdges(l,s))&&t.push(a),(a=this.connectHalfEdges(o,c))&&t.push(a),this.computeNormalAndCentroid(),t}},{key:"collectIndices",value:function(){var e=[],t=this.edge;do{e.push(t.head().index),t=t.next}while(t!==this.edge);return e}}])&&E(n.prototype,r),i&&E(n,i),Object.defineProperty(n,"prototype",{writable:!1}),e}();e.default=F}(y),function(r){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=d(e),o=d(t),s=d(n),l=d(m),c=d(g),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(y);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=h("quickhull"),k=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!Array.isArray(t))throw TypeError("input is not a valid array");if(t.length<4)throw Error("cannot build a simplex out of <4 points");this.tolerance=-1,this.nFaces=0,this.nPoints=t.length,this.faces=[],this.newFaces=[],this.claimed=new l.default,this.unclaimed=new l.default,this.vertices=[];for(var n=0;n<t.length;n+=1)this.vertices.push(new c.default(t[n],n));this.discardedFaces=[],this.vertexPointIndices=[]}var t,n,r;return t=e,n=[{key:"addVertexToFace",value:function(e,t){e.face=t,t.outside?this.claimed.insertBefore(t.outside,e):this.claimed.add(e),t.outside=e}},{key:"removeVertexFromFace",value:function(e,t){e===t.outside&&(e.next&&e.next.face===t?t.outside=e.next:t.outside=null),this.claimed.remove(e)}},{key:"removeAllVerticesFromFace",value:function(e){if(e.outside){for(var t=e.outside;t.next&&t.next.face===e;)t=t.next;return this.claimed.removeChain(e.outside,t),t.next=null,e.outside}}},{key:"deleteFaceVertices",value:function(e,t){var n=this.removeAllVerticesFromFace(e);if(n)if(t)for(var r,i=n;i;i=r)r=i.next,t.distanceToPlane(i.point)>this.tolerance?this.addVertexToFace(i,t):this.unclaimed.add(i);else this.unclaimed.addAll(n)}},{key:"resolveUnclaimedPoints",value:function(e){for(var t=this.unclaimed.first(),n=t;n;n=t){t=n.next;for(var r=this.tolerance,i=void 0,a=0;a<e.length;a+=1){var o=e[a];if(o.mark===u.VISIBLE){var s=o.distanceToPlane(n.point);if(s>r&&(r=s,i=o),r>1e3*this.tolerance)break}}i&&this.addVertexToFace(n,i)}}},{key:"computeExtremes",value:function(){var e,t,n=[],r=[],i=[],a=[];for(e=0;e<3;e+=1)i[e]=a[e]=this.vertices[0];for(e=0;e<3;e+=1)n[e]=r[e]=this.vertices[0].point[e];for(e=1;e<this.vertices.length;e+=1){var o=this.vertices[e],s=o.point;for(t=0;t<3;t+=1)s[t]<n[t]&&(n[t]=s[t],i[t]=o);for(t=0;t<3;t+=1)s[t]>r[t]&&(r[t]=s[t],a[t]=o)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(n[0]),Math.abs(r[0]))+Math.max(Math.abs(n[1]),Math.abs(r[1]))+Math.max(Math.abs(n[2]),Math.abs(r[2]))),b.enabled&&b("tolerance %d",this.tolerance),[i,a]}},{key:"createInitialSimplex",value:function(){var e,t,n=this.vertices,r=p(this.computeExtremes(),2),i=r[0],l=r[1],c=0,f=0;for(e=0;e<3;e+=1){var d=l[e].point[e]-i[e].point[e];d>c&&(c=d,f=e)}var h,v,m=i[f],g=l[f];for(c=0,e=0;e<this.vertices.length;e+=1){var y=this.vertices[e];if(y!==m&&y!==g){var x=(0,a.default)(y.point,m.point,g.point);x>c&&(c=x,h=y)}}var b=(0,o.default)([],m.point,g.point,h.point),k=(0,s.default)(m.point,b);for(c=-1,e=0;e<this.vertices.length;e+=1){var w=this.vertices[e];if(w!==m&&w!==g&&w!==h){var E=Math.abs((0,s.default)(b,w.point)-k);E>c&&(c=E,v=w)}}var O=[];if((0,s.default)(v.point,b)-k<0)for(O.push(u.default.createTriangle(m,g,h),u.default.createTriangle(v,g,m),u.default.createTriangle(v,h,g),u.default.createTriangle(v,m,h)),e=0;e<3;e+=1){var F=(e+1)%3;O[e+1].getEdge(2).setOpposite(O[0].getEdge(F)),O[e+1].getEdge(1).setOpposite(O[F+1].getEdge(0))}else for(O.push(u.default.createTriangle(m,h,g),u.default.createTriangle(v,m,g),u.default.createTriangle(v,g,h),u.default.createTriangle(v,h,m)),e=0;e<3;e+=1){var j=(e+1)%3;O[e+1].getEdge(2).setOpposite(O[0].getEdge((3-e)%3)),O[e+1].getEdge(0).setOpposite(O[j+1].getEdge(1))}for(e=0;e<4;e+=1)this.faces.push(O[e]);for(e=0;e<n.length;e+=1){var T=n[e];if(T!==m&&T!==g&&T!==h&&T!==v){c=this.tolerance;var P=void 0;for(t=0;t<4;t+=1){var V=O[t].distanceToPlane(T.point);V>c&&(c=V,P=O[t])}P&&this.addVertexToFace(T,P)}}}},{key:"reindexFaceAndVertices",value:function(){for(var e=[],t=0;t<this.faces.length;t+=1){var n=this.faces[t];n.mark===u.VISIBLE&&e.push(n)}this.faces=e}},{key:"collectFaces",value:function(e){for(var t=[],n=0;n<this.faces.length;n+=1){if(this.faces[n].mark!==u.VISIBLE)throw Error("attempt to include a destroyed face in the hull");var r=this.faces[n].collectIndices();if(e)t.push(r);else for(var i=0;i<r.length-2;i+=1)t.push([r[0],r[i+1],r[i+2]])}return t}},{key:"nextVertexToAdd",value:function(){if(!this.claimed.isEmpty()){var e,t,n=0,r=this.claimed.first().face;for(t=r.outside;t&&t.face===r;t=t.next){var i=r.distanceToPlane(t.point);i>n&&(n=i,e=t)}return e}}},{key:"computeHorizon",value:function(e,t,n,r){var i;this.deleteFaceVertices(n),n.mark=u.DELETED,i=t?t.next:t=n.getEdge(0);do{var a=i.opposite,o=a.face;o.mark===u.VISIBLE&&(o.distanceToPlane(e)>this.tolerance?this.computeHorizon(e,a,o,r):r.push(i)),i=i.next}while(i!==t)}},{key:"addAdjoiningFace",value:function(e,t){var n=u.default.createTriangle(e,t.tail(),t.head());return this.faces.push(n),n.getEdge(-1).setOpposite(t.opposite),n.getEdge(0)}},{key:"addNewFaces",value:function(e,t){var n,r;this.newFaces=[];for(var i=0;i<t.length;i+=1){var a=t[i],o=this.addAdjoiningFace(e,a);n?o.next.setOpposite(r):n=o,this.newFaces.push(o.face),r=o}n.next.setOpposite(r)}},{key:"oppositeFaceDistance",value:function(e){return e.face.distanceToPlane(e.opposite.face.centroid)}},{key:"doAdjacentMerge",value:function(e,t){var n=e.edge,r=!0,i=0;do{if(i>=e.nVertices)throw Error("merge recursion limit exceeded");var a=n.opposite.face,o=!1;if(2===t?(this.oppositeFaceDistance(n)>-this.tolerance||this.oppositeFaceDistance(n.opposite)>-this.tolerance)&&(o=!0):e.area>a.area?this.oppositeFaceDistance(n)>-this.tolerance?o=!0:this.oppositeFaceDistance(n.opposite)>-this.tolerance&&(r=!1):this.oppositeFaceDistance(n.opposite)>-this.tolerance?o=!0:this.oppositeFaceDistance(n)>-this.tolerance&&(r=!1),o){b("face merge");for(var s=e.mergeAdjacentFaces(n,[]),l=0;l<s.length;l+=1)this.deleteFaceVertices(s[l],e);return!0}n=n.next,i+=1}while(n!==e.edge);return r||(e.mark=u.NON_CONVEX),!1}},{key:"addVertexToHull",value:function(e){var t=[];this.unclaimed.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),b.enabled&&b("horizon %j",t.map((function(e){return e.head().index}))),this.addNewFaces(e,t),b("first merge");for(var n=0;n<this.newFaces.length;n+=1){var r=this.newFaces[n];if(r.mark===u.VISIBLE)for(;this.doAdjacentMerge(r,1););}b("second merge");for(var i=0;i<this.newFaces.length;i+=1){var a=this.newFaces[i];if(a.mark===u.NON_CONVEX)for(a.mark=u.VISIBLE;this.doAdjacentMerge(a,2););}b("reassigning points to newFaces"),this.resolveUnclaimedPoints(this.newFaces)}},{key:"build",value:function(){var e,t=0;for(this.createInitialSimplex();e=this.nextVertexToAdd();)b("== iteration %j ==",t+=1),b("next vertex to add = %d %j",e.index,e.point),this.addVertexToHull(e),b("end");this.reindexFaceAndVertices()}}],n&&x(t.prototype,n),r&&x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.default=k}(v),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new n.default(e);return r.build(),r.collectFaces(t.skipTriangulation)},e.isPointInsideHull=function(e,t,n){for(var i=0;i<n.length;i++){var a=n[i],o=t[a[0]],s=t[a[1]],l=t[a[2]],c=(0,r.default)([],o,s,l),u=[e[0]-o[0],e[1]-o[1],e[2]-o[2]];if(c[0]*u[0]+c[1]*u[1]+c[2]*u[2]>0)return!1}return!0};var n=i(v),r=i(t);function i(e){return e&&e.__esModule?e:{default:e}}}(p);var b=p.__esModule,k=p.isPointInsideHull;export{b as __esModule,p as default,k as isPointInsideHull};
//# sourceMappingURL=/sm/4e0fed04c6037e34ae1e9886a322e7807bc08a5d1f7670332c68ae94d2fe0170.map